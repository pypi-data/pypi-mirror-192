[tox]
envlist =
    py38
    py39
    py310
    py311
    pypy3
    lint
skipdist = true
isolated_build = true
skip_missing_interpreters = true

[gh-actions]
# https://github.com/ymyzk/tox-gh-actions
python =
    3.8: py38
    3.9: py39
    3.10: py310
    3.11: py311,lint
    pypy-3.9: pypy3

[testenv]
description = run unit tests
extras = test
commands =
    pytest --cov=argh --cov-report html --cov-fail-under 100 {posargs:tests}
setenv =
    PYTHONPATH=src

[testenv:docs]
description = build the HTML docs using sphinx-build
extras = docs
changedir = docs/
allowlist_externals = rm
commands =
    rm -rf docs/build
    sphinx-build source build --color -W --keep-going -n -b html {posargs}

[testenv:lint]
extras = linters
commands =
  pre-commit run -a
