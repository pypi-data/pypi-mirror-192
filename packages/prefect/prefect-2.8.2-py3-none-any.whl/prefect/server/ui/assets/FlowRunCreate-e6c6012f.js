import{aY as b,d as k,Y as D,ak as N,aZ as x,c as u,a0 as F,u as a,a as I,w as d,f as J,a3 as O,a4 as P,a_ as T,o as V,b as i,a$ as B,b0 as U,b1 as Y,b2 as $,v as f}from"./index-ac647112-08d053b9.js";import{u as j}from"./usePageTitle-b14d9551.js";import"./index-dfea5a9b.js";import{r as y}from"./routes-5c579cbb.js";import"./meta-26546594.js";class A extends b{parse(t){return JSON.parse(decodeURIComponent(t??""))}format(t){return encodeURIComponent(JSON.stringify(t))}}const G=k({__name:"FlowRunCreate",setup(v){const t=D(),s=N("deploymentId"),n=P(),p=x("parameters",A,void 0),w=u(()=>!e.value||!p.value?{}:T.map("SchemaValuesResponse",{schema:e.value.parameterOpenApiSchema,values:p.value},"SchemaValues")),_=F(t.deployments.getDeployment,[s]),e=u(()=>_.response),h=async r=>{var l,o;try{const m=await t.deployments.createDeploymentFlowRun(s.value,r),c=((o=(l=r.state)==null?void 0:l.stateDetails)==null?void 0:o.scheduledTime)??void 0,S=!c,g=Y($,{flowRun:m,flowRunRoute:y.flowRun,router:n,immediate:S,startTime:c});f(g,"success"),n.push(y.deployment(s.value))}catch(m){f("Something went wrong trying to create a flow run","error"),console.error(m)}},R=()=>{n.back()},C=u(()=>e.value?`Create Flow Run for Deployment: ${e.value.name}`:"Create Flow Run for Deployment");return j(C),(r,l)=>{const o=O("p-layout-default");return a(e)?(V(),I(o,{key:0},{header:d(()=>[i(a(B),{deployment:a(e)},null,8,["deployment"])]),default:d(()=>[i(a(U),{deployment:a(e),parameters:a(w),onSubmit:h,onCancel:R},null,8,["deployment","parameters"])]),_:1})):J("",!0)}}});export{G as default};
