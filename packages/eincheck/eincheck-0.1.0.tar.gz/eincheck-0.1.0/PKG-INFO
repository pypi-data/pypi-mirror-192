Metadata-Version: 2.1
Name: eincheck
Version: 0.1.0
Summary: 
Author: Ethan Pronovost
Author-email: epronovo1@gmail.com
Requires-Python: >=3.8.1,<4
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Requires-Dist: lark (>=1.1,<1.2)
Description-Content-Type: text/markdown

# eincheck

[![CI](https://github.com/epronovost/eincheck/actions/workflows/pr.yaml/badge.svg?branch=main)](https://github.com/epronovost/eincheck/actions/workflows/pr.yaml)

Tensor shape checks inspired by einstein notation

## Overview

This library has three main functions:

* `check_shapes` takes tuples of `(Tensor, shape)` and checks that all the Tensors match the shapes

```
check_shapes((x, "i 3"), (y, "i 3"))
```

* `check_func` is a function decorator to check the input and output shapes of a function

```
@check_func("*i x, *i y -> *i (x + y)")
def concat(a, b):
    return np.concatenate([a, b], -1)
```

* `check_data` is a class decorator to check the fields of a data class

```
@check_data(start="i 2", end="i 2")
class LineSegment2D(NamedTuple):
    start: torch.Tensor
    end: torch.Tensor
```

