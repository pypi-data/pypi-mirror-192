"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_dashboards_widgetBuilder_index_tsx-app_views_performance_transactionSummary_utils_tsx"],{"./app/utils/profiling/routes.tsx":(e,t,i)=>{function r(e){let{orgSlug:t,projectSlug:i,profileId:r}=e;return`/organizations/${t}/profiling/profile/${i}/${r}/flamechart/`}function s(e){let{orgSlug:t,query:i}=e;const r=function(e){let{orgSlug:t}=e;return`/organizations/${t}/profiling/`}({orgSlug:t});return{pathname:r,query:{...i}}}function a(e){let{orgSlug:t,projectSlug:i,transaction:r,query:s}=e;const a=function(e){let{orgSlug:t,projectSlug:i}=e;return`/organizations/${t}/profiling/summary/${i}/`}({orgSlug:t,projectSlug:i});return{pathname:a,query:{...s,transaction:r}}}function n(e){let{orgSlug:t,projectSlug:i,profileId:s,query:a}=e;return{pathname:r({orgSlug:t,projectSlug:i,profileId:s}),query:{...a}}}function o(e){let{orgSlug:t,projectSlug:i,profileId:r,frameName:s,framePackage:a,query:o}=e;return n({orgSlug:t,projectSlug:i,profileId:r,query:{...o,frameName:s,framePackage:a}})}function d(e){let{orgSlug:t,projectSlug:i,profileId:r,query:s}=e;const a=function(e){let{orgSlug:t,projectSlug:i,profileId:r}=e;return`/organizations/${t}/profiling/profile/${i}/${r}/details/`}({orgSlug:t,projectSlug:i,profileId:r});return{pathname:a,query:{...s}}}i.d(t,{O$:()=>r,Qy:()=>d,R0:()=>a,TH:()=>n,XR:()=>s,u$:()=>o})},"./app/views/dashboards/widgetBuilder/index.tsx":(e,t,i)=>{i.r(t),i.d(t,{default:()=>Rt});var r=i("./app/components/acl/feature.tsx"),s=i("./app/components/alert.tsx"),a=i("./app/components/layouts/thirds.tsx"),n=i("./app/locale.tsx"),o=i("./app/utils/useOrganization.tsx"),d=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),l=(i("../node_modules/core-js/modules/es.array.includes.js"),i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/react/index.js")),u=i("../node_modules/lodash/cloneDeep.js"),c=i.n(u),p=i("../node_modules/lodash/isEmpty.js"),g=i.n(p),m=i("../node_modules/lodash/omit.js"),y=i.n(m),h=i("../node_modules/lodash/set.js"),f=i.n(h),b=i("./app/actionCreators/dashboards.tsx"),w=i("./app/actionCreators/indicator.tsx"),v=i("./app/actionCreators/members.tsx"),S=i("./app/actionCreators/tags.tsx"),T=i("./app/components/list/index.tsx"),x=i("./app/components/list/listItem.tsx"),Z=i("./app/components/loadingError.tsx"),E=i("./app/components/organizations/pageFilters/container.tsx"),q=i("./app/components/sentryDocumentTitle.tsx"),O=i("./app/styles/space.tsx"),C=i("./app/utils.tsx"),F=i("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),D=i("./app/utils/customMeasurements/customMeasurementsProvider.tsx"),A=i("./app/utils/discover/eventView.tsx"),_=i("./app/utils/discover/fields.tsx"),R=i("./app/utils/performance/contexts/metricsCardinality.tsx"),I=i("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),z=i("./app/utils/useApi.tsx"),B=i("./app/utils/withDomainRequired.tsx"),k=i("./app/utils/withPageFilters.tsx"),L=i("./app/utils/withTags.tsx"),N=i("./app/views/dashboards/layoutUtils.tsx"),P=i("./app/views/dashboards/types.tsx"),M=i("./app/views/performance/landing/metricsDataSwitcher.tsx"),j=i("./app/views/dashboards/data.tsx"),V=i("./app/views/dashboards/datasetConfig/base.tsx"),$=i("./app/views/dashboards/widgetCard/dashboardsMEPContext.tsx"),U=i("./app/components/links/externalLink.tsx"),W=i("./app/utils/useCustomMeasurements.tsx"),H=i("./app/views/dashboards/widgetBuilder/utils.tsx"),X=i("./app/views/dashboards/widgetBuilder/buildSteps/buildStep.tsx"),Q=i("./app/components/forms/fieldGroup/index.tsx"),G=i("./app/views/discover/table/columnEditCollection.tsx"),Y=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function K(e){let{displayType:t,fieldOptions:i,widgetType:r,fields:s,organization:a,errors:n,onChange:o,filterAggregateParameters:d,filterPrimaryOptions:l,noFieldsMessage:u}=e;return(0,Y.tZ)(Q.Z,{inline:!1,error:n?.find((e=>e?.fields))?.fields,flexibleControlStateSize:!0,stacked:!0,children:t===P.FO.TABLE?(0,Y.tZ)(J,{columns:s,onChange:o,fieldOptions:i,organization:a,source:r,showAliasField:!0,filterAggregateParameters:d,filterPrimaryOptions:l,noFieldsMessage:u}):(0,Y.tZ)(J,{columns:s.slice(0,s.length-1),onChange:e=>{o([...e,s[s.length-1]])},fieldOptions:i,organization:a,source:r,filterPrimaryOptions:l,noFieldsMessage:u})})}K.displayName="ColumnFields";const J=(0,d.Z)(G.Z,{target:"e1x1z4fe0"})("margin-top:",(0,O.D)(1),";");function ee(e){let{dataSet:t,displayType:i,organization:r,widgetType:s,handleColumnFieldChange:a,queryErrors:o,explodedFields:d,tags:l}=e;const{customMeasurements:u}=(0,W.Z)(),c=(0,V.v)(s);return(0,Y.tZ)(X.F,{title:(0,n.t)("Choose your columns"),description:t===H.qg.ISSUES?(0,n._N)("[fieldTagLink: Field and tag] columns will help you view more details about the issues (e.g., title).",{fieldTagLink:(0,Y.tZ)(U.Z,{href:"https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#event-properties"})}):t===H.qg.RELEASES?(0,n._N)("To stack sessions, add [functionLink: functions] f(x) that may take in additional parameters. [fieldTagLink: Field and tag] columns will help you view more details about the sessions (e.g., releases).",{functionLink:(0,Y.tZ)(U.Z,{href:"https://docs.sentry.io/product/discover-queries/query-builder/#filter-by-table-columns"}),fieldTagLink:(0,Y.tZ)(U.Z,{href:"https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#release-properties"})}):(0,n._N)("To stack events, add [functionLink: functions] f(x) that may take in additional parameters. [fieldTagLink: Field and tag] columns will help you view more details about the events (e.g., title).",{functionLink:(0,Y.tZ)(U.Z,{href:"https://docs.sentry.io/product/discover-queries/query-builder/#filter-by-table-columns"}),fieldTagLink:(0,Y.tZ)(U.Z,{href:"https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#event-properties"})}),children:(0,Y.tZ)(K,{displayType:i,organization:r,widgetType:s,fields:d,errors:o,fieldOptions:c.getTableFieldOptions(r,l,u),filterAggregateParameters:c.filterAggregateParams,filterPrimaryOptions:c.filterTableOptions,onChange:a})})}ee.displayName="ColumnsStep";var te=i("./app/components/forms/controls/radioGroup.tsx");const ie=[[H.qg.EVENTS,(0,n.t)("Errors and Transactions")],[H.qg.ISSUES,(0,n.t)("Issues (States, Assignment, Time, etc.)")],[H.qg.RELEASES,(0,n.t)("Releases (Sessions, Crash rates)")]];function re(e){let{dataSet:t,onChange:i,displayType:r}=e;const s=[];return r!==P.FO.TABLE&&(s.push([H.qg.ISSUES,(0,n.t)("This dataset is restricted to tabular visualization.")]),r===P.FO.WORLD_MAP&&s.push([H.qg.RELEASES,(0,n.t)("This dataset is restricted to big number, tabular and time series visualizations.")])),(0,Y.tZ)(X.F,{title:(0,n.t)("Choose your dataset"),description:(0,n._N)("This reflects the type of information you want to use. To learn more, [link: read the docs].",{link:(0,Y.tZ)(U.Z,{href:"https://docs.sentry.io/product/dashboards/widget-builder/#choose-your-dataset"})}),children:(0,Y.tZ)(se,{label:"dataSet",value:t,choices:ie,disabledChoices:s,onChange:e=>{i(e)},orientInline:!0})})}re.displayName="DataSetStep";const se=(0,d.Z)(te.Z,{target:"e1a0o1bm0"})("display:flex;flex-wrap:wrap;gap:",(0,O.D)(2),";");var ae=i("./app/components/button.tsx"),ne=i("./app/components/buttonBar.tsx"),oe=i("./app/components/datePageFilter.tsx"),de=i("./app/components/environmentPageFilter.tsx"),le=i("./app/components/input.tsx"),ue=i("./app/components/organizations/pageFilterBar.tsx"),ce=i("./app/components/projectPageFilter.tsx"),pe=i("./app/icons/index.tsx"),ge=i("./app/utils/queryString.tsx"),me=i("./app/utils/releases/releasesProvider.tsx"),ye=i("./app/views/dashboards/releasesSelectControl.tsx");function he(e){let{canAddSearchConditions:t,dashboardFilters:i,location:r,queries:s,onQueryRemove:a,onAddSearchConditions:o,onQueryChange:d,organization:u,hideLegendAlias:c,queryErrors:p,widgetType:g,selection:m,onQueryConditionChange:y}=e;const[h,f]=(0,l.useState)([]),b=(0,l.useCallback)((e=>t=>{const i={...s[e],conditions:t};d(e,i)}),[d,s]),w=(0,l.useCallback)((e=>(t,i)=>{let{validSearch:r}=i;h[e]=r,f(h),y(!h.some((e=>!e)));const a={...s[e],conditions:t};d(e,a)}),[d,y,h,s]),v=e=>()=>{h.splice(e,1),f(h),y(!h.some((e=>!e))),a(e)},S=(0,V.v)(g);return(0,Y.BX)(X.F,{title:(0,n.t)("Filter your results"),description:t?(0,n.t)("Projects, environments, and date range have been preselected at the dashboard level. Filter down your search here. You can add multiple queries to compare data for each overlay."):(0,n.t)("Projects, environments, and date range have been preselected at the dashboard level. Filter down your search here."),children:[(0,Y.BX)(we,{children:[(0,Y.tZ)(ce.Z,{disabled:!0}),(0,Y.tZ)(de.Z,{disabled:!0}),(0,Y.tZ)(oe.Z,{alignDropdown:"left",disabled:!0})]}),(0,Y.tZ)(ve,{children:(0,Y.tZ)(me.lR,{organization:u,selection:m,children:(0,Y.tZ)(Se,{selectedReleases:(P.qA.RELEASE in r.query?(0,ge.qP)(r.query[P.qA.RELEASE]):i?.[P.qA.RELEASE])??[],isDisabled:!0,className:"widget-release-select"})})}),(0,Y.BX)("div",{children:[s.map(((e,t)=>(0,Y.tZ)(be,{inline:!1,flexibleControlStateSize:!0,stacked:!0,error:p?.[t]?.conditions,children:(0,Y.BX)(Te,{children:[(0,Y.tZ)(S.SearchBar,{organization:u,pageFilters:m,onClose:w(t),onSearch:b(t),widgetQuery:e}),!c&&(0,Y.tZ)(fe,{type:"text",name:"name",value:e.name,placeholder:(0,n.t)("Legend Alias"),onChange:e=>{const i={...s[t],name:e.target.value};d(t,i)}}),s.length>1&&(0,Y.tZ)(ae.zx,{size:"zero",borderless:!0,onClick:v(t),icon:(0,Y.tZ)(pe.Fz,{}),title:(0,n.t)("Remove query"),"aria-label":(0,n.t)("Remove query")})]})},t))),t&&(0,Y.tZ)(ae.zx,{size:"sm",icon:(0,Y.tZ)(pe.N_,{isCircled:!0}),onClick:o,children:(0,n.t)("Add Query")})]})]})}he.displayName="FilterResultsStep";const fe=(0,d.Z)(le.Z,{target:"e1a7d72t5"})({name:"1f6lq61",styles:"width:33%"}),be=(0,d.Z)(Q.Z,{target:"e1a7d72t4"})("padding-bottom:",(0,O.D)(1),";"),we=(0,d.Z)(ue.Z,{target:"e1a7d72t3"})("margin-bottom:",(0,O.D)(1),";margin-right:",(0,O.D)(2),";"),ve=(0,d.Z)(ne.ZP,{target:"e1a7d72t2"})("grid-template-columns:1fr;margin-bottom:",(0,O.D)(1),";margin-right:",(0,O.D)(2),";justify-content:space-between;"),Se=(0,d.Z)(ye.Z,{target:"e1a7d72t1"})({name:"f0iau4",styles:"button{width:100%;}"}),Te=(0,d.Z)("div",{target:"e1a7d72t0"})("display:flex;align-items:center;>*+*{margin-left:",(0,O.D)(1),";}");var xe=i("../node_modules/@dnd-kit/core/dist/core.esm.js"),Ze=i("../node_modules/@dnd-kit/sortable/dist/sortable.esm.js"),Ee=i("./app/views/discover/table/types.tsx"),qe=i("./app/views/discover/table/queryField.tsx");function Oe(e){let{onDelete:t,onChange:i,fieldOptions:r,value:s,forwardRef:a,listeners:o,attributes:d,canDelete:u,canDrag:c,style:p,isDragging:g}=e;return(0,Y.tZ)(Fe,{ref:a,style:p,children:g?null:(0,Y.BX)(l.Fragment,{children:[c&&(0,Y.tZ)(Ce,{...o,...d,"aria-label":(0,n.t)("Drag to reorder"),icon:(0,Y.tZ)(pe.LS,{size:"xs"}),size:"zero",borderless:!0}),(0,Y.tZ)(qe.q,{placeholder:(0,n.t)("Select group"),fieldValue:s,fieldOptions:r,onChange:i,filterPrimaryOptions:e=>e.value.kind!==Ee.L.FUNCTION}),u&&(0,Y.tZ)(ae.zx,{size:"zero",borderless:!0,onClick:t,icon:(0,Y.tZ)(pe.Fz,{}),title:(0,n.t)("Remove group"),"aria-label":(0,n.t)("Remove group")})]})})}Oe.displayName="QueryField";const Ce=(0,d.Z)(ae.zx,{target:"edy9wcg1"})("height:",(e=>e.theme.form.md.height),"px;"),Fe=(0,d.Z)("div",{target:"edy9wcg0"})("display:flex;align-items:center;justify-content:space-between;width:100%;>*+*{margin-left:",(0,O.D)(1),";}");var De=i("../node_modules/@dnd-kit/utilities/dist/utilities.esm.js"),Ae=i("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js");function _e(e){let{dragId:t,...i}=e;const r=(0,Ae.u)(),{listeners:s,setNodeRef:a,transform:n,transition:o,attributes:d,isDragging:l}=(0,Ze.nB)({id:t,transition:null});let u={transform:De.ux.Transform.toString(n),transition:o,zIndex:"auto"};return l&&(u={...u,zIndex:100,height:r.form.md.height,border:`2px dashed ${r.border}`,borderRadius:r.borderRadius}),(0,Y.tZ)(Oe,{forwardRef:a,listeners:s,attributes:d,isDragging:l,style:u,...i})}_e.displayName="SortableQueryField";const Re={kind:Ee.L.FIELD,field:""};function Ie(e){let{fieldOptions:t,columns:i=[],onChange:r}=e;const[s,a]=(0,l.useState)(null);function o(e,t){const s=[...i];0===i.length?s.push(e):(0,C.ri)(t)&&(s[t]=e),r(s)}const d=1===i.length&&i[0].kind===Ee.L.FIELD&&""!==i[0]?.field,u=i.length>1,c=u||d,p=i.map(_.sN),{filteredFieldOptions:g,columnsAsFieldOptions:m}=(0,l.useMemo)((()=>Object.keys(t).reduce(((e,i)=>{const r=t[i],s=p.findIndex((e=>e===r.value.meta.name));return-1===s?(e.filteredFieldOptions[i]=r,e):(e.columnsAsFieldOptions[s]={[i]:r},e)}),{filteredFieldOptions:{},columnsAsFieldOptions:[]})),[t,p]),y=(0,l.useMemo)((()=>i.reduce(((e,t,i)=>(e.push(String(i)),e)),[])),[i]);return(0,Y.BX)(l.Fragment,{children:[(0,Y.tZ)(ze,{inline:!1,flexibleControlStateSize:!0,stacked:!0,children:0===i.length?(0,Y.tZ)(Oe,{value:Re,fieldOptions:g,onChange:e=>o(e,0),canDelete:c}):(0,Y.BX)(xe.LB,{collisionDetection:xe.pE,onDragStart:e=>{let{active:t}=e;a(t.id)},onDragEnd:e=>{let{over:t,active:s}=e;if(a(null),t){const e=y.indexOf.bind(y),a=e(s.id),n=e(t.id);a!==n&&r((0,Ze.Rp)(i,a,n))}},onDragCancel:()=>{a(null)},children:[(0,Y.tZ)(Ze.Fo,{items:y,strategy:Ze.qw,children:(0,Y.tZ)(ke,{children:i.map(((e,t)=>(0,Y.tZ)(_e,{dragId:y[t],value:e,fieldOptions:{...g,...m[t]},onChange:e=>o(e,t),onDelete:()=>function(e){const t=[...i];t.splice(e,1),r(t)}(t),canDrag:u,canDelete:c},y[t])))})}),(0,Y.tZ)(xe.y9,{dropAnimation:null,children:s?(0,Y.tZ)(Le,{children:(0,Y.tZ)(Oe,{value:i[Number(s)],fieldOptions:{...g,...m[Number(s)]},onChange:e=>o(e,Number(s)),canDrag:u,canDelete:c})}):null})]})}),i.length<20&&(0,Y.tZ)(Be,{size:"sm",icon:(0,Y.tZ)(pe.N_,{isCircled:!0}),onClick:function(){const e=0===i.length?[{...Re},{...Re}]:[...i,{...Re}];r(e)},children:(0,n.t)("Add Group")})]})}Ie.displayName="GroupBySelector";const ze=(0,d.Z)(Q.Z,{target:"e1q49y6w3"})("padding-bottom:",(0,O.D)(1),";"),Be=(0,d.Z)(ae.zx,{target:"e1q49y6w2"})({name:"b9l38d",styles:"width:min-content"}),ke=(0,d.Z)("div",{target:"e1q49y6w1"})("display:grid;grid-auto-flow:row;gap:",(0,O.D)(1),";"),Le=(0,d.Z)("div",{target:"e1q49y6w0"})("position:absolute;background:",(e=>e.theme.background),";padding:",(0,O.D)(.5),";border-radius:",(e=>e.theme.borderRadius),";box-shadow:0 0 15px rgba(0, 0, 0, 0.15);opacity:0.8;cursor:grabbing;padding-right:",(0,O.D)(2),";width:100%;button{cursor:grabbing;}@media (min-width: ",(e=>e.theme.breakpoints.small),"){width:710px;}");function Ne(e){let{dataSet:t,columns:i,onGroupByChange:r,organization:s,tags:a}=e;const o=(0,V.v)(Zt[t]);return(0,Y.tZ)(X.F,{title:(0,n.t)("Group your results"),description:(0,n.t)("This is how you can group your data result by field or tag."),children:(0,Y.tZ)(Ie,{columns:i,fieldOptions:o.getGroupByFieldOptions?o.getGroupByFieldOptions(s,a):{},onChange:r})})}Ne.displayName="GroupByStep";var Pe=i("./app/views/dashboards/widgetBuilder/buildSteps/sortByStep/index.tsx"),Me=i("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),je=i("../node_modules/lodash/debounce.js"),Ve=i.n(je),$e=i("../node_modules/lodash/isEqual.js"),Ue=i.n($e),We=i("./app/components/charts/simpleTableChart.tsx"),He=i("./app/components/forms/controls/selectControl.tsx"),Xe=i("./app/components/panels/index.tsx"),Qe=i("./app/constants/index.tsx"),Ge=i("./app/utils/usePrevious.tsx"),Ye=i("./app/views/dashboards/utils.tsx"),Ke=i("./app/views/dashboards/widgetCard/index.tsx");function Je(e){let{organization:t,pageFilters:i,displayType:r,error:s,onChange:a,widget:o,noDashboardsMEPProvider:d,dashboardFilters:u,location:c,isWidgetInvalid:p}=e;const[g,m]=(0,l.useState)(o),y=(0,Ge.Z)(o),h=(0,l.useCallback)(Ve()(((e,t)=>{t||m(e)}),Qe.Dk),[]);(0,l.useEffect)((()=>{let e=!1;return Ue()(y,o)||h(o,e),()=>{e=!0}}),[o,y,h]);const f=Object.keys(H.hV).map((e=>({label:H.hV[e],value:e})));return(0,Y.BX)(X.F,{title:(0,n.t)("Choose your visualization"),description:(0,n.t)("This is a preview of how your widget will appear in the dashboard."),children:[(0,Y.tZ)(Q.Z,{error:s,inline:!1,flexibleControlStateSize:!0,stacked:!0,children:(0,Y.tZ)(He.Z,{name:"displayType",options:f,value:r,onChange:e=>{a(e.value)},styles:{singleValue:e=>({...e,width:`calc(100% - ${(0,O.D)(1)})`})}})}),(0,Y.tZ)(et,{displayType:r,children:(0,Y.tZ)(Ke.ZP,{organization:t,selection:i,widget:g,dashboardFilters:(0,Ye.lM)(c)??u,isEditing:!1,widgetLimitReached:!1,renderErrorMessage:e=>"string"==typeof e&&(0,Y.tZ)(Xe.aU,{type:"error",children:e}),noLazyLoad:!0,showStoredAlert:!0,noDashboardsMEPProvider:d,isWidgetInvalid:p})})]})}Je.displayName="VisualizationStep";const et=(0,d.Z)("div",{target:"e1k3e7rq0"})("padding-right:",(0,O.D)(2),";",Ke._,"{height:initial;}",(e=>e.displayType===P.FO.TABLE&&(0,Me.iv)("overflow:hidden;",We.p,"{height:41px;}",Ke._,"{height:301px;}","")),";");function tt(e){let{title:t,onAdd:i}=e;return(0,Y.tZ)(ae.zx,{size:"sm",onClick:i,icon:(0,Y.tZ)(pe.N_,{isCircled:!0}),children:t})}function it(e){let{onDelete:t}=e;return(0,Y.tZ)(ae.zx,{size:"zero",borderless:!0,onClick:t,icon:(0,Y.tZ)(pe.Fz,{}),title:(0,n.t)("Remove this Y-Axis"),"aria-label":(0,n.t)("Remove this Y-Axis")})}function rt(e){let{displayType:t,widgetType:i,aggregates:r,tags:s,onChange:a,errors:d,noFieldsMessage:l}=e;const u=(0,o.Z)(),c=(0,V.v)(i),{customMeasurements:p}=(0,W.Z)(),g=d?.find((e=>e?.aggregates))?.aggregates,m=r.length>1,y=[P.FO.WORLD_MAP,P.FO.BIG_NUMBER].includes(t)&&1===r.length||[P.FO.LINE,P.FO.AREA,P.FO.BAR].includes(t)&&3===r.length;return(0,Y.BX)(Q.Z,{inline:!1,flexibleControlStateSize:!0,error:g,stacked:!0,children:[r.map(((e,i)=>(0,Y.BX)(st,{children:[(0,Y.tZ)(qe.q,{fieldValue:e,fieldOptions:c.getTableFieldOptions(u,s,p),onChange:e=>function(e,t){const i=[...r];i[t]=e,a(i)}(e,i),filterPrimaryOptions:c.filterYAxisOptions?.(t),filterAggregateParameters:c.filterYAxisAggregateParams?.(e,t),otherColumns:r,noFieldsMessage:l}),r.length>1&&(m||e.kind===Ee.L.EQUATION)&&(0,Y.tZ)(it,{onDelete:e=>function(e,t){e.preventDefault();const i=[...r];i.splice(t,1),a(i)}(e,i)})]},`${e}:${i}`))),!y&&(0,Y.BX)(at,{gap:1,children:[(0,Y.tZ)(tt,{title:(0,n.t)("Add Overlay"),onAdd:function(e){e.preventDefault();const t=[...r,{kind:Ee.L.FIELD,field:""}];a(t)}}),c.enableEquations&&(0,Y.tZ)(tt,{title:(0,n.t)("Add an Equation"),onAdd:function(e){e.preventDefault();const t=[...r,{kind:Ee.L.EQUATION,field:""}];a(t)}})]})]})}tt.displayName="AddButton",it.displayName="DeleteButton",rt.displayName="YAxisSelector";const st=(0,d.Z)("div",{target:"e1ayt4931"})("display:flex;align-items:center;justify-content:space-between;:not(:last-child){margin-bottom:",(0,O.D)(1),";}>*+*{margin-left:",(0,O.D)(1),";}"),at=(0,d.Z)(ne.ZP,{target:"e1ayt4930"})({name:"11g6mpt",styles:"justify-content:flex-start"});function nt(e){let{displayType:t,queryErrors:i,aggregates:r,onYAxisChange:s,tags:a,widgetType:o}=e;return(0,Y.tZ)(X.F,{title:t===P.FO.BIG_NUMBER?(0,n.t)("Choose what to plot"):(0,n.t)("Choose what to plot in the y-axis"),description:[P.FO.AREA,P.FO.BAR,P.FO.LINE].includes(t)?(0,n.t)("This is the data you'd be visualizing in the display. If the overlay units conflict, the charts will always base it off of the first line."):(0,n.t)("This is the data you'd be visualizing in the display."),children:(0,Y.tZ)(rt,{widgetType:o,displayType:t,aggregates:r,onChange:s,tags:a,errors:i})})}nt.displayName="YAxisStep";var ot=i("./app/components/confirm.tsx");function dt(e){let{goBackLocation:t,onSave:i,onDelete:r,invalidForm:s,isEditing:a}=e;return(0,Y.tZ)(ut,{children:(0,Y.BX)(lt,{gap:1,children:[(0,Y.tZ)(ae.zx,{to:t,children:(0,n.t)("Cancel")}),a&&r&&(0,Y.tZ)(ot.Z,{priority:"danger",message:(0,n.t)("Are you sure you want to delete this widget?"),onConfirm:r,children:(0,Y.tZ)(ae.zx,{priority:"danger",children:(0,n.t)("Delete")})}),(0,Y.tZ)(ae.zx,{priority:"primary",onClick:i,disabled:s,title:s?(0,n.t)("Required fields must be filled out and contain valid inputs"):void 0,children:a?(0,n.t)("Update Widget"):(0,n.t)("Add Widget")})]})})}dt.displayName="Footer";const lt=(0,d.Z)(ne.ZP,{target:"e1g9348w1"})("justify-content:flex-end;max-width:1000px;padding:",(0,O.D)(4)," ",(0,O.D)(2),";padding-right:calc(",(0,O.D)(2)," + ",(0,O.D)(2),");@media (min-width: ",(e=>e.theme.breakpoints.medium),"){padding:",(0,O.D)(4),";padding-right:calc(",(0,O.D)(4)," + ",(0,O.D)(2),");}"),ut=(0,d.Z)("div",{target:"e1g9348w0"})("background:",(e=>e.theme.background),";border-top:1px solid ",(e=>e.theme.gray200),";");var ct=i("./app/components/breadcrumbs.tsx"),pt=i("./app/components/editableText.tsx"),gt=i("./app/components/featureFeedback/index.tsx");function mt(e){let{title:t,orgSlug:i,goBackLocation:r,dashboardTitle:s,onChangeTitle:o}=e;return(0,Y.BX)(a.h4,{children:[(0,Y.BX)(a.oB,{children:[(0,Y.tZ)(ct.Z,{crumbs:[{to:`/organizations/${i}/dashboards/`,label:(0,n.t)("Dashboards")},{to:r,label:s},{label:(0,n.t)("Widget Builder")}]}),(0,Y.tZ)(a.Dx,{children:(0,Y.tZ)(pt.Z,{"aria-label":(0,n.t)("Widget title"),value:t,onChange:o,errorMessage:(0,n.t)("Widget title is required"),maxLength:255})})]}),(0,Y.tZ)(a.kP,{children:(0,Y.BX)(ne.ZP,{gap:1,children:[(0,Y.tZ)(gt.z,{buttonProps:{size:"sm"},featureName:"widget-builder"}),(0,Y.tZ)(ae.zx,{external:!0,size:"sm",href:"https://docs.sentry.io/product/dashboards/custom-dashboards/#widget-builder",children:(0,n.t)("Read the docs")})]})})]})}mt.displayName="Header";var yt=i("./app/actionCreators/modal.tsx"),ht=i("./app/utils/discover/types.tsx");const ft=[{id:"duration-distribution",title:(0,n.t)("Duration Distribution"),description:(0,n.t)("Compare transaction durations across different percentiles."),displayType:P.FO.LINE,widgetType:P.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"event.type:transaction",fields:["p50(transaction.duration)","p75(transaction.duration)","p95(transaction.duration)"],aggregates:["p50(transaction.duration)","p75(transaction.duration)","p95(transaction.duration)"],columns:[],orderby:""}]},{id:"high-throughput-transactions",title:(0,n.t)("High Throughput Transactions"),description:(0,n.t)("Top 5 transactions with the largest volume."),displayType:P.FO.TOP_N,widgetType:P.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"event.type:transaction",fields:["transaction","count()"],aggregates:["count()"],columns:["transaction"],orderby:"-count()"}]},{id:"crash-rates-recent-releases",title:(0,n.t)("Crash Rates for Recent Releases"),description:(0,n.t)("Percentage of crashed sessions for latest releases."),displayType:P.FO.LINE,widgetType:P.l9.RELEASE,interval:"5m",limit:8,queries:[{name:"",conditions:"",fields:["crash_rate(session)","release"],aggregates:["crash_rate(session)"],columns:["release"],orderby:"-release"}]},{id:"session-health",title:(0,n.t)("Session Health"),description:(0,n.t)("Number of abnormal, crashed, errored and healthy sessions."),displayType:P.FO.TABLE,widgetType:P.l9.RELEASE,interval:"5m",queries:[{name:"",conditions:"",fields:["session.status","sum(session)"],aggregates:["sum(session)"],columns:["session.status"],orderby:""}]},{id:"lcp-country",title:(0,n.t)("LCP by Country"),description:(0,n.t)("Density map showing page load times by country."),displayType:P.FO.WORLD_MAP,widgetType:P.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"has:geo.country_code",fields:["p75(measurements.lcp)"],aggregates:["p75(measurements.lcp)"],columns:[],orderby:""}]},{id:"miserable-users",title:(0,n.t)("Miserable Users"),description:(0,n.t)("Unique users who have experienced slow load times."),displayType:P.FO.BIG_NUMBER,widgetType:P.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"",fields:["count_miserable(user,300)"],aggregates:["count_miserable(user,300)"],columns:[],orderby:""}]},{id:"slow-vs-fast",title:(0,n.t)("Slow vs. Fast Transactions"),description:(0,n.t)("Percentage breakdown of transaction durations over and under 300ms."),displayType:P.FO.BAR,widgetType:P.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"event.type:transaction",fields:["equation|(count_if(transaction.duration,greater,300) / count()) * 100","equation|(count_if(transaction.duration,lessOrEquals,300) / count()) * 100"],aggregates:["equation|(count_if(transaction.duration,greater,300) / count()) * 100","equation|(count_if(transaction.duration,lessOrEquals,300) / count()) * 100"],columns:[],orderby:""}]},{id:"issue-for-review",title:(0,n.t)("Issues For Review"),description:(0,n.t)("Most recently seen unresolved issues for review."),displayType:P.FO.TABLE,widgetType:P.l9.ISSUE,interval:"5m",queries:[{name:"",conditions:"is:unresolved is:for_review",fields:["issue","assignee","events","title"],aggregates:[],columns:["issue","assignee","events","title"],orderby:"date"}]},{id:"top-unhandled",title:(0,n.t)("Top Unhandled Error Types"),description:(0,n.t)("Most frequently encountered unhandled errors."),displayType:P.FO.TOP_N,widgetType:P.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"error.unhandled:true",fields:["error.type","count()"],aggregates:["count()"],columns:["error.type"],orderby:"-count()"}]},{id:"users-affected",title:(0,n.t)("Users Affected by Errors"),description:(0,n.t)("Footprint of unique users affected by errors."),displayType:P.FO.LINE,widgetType:P.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"event.type:error",fields:["count_unique(user)","count()"],aggregates:["count_unique(user)","count()"],columns:[],orderby:""}]}];var bt=i("./app/views/dashboards/widgetBuilder/widgetLibrary/card.tsx");function wt(e){let{bypassOverwriteModal:t,onWidgetSelect:i,selectedWidgetId:r}=e;const s=(0,Ae.u)(),a=ft.map((e=>e.displayType===P.FO.TOP_N?{...e,displayType:P.FO.AREA,limit:ht.hY}:e));function o(e,r){return function(){t?i(e):(0,yt.openWidgetBuilderOverwriteModal)({onConfirm:()=>i(e),widget:e,iconColor:r})}}return(0,Y.BX)(l.Fragment,{children:[(0,Y.tZ)(St,{children:(0,n.t)("Widget Library")}),(0,Y.tZ)(vt,{children:a.map(((e,t)=>{const i=s.charts.getColorPalette(a.length-2)[t],n=e.displayType===P.FO.TOP_N?P.FO.TABLE:e.displayType,d=(0,H.Zi)({displayType:n,queries:e.queries,widgetType:e.widgetType}),l={...e,displayType:n,queries:d};return(0,Y.tZ)(Tt,{selected:r===e.id,onClick:o(l,i),children:(0,Y.tZ)(bt.Z,{widget:l,iconColor:i})},e.title)}))})]})}wt.displayName="WidgetLibrary";const vt=(0,d.Z)("div",{target:"e1yix1o42"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),St=(0,d.Z)("h5",{target:"e1yix1o41"})("padding-left:calc(",(0,O.D)(2)," - ",(0,O.D)(.25),");"),Tt=(0,d.Z)("div",{target:"e1yix1o40"})("padding:calc(",(0,O.D)(2)," - 3px);border:1px solid transparent;border-radius:",(e=>e.theme.borderRadius),";transition:border-color 0.3s ease;cursor:pointer;&:hover{border-color:",(e=>e.theme.gray100),";}",(e=>e.selected&&`border-color: ${e.theme.gray200};`),";"),xt={[P.l9.DISCOVER]:H.qg.EVENTS,[P.l9.ISSUE]:H.qg.ISSUES,[P.l9.RELEASE]:H.qg.RELEASES},Zt={[H.qg.EVENTS]:P.l9.DISCOVER,[H.qg.ISSUES]:P.l9.ISSUE,[H.qg.RELEASES]:P.l9.RELEASE};function Et(e){let{dashboard:t,params:i,location:r,organization:s,selection:o,start:d,end:u,statsPeriod:p,onSave:m,route:h,router:T,tags:x}=e;const{widgetIndex:O,orgId:k,dashboardId:L}=i,{source:U,displayType:W,defaultTitle:X,limit:Q}=r.query,G=(0,H.eQ)(r.query.defaultWidgetQuery);let{defaultTableColumns:K}=r.query;"string"==typeof K&&(K=[K]);const J=(0,C.ri)(O),te=Number(O),ie=te>=0&&te<t.widgets.length&&Number.isInteger(te),se=s.slug,ae=p?{...o,datetime:{start:null,end:null,period:p,utc:null}}:d&&u?{...o,datetime:{start:d,end:u,period:null,utc:null}}:o,ne=[P.EN.DISCOVERV2,P.EN.ISSUE_DETAILS].includes(U),oe=(0,z.Z)(),[de,le]=(0,l.useState)(!1),[ue,ce]=(0,l.useState)((0,V.v)(P.l9.DISCOVER)),[pe,ge]=(0,l.useState)((()=>{const e={title:X??(0,n.t)("Custom Widget"),displayType:(W===P.FO.TOP_N?P.FO.AREA:W)??P.FO.TABLE,interval:"5m",queries:[],limit:Q?Number(Q):void 0,errors:void 0,loading:!!ne,userHasModified:!1,prebuiltWidgetId:null,dataSet:H.qg.EVENTS,queryConditionsValid:!0,selectedDashboard:t.id||H.i0};return G?(e.queries=[{...G,orderby:G.orderby||(ue.getTableSortOptions?ue.getTableSortOptions(s,G)[0].value:"")}],[P.FO.TABLE,P.FO.TOP_N].includes(e.displayType)||(0,H.V0)(e.displayType)&&e.queries[0].columns.length||(e.queries[0].orderby="")):e.queries=[{...ue.defaultWidgetQuery}],e})),[me,ye]=(0,l.useState)(null),[fe,be]=(0,l.useState)(null);(0,l.useEffect)((()=>{if((0,F.Z)("dashboards_views.widget_builder.opened",{organization:s,new_widget:!J}),(0,C.z)(x)&&(0,S.QK)(oe,s.slug,{...o,datetime:{period:"14d",start:null,end:null,utc:null}}),J&&ie){const e=t.widgets[te];let i,r=e.displayType,s=e.limit;e.displayType===P.FO.TOP_N?(s=H._k,r=P.FO.AREA,i=(0,H.Zi)({displayType:r,queries:e.queries,widgetType:e.widgetType??P.l9.DISCOVER}).map((e=>({...e,aggregates:e.aggregates.length?[e.aggregates[e.aggregates.length-1]]:[]})))):i=(0,H.Zi)({displayType:r,queries:e.queries,widgetType:e.widgetType??P.l9.DISCOVER}),ge({title:e.title,displayType:r,interval:e.interval,queries:i,errors:void 0,loading:!1,userHasModified:!1,dataSet:e.widgetType?xt[e.widgetType]:H.qg.EVENTS,limit:s,prebuiltWidgetId:null,queryConditionsValid:!0}),ce((0,V.v)(e.widgetType)),ye(e)}}),[]),(0,l.useEffect)((()=>{(0,v.MA)(oe,s.slug,o.projects?.map(String))}),[o.projects,oe,s.slug]),(0,l.useEffect)((()=>{T.setRouteLeaveHook(h,(()=>{if(!de&&pe.userHasModified)return(0,n.t)("You have unsaved changes, are you sure you want to leave?")}))}),[de,pe.userHasModified,h,T]);const we=pe.dataSet===H.qg.EVENTS?P.l9.DISCOVER:pe.dataSet===H.qg.ISSUES?P.l9.ISSUE:P.l9.RELEASE,ve={title:pe.title,displayType:pe.displayType,interval:pe.interval,queries:pe.queries,limit:pe.limit,widgetType:we},Se=pe.selectedDashboard??L,Te=y()(r.query,"source"),xe={pathname:(0,C.ri)(Se)&&Se!==H.i0?`/organizations/${k}/dashboard/${Se}/`:`/organizations/${k}/dashboards/${H.i0}/`,query:g()(Te)?void 0:Te},Ze=(0,H.V0)(pe.displayType),Ee=[P.FO.TABLE,P.FO.TOP_N].includes(pe.displayType);function qe(){return me?t.widgets.findIndex((e=>(0,C.ri)(e.id)?e.id===me.id:!!(0,C.ri)(e.tempId)&&e.tempId===me.tempId)):-1}function Oe(e,t){var i;(0,F.Z)("dashboards_views.widget_builder.change",{from:U,field:e,value:t,widget_type:we,organization:s,new_widget:!J}),ge((i=>{const r=c()(i);return f()(r,e,t),"title"===e&&f()(r,"userHasModified",!0),{...r,errors:void 0}})),"displayType"===e&&t!==pe.displayType&&(i=t,ge((e=>{const t=c()(e);if(!ue.supportedDisplayTypes.includes(i))return f()(t,"queries",(0,H.Zi)({displayType:i,queries:[{...(0,V.v)(P.l9.DISCOVER).defaultWidgetQuery}],widgetType:P.l9.DISCOVER})),f()(t,"dataSet",H.qg.EVENTS),ce((0,V.v)(P.l9.DISCOVER)),{...t,errors:void 0};const r=(0,H.Zi)({displayType:i,queries:e.queries,widgetType:Zt[e.dataSet]});return i===P.FO.TOP_N&&r.splice(1),e.userHasModified||G&&K&&(i===P.FO.TABLE?r.forEach((e=>{const t=(0,_.n0)(K);e.columns=[...t.columns],e.aggregates=[...t.aggregates],e.fields=[...K],e.orderby=G.orderby??(e.fields.length?`${e.fields[0]}`:"-")})):i===W&&r.forEach((e=>{e.fields=[...G.columns,...G.aggregates],e.aggregates=[...G.aggregates],e.columns=[...G.columns],G.orderby&&(W===P.FO.TOP_N||G.columns.length)&&(e.orderby=G.orderby)}))),f()(t,"queries",r),(0,H.V0)(i)&&r[0].columns.filter((e=>!!e)).length?t.limit=e.limit??Math.min((0,H.oA)(r.length,r[0].columns.length),H._k):t.limit=void 0,f()(t,"userHasModified",!0),{...t,errors:void 0}})))}function Ce(e){(0,F.Z)("dashboards_views.widget_builder.change",{from:U,field:"dataSet",value:e,widget_type:we,organization:s,new_widget:!J}),ge((t=>{const i=c()(t);i.queries.splice(0,i.queries.length),f()(i,"dataSet",e),e===H.qg.ISSUES&&f()(i,"displayType",P.FO.TABLE);const r=(0,V.v)(Zt[e]);return ce(r),i.queries.push(...me?.widgetType&&xt[me.widgetType]===e?me.queries:[{...r.defaultWidgetQuery}]),f()(i,"userHasModified",!0),{...i,errors:void 0}}))}function Fe(){ge((e=>{const t=c()(e),i=(0,V.v)(Zt[e.dataSet]),r=c()(i.defaultWidgetQuery);return r.fields=e.queries[0].fields,r.aggregates=e.queries[0].aggregates,r.columns=e.queries[0].columns,r.orderby=e.queries[0].orderby,t.queries.push(r),t}))}function De(e){ge((t=>{const i=c()(t);return i.queries.splice(e,1),{...i,errors:void 0}}))}function Ae(e,t){ge((i=>{const r=c()(i);return f()(r,`queries.${e}`,t),f()(r,"userHasModified",!0),{...r,errors:void 0}}))}function _e(e){return function(t){const i=t.map(_.sN),r=(0,_.KZ)(t),s=c()(pe);let a=c()(s.queries[0]);a.fields=i,a.aggregates=r.aggregates,a.columns=r.columns,a.fieldAliases=r.fieldAliases,ue.handleColumnFieldChangeOverride&&(a=ue.handleColumnFieldChangeOverride(a)),ue.handleOrderByReset&&(a=e&&i.some((e=>!["transaction","title"].includes(e)))?ue.handleOrderByReset(a,i.filter((e=>!["transaction","title"].includes(e)))):ue.handleOrderByReset(a,i)),f()(s,"queries",[a]),f()(s,"userHasModified",!0),ge(s)}}function Re(e){const t=e.map(_.sN),i=c()(pe),r=pe.queries.map((e=>{const i=c()(e);if(i.columns=t,t.length){if(!i.orderby){const t=(0,H._4)({widgetType:we??P.l9.DISCOVER,columns:e.columns,aggregates:e.aggregates});let r;t.length?(r=t[0].value,i.orderby=`-${r}`):i.orderby=""}}else i.orderby="";return i}));f()(i,"userHasModified",!0),f()(i,"queries",r),0===i.queries[0].columns.filter((e=>!("equation|"===e))).length?f()(i,"limit",void 0):f()(i,"limit",Math.min(i.limit??H._k,(0,H.oA)(r.length,r[0].aggregates.length))),ge(i)}function Ie(e){ge((t=>({...t,limit:e})))}function ze(e){const t=c()(pe);pe.queries.forEach(((i,r)=>{const s=c()(i);s.orderby=e,f()(t,`queries.${r}`,s)})),f()(t,"userHasModified",!0),ge(t)}function Be(){if(!J)return;le(!0);let e=[...t.widgets];const i=qe();e.splice(i,1),e=(0,N.Bb)(e),m(e),T.push((0,B.D)(xe))}async function ke(){const e=(0,N.TE)(ve);if(me&&(e.layout=me?.layout),Ze||(e.limit=void 0),await async function(e){ge({...pe,loading:!0});try{return await(0,b.QL)(oe,s.slug,e),!0}catch(e){return ge({...pe,loading:!1,errors:{...pe.errors,...(0,H.wc)(e?.responseJSON??{},{})}}),(0,w.Iw)((0,n.t)("Unable to save widget")),!1}}(e))if(fe&&(0,F.Z)("dashboards_views.widget_library.add_widget",{organization:s,title:fe}),le(!0),ne)!function(e){if(!pe.selectedDashboard)return;const t={queryNames:[],queryConditions:[],queryFields:[...e.queries[0].columns,...e.queries[0].aggregates],queryOrderby:e.queries[0].orderby};e.queries.forEach((e=>{t.queryNames.push(e.name),t.queryConditions.push(e.conditions)}));const i={displayType:e.displayType,interval:e.interval,title:e.title,...t,project:ae.projects,environment:ae.environments,...y()(ae.datetime,"period"),statsPeriod:ae.datetime?.period};(0,w.S9)((0,n.t)("Added widget.")),Le(pe.selectedDashboard,i)}(e);else{if(me){let i=[...t.widgets];const r=qe(),a={...e,id:me.id};return(0,N.I_)(me.displayType)!==(0,N.I_)(e.displayType)?(i[r]=(0,N.W8)(a),i=(0,N.Bb)(i)):i[r]=a,m(i),(0,w.S9)((0,n.t)("Updated widget.")),Le(L??H.i0),void(0,F.Z)("dashboards_views.widget_builder.save",{organization:s,data_set:e.widgetType??P.l9.DISCOVER,new_widget:!1})}m([...t.widgets,e]),(0,w.S9)((0,n.t)("Added widget.")),Le(L??H.i0),(0,F.Z)("dashboards_views.widget_builder.save",{organization:s,data_set:e.widgetType??P.l9.DISCOVER,new_widget:!0})}}function Le(e,t){const i=!g()(Te)||t?{...Te,...t}:void 0;e!==H.i0?T.push((0,B.D)({pathname:`/organizations/${s.slug}/dashboard/${e}/`,query:i})):T.push((0,B.D)({pathname:`/organizations/${s.slug}/dashboards/new/`,query:i}))}function Me(e){ge({...pe,queryConditionsValid:e})}const je=[P.FO.LINE,P.FO.AREA,P.FO.BAR].includes(pe.displayType)&&pe.queries.length<3,Ve=[P.FO.TABLE,P.FO.WORLD_MAP,P.FO.BIG_NUMBER].includes(pe.displayType),{columns:$e,aggregates:Ue,fields:We,fieldAliases:He=[]}=pe.queries[0],Xe=(0,l.useMemo)((()=>$e.map(((e,t)=>(0,_.HM)({field:e,alias:He[t]})))),[$e,He]),Qe=(0,l.useMemo)((()=>Ue.map(((e,t)=>(0,_.HM)({field:e,alias:He[t]})))),[Ue,He]),Ge=(0,C.ri)(We)?We.map(((e,t)=>(0,_.HM)({field:e,alias:He[t]}))):[...Xe,...Qe],Ye=ve.queries.some((e=>e.columns.filter((e=>!!e)).length>0)),Ke=Ze&&Ye||Ee;return J&&!ie?(0,Y.tZ)(q.Z,{title:t.title,orgSlug:se,children:(0,Y.tZ)(a.T3,{withPadding:!0,children:(0,Y.tZ)(Z.Z,{message:(0,n.t)("The widget you want to edit was not found.")})})}):(0,Y.tZ)(q.Z,{title:t.title,orgSlug:se,children:(0,Y.tZ)(E.Z,{defaultSelection:{datetime:{start:null,end:null,utc:null,period:j.GY}},children:(0,Y.tZ)(D.L,{organization:s,selection:o,children:(0,Y.tZ)($.KC,{children:(0,Y.tZ)(R.BT,{organization:s,location:r,children:(0,Y.tZ)(M.d,{organization:s,eventView:A.ZP.fromLocation(r),location:r,hideLoadingIndicator:!0,children:e=>(0,Y.tZ)(I.kP,{location:r,forceTransactions:e.forceTransactionsOnly,children:(0,Y.BX)(a.T3,{children:[(0,Y.tZ)(mt,{orgSlug:se,title:pe.title,dashboardTitle:t.title,goBackLocation:xe,onChangeTitle:e=>{Oe("title",e)}}),(0,Y.BX)(Ct,{children:[(0,Y.BX)(At,{children:[(0,Y.tZ)(Ft,{children:(0,Y.BX)(Ot,{symbol:"colored-numeric",children:[(0,Y.tZ)(Je,{location:r,widget:ve,dashboardFilters:t.filters,organization:s,pageFilters:ae,displayType:pe.displayType,error:pe.errors?.displayType,onChange:e=>{Oe("displayType",e)},noDashboardsMEPProvider:!0,isWidgetInvalid:!pe.queryConditionsValid}),(0,Y.tZ)(re,{dataSet:pe.dataSet,displayType:pe.displayType,onChange:Ce}),Ee&&(0,Y.tZ)($.k,{children:e=>{let{isMetricsData:t}=e;return(0,Y.tZ)(ee,{dataSet:pe.dataSet,queries:pe.queries,displayType:pe.displayType,widgetType:we,queryErrors:pe.errors?.queries,onQueryChange:Ae,handleColumnFieldChange:_e(t),explodedFields:Ge,tags:x,organization:s})}}),![P.FO.TABLE].includes(pe.displayType)&&(0,Y.tZ)(nt,{dataSet:pe.dataSet,displayType:pe.displayType,widgetType:we,queryErrors:pe.errors?.queries,onYAxisChange:e=>{!function(e){const t=e.map(_.sN),i=c()(pe),r=pe.queries.map((e=>{let i=c()(e);return pe.displayType===P.FO.TOP_N?(i.fields=[...i.fields?.slice(0,i.fields.length-1)??[],...t],i.aggregates=[...i.aggregates.slice(0,i.aggregates.length-1),...t]):(i.fields=[...i.columns,...t],i.aggregates=t),ue.handleOrderByReset&&(i=ue.handleOrderByReset(i,t)),i}));f()(i,"queries",r),f()(i,"userHasModified",!0),0===i.queries[0].columns.filter((e=>!("equation|"===e))).length?f()(i,"limit",void 0):f()(i,"limit",Math.min(i.limit??H._k,(0,H.oA)(r.length,r[0].aggregates.length))),ge(i)}(e)},aggregates:Qe,tags:x,organization:s}),(0,Y.tZ)(he,{queries:pe.queries,hideLegendAlias:Ve,canAddSearchConditions:je,organization:s,queryErrors:pe.errors?.queries,onAddSearchConditions:Fe,onQueryChange:Ae,onQueryRemove:De,selection:ae,widgetType:we,dashboardFilters:t.filters,location:r,onQueryConditionChange:Me}),Ze&&(0,Y.tZ)(Ne,{columns:$e.filter((e=>!("equation|"===e))).map(((e,t)=>(0,_.HM)({field:e,alias:He[t]}))),onGroupByChange:Re,organization:s,tags:x,dataSet:pe.dataSet}),Ke&&(0,Y.tZ)(Pe.j,{limit:pe.limit,displayType:pe.displayType,queries:pe.queries,dataSet:pe.dataSet,error:pe.errors?.orderby,onSortByChange:ze,onLimitChange:Ie,organization:s,widgetType:we,tags:x})]})}),(0,Y.tZ)(dt,{goBackLocation:xe,isEditing:J,onSave:ke,onDelete:Be,invalidForm:!((!ne||pe.selectedDashboard)&&pe.queryConditionsValid)})]}),(0,Y.tZ)(Dt,{children:(0,Y.tZ)(wt,{organization:s,selectedWidgetId:pe.userHasModified?null:pe.prebuiltWidgetId,onWidgetSelect:e=>{be(e.title),ce((0,V.v)(e.widgetType||P.l9.DISCOVER));const{id:t,...i}=e;ge({...pe,...i,dataSet:e.widgetType?xt[e.widgetType]:H.qg.EVENTS,userHasModified:!1,prebuiltWidgetId:t||null})},bypassOverwriteModal:!pe.userHasModified})})]})]})})})})})})})})}Et.displayName="WidgetBuilder";const qt=(0,k.Z)((0,L.Z)(Et)),Ot=(0,d.Z)(T.Z,{target:"eakptr34"})("gap:",(0,O.D)(4),";max-width:100%;"),Ct=(0,d.Z)(a.uT,{target:"eakptr33"})("&&{gap:0;padding:0;}grid-template-rows:1fr;@media (min-width: ",(e=>e.theme.breakpoints.large),"){grid-template-columns:minmax(100px, auto) 400px;}@media (min-width: ",(e=>e.theme.breakpoints.xlarge),"){grid-template-columns:1fr;}"),Ft=(0,d.Z)(a.or,{target:"eakptr32"})("max-width:1000px;flex:1;padding:",(0,O.D)(4)," ",(0,O.D)(2),";@media (min-width: ",(e=>e.theme.breakpoints.medium),"){padding:",(0,O.D)(4),";}@media (max-width: calc(",(e=>e.theme.breakpoints.large)," + ",(0,O.D)(4),")){",x.Z,"{width:calc(100% - ",(0,O.D)(4),");}}"),Dt=(0,d.Z)(a.MF,{target:"eakptr31"})("padding:",(0,O.D)(4)," ",(0,O.D)(2),";@media (max-width: ",(e=>e.theme.breakpoints.large),"){border-top:1px solid ",(e=>e.theme.gray200),";grid-row:2/2;grid-column:1/-1;max-width:100%;}@media (min-width: ",(e=>e.theme.breakpoints.large),"){border-left:1px solid ",(e=>e.theme.gray200),";padding-right:",(0,O.D)(4),";max-width:400px;}"),At=(0,d.Z)("div",{target:"eakptr30"})("display:flex;flex-direction:column;@media (max-width: ",(e=>e.theme.breakpoints.large),"){grid-column:1/-1;}");function _t(e){const t=(0,o.Z)();return(0,Y.tZ)(r.Z,{features:["dashboards-edit"],organization:t,renderDisabled:()=>(0,Y.tZ)(a.T3,{withPadding:!0,children:(0,Y.tZ)(s.bZ,{type:"warning",children:(0,n.t)("You don't have access to this feature")})}),children:(0,Y.tZ)(qt,{...e,organization:t})})}_t.displayName="WidgetBuilderContainer";const Rt=_t},"./app/views/dashboards/widgetBuilder/widgetLibrary/card.tsx":(e,t,i)=>{i.d(t,{Z:()=>u});var r=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=i("./app/styles/space.tsx"),a=i("./app/icons/index.tsx"),n=i("./app/icons/iconGraphArea.tsx"),o=i("./app/icons/iconGraphBar.tsx"),d=i("./app/views/dashboards/types.tsx"),l=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u(e){let{widget:t,iconColor:i}=e;const{title:r,description:s,displayType:u}=t,h=function(e){switch(e){case d.FO.TABLE:return a.dc;case d.FO.WORLD_MAP:return a.vc;case d.FO.BIG_NUMBER:return a.A8;case d.FO.BAR:return o.U;case d.FO.TOP_N:return a.CC;case d.FO.AREA:return n.g;case d.FO.LINE:default:return a.TX}}(u);return(0,l.BX)(c,{children:[(0,l.tZ)(y,{backgroundColor:i,children:(0,l.tZ)(h,{color:"white"})}),(0,l.BX)(p,{children:[(0,l.tZ)(g,{children:r}),(0,l.tZ)(m,{children:s})]})]})}u.displayName="Card";const c=(0,r.Z)("div",{target:"e1nh1zd14"})("display:flex;flex-direction:row;gap:",(0,s.D)(1),";"),p=(0,r.Z)("div",{target:"e1nh1zd13"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),g=(0,r.Z)("div",{target:"e1nh1zd12"})("font-size:",(e=>e.theme.fontSizeLarge),";font-weight:500;margin-bottom:0;color:",(e=>e.theme.gray500),";"),m=(0,r.Z)("small",{target:"e1nh1zd11"})("color:",(e=>e.theme.gray300),";"),y=(0,r.Z)("div",{target:"e1nh1zd10"})("display:flex;justify-content:center;align-items:center;padding:",(0,s.D)(1),";min-width:40px;height:40px;border-radius:",(e=>e.theme.borderRadius),";background:",(e=>e.backgroundColor),";")},"./app/views/performance/transactionSummary/utils.tsx":(e,t,i)=>{i.d(t,{DC:()=>c,K0:()=>p,MF:()=>w,PU:()=>m,Z6:()=>h,e1:()=>y,nx:()=>b,uI:()=>v,vd:()=>f,xf:()=>g});var r=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=i("./app/styles/space.tsx"),a=i("./app/utils/discover/urls.tsx"),n=i("./app/utils/getRouteStringFromRoutes.tsx"),o=i("./app/utils/performance/urls.ts"),d=i("./app/utils/profiling/routes.tsx"),l=i("./app/utils/tokenizeSearch.tsx"),u=i("./app/views/performance/traceDetails/utils.tsx");let c,p;function g(e){const t=m(e);return t.removeFilter("transaction"),t}function m(e){const t=new l.MY(e);return t.removeFilter("event.type"),t}function y(e){let{orgSlug:t,transaction:i,projectID:r,query:s,unselectedSeries:a="p100()",display:n,trendFunction:o,trendColumn:d,showTransactions:l,additionalQuery:u,subPath:c}=e;const p=function(e){let{orgSlug:t,subPath:i}=e;return`/organizations/${t}/performance/summary/${i?`${i}/`:""}`}({orgSlug:t,subPath:c});let m;return m="string"==typeof s.query?g(s.query).formatString():s.query,{pathname:p,query:{transaction:i,project:r,environment:s.environment,statsPeriod:s.statsPeriod,start:s.start,end:s.end,query:m,unselectedSeries:a,showTransactions:l,display:n,trendFunction:o,trendColumn:d,referrer:"performance-transaction-summary",...u}}}function h(e){return(t,i,r)=>{const s=`${i.trace}`;return s?(0,u.YA)(t,s,e,{}):{}}}function f(e){return(t,i,r,s)=>{const n=(0,a.JE)(i);return(0,o.D)(t.slug,n,e,r,s)}}function b(){return(e,t,i)=>{const r=t["profile.id"];return r?(0,d.O$)({orgSlug:e.slug,projectSlug:String(t["project.name"]),profileId:String(r)}):{}}}function w(e){const t=(0,n.Z)(e);return(e,i,r)=>{const s=i.replayId;if(!s)return{};const a=`${i["project.name"]}:${s}`;if(!i.timestamp)return{pathname:`/organizations/${e.slug}/replays/${a}/`,query:{referrer:t}};const n=new Date(i.timestamp).getTime()-i["transaction.duration"];return{pathname:`/organizations/${e.slug}/replays/${a}/`,query:{event_t:n,referrer:t}}}}!function(e){e.DURATION_PERCENTILE="durationpercentile",e.DURATION="duration",e.LATENCY="latency",e.TREND="trend",e.VITALS="vitals",e.USER_MISERY="usermisery"}(c||(c={})),function(e){e.FASTEST="fastest",e.SLOW="slow",e.OUTLIER="outlier",e.RECENT="recent"}(p||(p={}));const v=(0,r.Z)("div",{target:"etoucxl0"})("margin-top:",(0,s.D)(3),";")}}]);
//# sourceMappingURL=../sourcemaps/app_views_dashboards_widgetBuilder_index_tsx-app_views_performance_transactionSummary_utils_tsx.c145002c081ead9dd1180babe2d62acc.js.map