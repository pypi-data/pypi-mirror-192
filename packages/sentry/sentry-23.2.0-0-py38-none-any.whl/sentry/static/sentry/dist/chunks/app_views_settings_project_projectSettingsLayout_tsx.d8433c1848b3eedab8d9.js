"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_project_projectSettingsLayout_tsx"],{"./app/components/projects/appStoreConnectContext.tsx":(t,e,s)=>{s.d(e,{Z:()=>c,z:()=>p});var o=s("../node_modules/react/index.js"),r=s("./app/utils/appStoreValidationErrorMessage.tsx"),n=s("./app/utils/useApi.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(0,o.createContext)(void 0),p=t=>{let{children:e,project:s,organization:p}=t;const c=(0,n.Z)(),[l,u]=(0,o.useState)(),[d,m]=(0,o.useState)(void 0),h=(0,o.useMemo)((()=>(l?.symbolSources?JSON.parse(l.symbolSources):[]).reduce(((t,e)=>{let{type:s,id:o,...r}=e;return"appstoreconnect"===s.toLowerCase()&&(t[o]={type:s,...r}),t}),{})),[l?.symbolSources]);function j(t,e){if("valid"!==e?.status)return(0,r.e)(e,t)}return(0,o.useEffect)((()=>{if(!s||l)return;if(s.symbolSources)return void u(s);let t=!1;return c.requestPromise(`/projects/${p.slug}/${s.slug}/`).then((e=>{t||u(e)})).catch((()=>{})),()=>{t=!0}}),[s,p,c]),(0,o.useEffect)((()=>{if(!l)return;if(!Object.keys(h).length)return;let t=!1;return c.requestPromise(`/projects/${p.slug}/${l.slug}/appstoreconnect/status/`).then((e=>{t||m(e)})).catch((()=>{})),()=>{t=!0}}),[l,p,h,c]),(0,i.tZ)(a.Provider,{value:d&&s?Object.keys(d).reduce(((t,e)=>{const o=d[e];return{...t,[e]:{...o,updateAlertMessage:j({name:h[e].name,link:`/settings/${p.slug}/projects/${s.slug}/debug-symbols/?customRepository=${e}`},o.credentials)}}}),{}):void 0,children:e})};p.displayName="Provider";const c=a},"./app/utils/appStoreValidationErrorMessage.tsx":(t,e,s)=>{s.d(e,{O:()=>a,e:()=>p}),s("../node_modules/core-js/modules/es.error.cause.js");var o=s("../node_modules/@sentry/core/esm/exports.js"),r=s("./app/components/links/link.tsx"),n=s("./app/locale.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(0,n.t)("An unexpected error occurred while configuring the App Store Connect integration");function p(t,e){switch(t.code){case"app-connect-authentication-error":return e?(0,n._N)("App Store Connect credentials are invalid or missing. [linkToCustomRepository]",{linkToCustomRepository:(0,i.tZ)(r.Z,{to:e.link,children:(0,n._N)("Make sure the credentials of the '[customRepositoryName]' repository are correct and exist.",{customRepositoryName:e.name})})}):(0,n.t)("The supplied App Store Connect credentials are invalid or missing.");case"app-connect-forbidden-error":return(0,n.t)("The supplied API key does not have sufficient permissions.");case"app-connect-multiple-sources-error":return(0,n.t)("Only one App Store Connect application is allowed in this project.");default:return o.Tb(new Error("Unknown app store connect error.")),a}}},"./app/views/settings/project/projectSettingsLayout.tsx":(t,e,s)=>{s.r(e),s.d(e,{default:()=>D});var o,r=s("../node_modules/react/index.js"),n=s("./app/components/projects/appStoreConnectContext.tsx"),i=s("./app/utils/routeAnalytics/useRouteAnalyticsParams.tsx"),a=s("./app/utils/withOrganization.tsx"),p=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),l=s("../node_modules/react-document-title/index.js"),u=s.n(l),d=s("./app/actionCreators/members.tsx"),m=s("./app/actionCreators/projects.tsx"),h=s("./app/components/alert.tsx"),j=s("./app/components/layouts/thirds.tsx"),g=s("./app/components/loadingError.tsx"),y=s("./app/components/loadingIndicator.tsx"),f=s("./app/components/projects/missingProjectMembership.tsx"),x=s("./app/locale.tsx"),S=s("./app/sentryTypes.tsx"),Z=s("./app/stores/memberListStore.tsx"),b=s("./app/stores/projectsStore.tsx"),N=s("./app/styles/space.tsx"),P=s("./app/utils/withApi.tsx"),v=s("./app/utils/withProjects.tsx"),w=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");!function(t){t.MISSING_MEMBERSHIP="MISSING_MEMBERSHIP",t.PROJECT_NOT_FOUND="PROJECT_NOT_FOUND",t.UNKNOWN="UNKNOWN"}(o||(o={}));class C extends r.Component{constructor(){super(...arguments),(0,p.Z)(this,"state",this.getInitialState()),(0,p.Z)(this,"docTitleRef",(0,r.createRef)()),(0,p.Z)(this,"unsubscribeProjects",b.Z.listen((t=>this.onProjectChange(t)),void 0)),(0,p.Z)(this,"unsubscribeMembers",Z.Z.listen((t=>this.setState({memberList:t})),void 0))}getInitialState(){return{loading:!0,error:!1,errorType:null,memberList:[],project:null}}getChildContext(){return{project:this.state.project}}componentDidMount(){const{loadingProjects:t}=this.props;t||this.fetchData()}componentWillReceiveProps(t){t.projectId!==this.props.projectId&&(t.skipReload||this.remountComponent())}componentDidUpdate(t,e){if(t.projectId!==this.props.projectId&&this.fetchData(),t.projects.length!==this.props.projects.length&&this.fetchData(),e.project!==this.state.project){const t=this.docTitleRef.current;if(!t)return;t.forceUpdate()}}componentWillUnmount(){this.unsubscribeMembers(),this.unsubscribeProjects()}remountComponent(){this.setState(this.getInitialState())}getTitle(){return this.state.project?.slug??"Sentry"}onProjectChange(t){this.state.project&&t.has(this.state.project.id)&&this.setState({project:{...b.Z.getById(this.state.project.id)}})}identifyProject(){const{projects:t,projectId:e}=this.props,s=e;return t.find((t=>{let{slug:e}=t;return e===s}))||null}async fetchData(){const{orgId:t,projectId:e,skipReload:s}=this.props,r=this.identifyProject(),n=r&&r.hasAccess;if(this.setState((t=>({loading:!s||t.loading,project:r}))),r&&n){(0,m.pK)(null);const s=this.props.api.requestPromise(`/projects/${t}/${e}/`);try{const t=await s;this.setState({loading:!1,project:t,error:!1,errorType:null}),(0,m.pK)(t)}catch(t){this.setState({loading:!1,error:!1,errorType:o.UNKNOWN})}(0,d.MA)(this.props.api,t,[r.id])}else if(!r||r.isMember)try{await this.props.api.requestPromise(`/projects/${t}/${e}/`)}catch(t){this.setState({loading:!1,error:!0,errorType:o.PROJECT_NOT_FOUND})}else this.setState({loading:!1,error:!0,errorType:o.MISSING_MEMBERSHIP})}renderBody(){const{children:t,organization:e}=this.props,{error:s,errorType:r,loading:n,project:i}=this.state;if(n)return(0,w.tZ)("div",{className:"loading-full-layout",children:(0,w.tZ)(y.Z,{})});if(!s&&i)return"function"==typeof t?t({project:i}):t;switch(r){case o.PROJECT_NOT_FOUND:return(0,w.tZ)(j.T3,{withPadding:!0,children:(0,w.tZ)(h.ZP,{type:"warning",children:(0,x.t)("The project you were looking for was not found.")})});case o.MISSING_MEMBERSHIP:return(0,w.tZ)(T,{children:(0,w.tZ)(f.Z,{organization:e,project:i})});default:return(0,w.tZ)(g.Z,{onRetry:this.remountComponent})}}render(){return(0,w.tZ)(u(),{ref:this.docTitleRef,title:this.getTitle(),children:this.renderBody()})}}C.displayName="ProjectContext",(0,p.Z)(C,"childContextTypes",{project:S.Z.Project});const _=(0,P.Z)((0,a.Z)((0,v.Z)(C))),T=(0,c.Z)("div",{target:"e11jq8dm0"})("width:100%;margin:",(0,N.D)(2)," ",(0,N.D)(4),";");var I=s("./app/views/settings/components/settingsLayout.tsx"),M=s("./app/utils/withProject.tsx"),O=s("./app/views/settings/components/settingsNavigation.tsx"),R=s("./app/views/settings/project/navigationConfiguration.tsx");const E=t=>{let{organization:e,project:s}=t;const o=(0,r.useContext)(n.Z),i=!!o&&Object.keys(o).some((t=>"invalid"===o[t].credentials.status));return(0,w.tZ)(O.Z,{navigationObjects:(0,R.Z)({project:s,organization:e,debugFilesNeedsReview:i}),access:new Set(e.access),features:new Set(e.features),organization:e,project:s})};E.displayName="ProjectSettingsNavigation";const k=(0,M.Z)(E);function z(t){let{params:e,routes:s,project:o,organization:a,children:p,...c}=t;return(0,i.Z)({project_id:o.id,project_platform:o.platform}),(0,w.tZ)(n.z,{project:o,organization:a,children:(0,w.tZ)(I.Z,{params:e,routes:s,...c,renderNavigation:()=>(0,w.tZ)(k,{organization:a}),children:p&&(0,r.isValidElement)(p)?(0,r.cloneElement)(p,{organization:a,project:o}):p})})}function A(t){let{organization:e,params:s,...o}=t;return(0,w.tZ)(_,{orgId:e.slug,projectId:s.projectId,children:t=>{let{project:r}=t;return(0,w.tZ)(z,{params:s,project:r,organization:e,...o})}})}z.displayName="InnerProjectSettingsLayout",A.displayName="ProjectSettingsLayout";const D=(0,a.Z)(A)}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_projectSettingsLayout_tsx.4578a3f31ede8d94ef36d873d63e5d54.js.map