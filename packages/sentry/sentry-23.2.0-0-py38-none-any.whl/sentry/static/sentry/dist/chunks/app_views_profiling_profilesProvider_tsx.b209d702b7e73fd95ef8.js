"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_profiling_profilesProvider_tsx"],{"./app/components/profiling/profilingBreadcrumbs.tsx":(e,r,t)=>{t.d(r,{u:()=>p}),t("../node_modules/core-js/modules/es.error.cause.js");var o=t("../node_modules/react/index.js"),n=t("../node_modules/lodash/omit.js"),a=t.n(n),i=t("./app/components/breadcrumbs.tsx"),l=t("./app/locale.tsx"),s=t("./app/utils/profiling/routes.tsx"),u=t("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{organization:r,trails:t}=e;const n=(0,o.useMemo)((()=>t.map((e=>function(e,r){let{organization:t}=r;switch(e.type){case"landing":return{to:(0,s.XR)({query:a()(e.payload.query,["cursor","query"]),orgSlug:t.slug}),label:(0,l.t)("Profiling"),preservePageFilters:!0};case"profile summary":return{to:(0,s.R0)({query:a()(e.payload.query,["cursor","query"]),orgSlug:t.slug,projectSlug:e.payload.projectSlug,transaction:e.payload.transaction}),label:(0,l.t)("Profile Summary"),preservePageFilters:!0};case"flamechart":return{to:("flamechart"===e.payload.tab?s.TH:s.Qy)({query:e.payload.query,orgSlug:t.slug,projectSlug:e.payload.projectSlug,profileId:e.payload.profileId}),label:e.payload.transaction,preservePageFilters:!0};default:throw new Error(`Unknown breadcrumb type: ${JSON.stringify(e)}`)}}(e,{organization:r})))),[r,t]);return(0,u.tZ)(i.Z,{crumbs:n})}p.displayName="ProfilingBreadcrumbs"},"./app/utils/profiling/guards/profile.tsx":(e,r,t)=>{function o(e){return"object"==typeof e&&"profiles"in e&&Array.isArray(e.profiles)&&"shared"in e}function n(e){return"type"in e&&"evented"===e.type}function a(e){return"type"in e&&"sampled"===e.type}function i(e){return!("type"in e)&&Array.isArray(e.resources)}function l(e){return"profile"in e&&"samples"in e.profile&&"stacks"in e.profile&&"frames"in e.profile}function s(e){return"object"==typeof e&&"traceEvents"in e}function u(e){return Array.isArray(e)&&!e.some((e=>"P"===e.ph&&"ProfileChunk"===e.name))}function p(e){return u(e)||s(e)||function(e){return Array.isArray(e)&&e.some((e=>"P"===e.ph&&"ProfileChunk"===e.name))}(e)}t.d(r,{AN:()=>l,BE:()=>i,Us:()=>a,_b:()=>u,bf:()=>n,nN:()=>o,pi:()=>p,zx:()=>s})},"./app/utils/profiling/routes.tsx":(e,r,t)=>{function o(e){let{orgSlug:r,projectSlug:t,profileId:o}=e;return`/organizations/${r}/profiling/profile/${t}/${o}/flamechart/`}function n(e){let{orgSlug:r,query:t}=e;const o=function(e){let{orgSlug:r}=e;return`/organizations/${r}/profiling/`}({orgSlug:r});return{pathname:o,query:{...t}}}function a(e){let{orgSlug:r,projectSlug:t,transaction:o,query:n}=e;const a=function(e){let{orgSlug:r,projectSlug:t}=e;return`/organizations/${r}/profiling/summary/${t}/`}({orgSlug:r,projectSlug:t});return{pathname:a,query:{...n,transaction:o}}}function i(e){let{orgSlug:r,projectSlug:t,profileId:n,query:a}=e;return{pathname:o({orgSlug:r,projectSlug:t,profileId:n}),query:{...a}}}function l(e){let{orgSlug:r,projectSlug:t,profileId:o,frameName:n,framePackage:a,query:l}=e;return i({orgSlug:r,projectSlug:t,profileId:o,query:{...l,frameName:n,framePackage:a}})}function s(e){let{orgSlug:r,projectSlug:t,profileId:o,query:n}=e;const a=function(e){let{orgSlug:r,projectSlug:t,profileId:o}=e;return`/organizations/${r}/profiling/profile/${t}/${o}/details/`}({orgSlug:r,projectSlug:t,profileId:o});return{pathname:a,query:{...n}}}t.d(r,{O$:()=>o,Qy:()=>s,R0:()=>a,TH:()=>i,XR:()=>n,u$:()=>l})},"./app/views/profiling/profilesProvider.tsx":(e,r,t)=>{t.r(r),t.d(r,{ProfileContext:()=>Z,ProfilesProvider:()=>N,default:()=>C,useProfileTransaction:()=>k,useProfiles:()=>$,useSetProfiles:()=>_}),t("../node_modules/core-js/modules/es.error.cause.js");var o=t("../node_modules/react/index.js"),n=t("../node_modules/@sentry/core/esm/exports.js"),a=t("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=t("./app/components/button.tsx"),l=t("./app/components/layouts/thirds.tsx"),s=t("./app/components/links/link.tsx"),u=t("./app/components/profiling/profilingBreadcrumbs.tsx"),p=t("./app/locale.tsx"),c=t("./app/styles/space.tsx"),d=t("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),f=t("./app/utils/performance/urls.ts"),g=t("./app/utils/profiling/guards/profile.tsx"),m=t("./app/utils/profiling/routes.tsx"),y=t("./app/utils/useLocation.tsx"),h=t("./app/utils/useOrganization.tsx"),S=t("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function v(e){let{transaction:r,projectId:t,eventId:n}=e;const a=(0,y.T)(),c=(0,h.Z)(),v=$(),b="resolved"===v.type?(I=v.data,(0,g.nN)(I)?I.metadata.transactionName:(0,g.AN)(I)&&I.transactions?.[0]?.name||(0,p.t)("Unknown Transaction")):"";var I;const Z=n??"",w=t??"",_=r?.id?(0,f.D)(c.slug,`${w}:${r.id}`):null,z=(0,o.useMemo)((()=>[{type:"landing",payload:{query:a.query}},{type:"profile summary",payload:{projectSlug:w,transaction:b,query:a.query}},{type:"flamechart",payload:{transaction:b,profileId:Z,projectSlug:w,query:a.query,tab:a.pathname.endsWith("details/")?"details":"flamechart"}}]),[a,w,b,Z]);return(0,S.BX)(x,{children:[(0,S.tZ)(j,{children:(0,S.tZ)(P,{children:(0,S.tZ)(u.u,{organization:c,trails:z})})}),(0,S.tZ)(l.kP,{children:_&&(0,S.tZ)(i.zx,{size:"sm",onClick:function(){(0,d.Z)("profiling_views.go_to_transaction",{organization:c,source:"transaction_details"})},to:_,children:(0,p.t)("Go to Transaction")})}),(0,S.BX)(q,{underlined:!0,children:[(0,S.tZ)("li",{className:a.pathname.endsWith("flamechart/")?"active":void 0,children:(0,S.tZ)(s.Z,{to:(0,m.TH)({orgSlug:c.slug,projectSlug:w,profileId:Z,query:a.query}),children:(0,p.t)("Flamechart")})}),(0,S.tZ)("li",{className:a.pathname.endsWith("details/")?"active":void 0,children:(0,S.tZ)(s.Z,{to:(0,m.Qy)({orgSlug:c.slug,projectSlug:w,profileId:Z,query:a.query}),children:(0,p.t)("Details")})})]})]})}v.displayName="ProfileHeader";const j=(0,a.Z)(l.oB,{target:"e1eqzoq73"})("margin-bottom:",(0,c.D)(1.5),";"),P=(0,a.Z)("div",{target:"e1eqzoq72"})("nav{padding-bottom:",(0,c.D)(1),";}"),q=(0,a.Z)(l.mL,{target:"e1eqzoq71"})({name:"78ouv5",styles:"a{padding-top:0!important;}"}),x=(0,a.Z)(l.h4,{target:"e1eqzoq70"})("padding:",(0,c.D)(1)," ",(0,c.D)(2)," ",(0,c.D)(0)," ",(0,c.D)(2),"!important;");var b=t("./app/utils/useApi.tsx"),I=t("./app/utils/useParams.tsx");const Z=(0,o.createContext)(null),w=(0,o.createContext)(null);function $(){const e=(0,o.useContext)(Z);if(!e)throw new Error("useProfiles was called outside of ProfileProvider");return e}function _(){const e=(0,o.useContext)(w);if(!e)throw new Error("useSetProfiles was called outside of SetProfileProvider");return e}const z=(0,o.createContext)(null);function k(){const e=(0,o.useContext)(z);if(!e)throw new Error("useProfileTransaction was called outside of ProfileTransactionContext");return e}function A(e){const r=(0,h.Z)(),t=(0,I.U)(),[n,a]=(0,o.useState)({type:"initial"}),i=function(e,r,t){const n=(0,b.Z)(),[a,i]=(0,o.useState)({type:"initial"});return(0,o.useEffect)((()=>{if(null!==t)return function(e,r,t,o){return e.requestPromise(`/projects/${r}/${t}/events/${o}/`)}(n,e,r,t).then((e=>{i({type:"resolved",data:e})})).catch((e=>{i({type:"errored",error:e})})),()=>{n.clear()}}),[n,e,r,t]),a}(t.orgId,t.projectId,"resolved"===n.type?(l=n.data,(0,g.nN)(l)?l.metadata.transactionID:null):null);var l;return(0,S.tZ)(N,{onUpdateProfiles:a,orgSlug:r.slug,profileId:t.eventId,projectSlug:t.projectId,children:(0,S.tZ)(w.Provider,{value:a,children:(0,S.BX)(z.Provider,{value:i,children:[(0,S.tZ)(v,{eventId:t.eventId,projectId:t.projectId,transaction:"resolved"===i.type?i.data:null}),e.children]})})})}function N(e){let{children:r,onUpdateProfiles:t,orgSlug:a,projectSlug:i,profileId:l}=e;const s=(0,b.Z)(),[u,c]=(0,o.useState)({type:"initial"});return(0,o.useEffect)((()=>{if(l&&i&&a)return c({type:"loading"}),function(e,r,t,o){return e.requestPromise(`/projects/${o}/${t}/profiling/profiles/${r}/`,{method:"GET",includeAllArgs:!0}).then((e=>{let[r]=e;return r}))}(s,l,i,a).then((e=>{c({type:"resolved",data:e}),t?.({type:"resolved",data:e})})).catch((e=>{const r=e.toString()||(0,p.t)("Error: Unable to load profiles");c({type:"errored",error:r}),t?.({type:"errored",error:r}),n.Tb(e)})),()=>{s.clear()}}),[s,t,a,i,l]),(0,S.tZ)(Z.Provider,{value:u,children:r})}A.displayName="ProfileProviderWrapper",N.displayName="ProfilesProvider";const C=A}}]);
//# sourceMappingURL=../sourcemaps/app_views_profiling_profilesProvider_tsx.ee026b75ddab8f428b03771e10fbcd69.js.map