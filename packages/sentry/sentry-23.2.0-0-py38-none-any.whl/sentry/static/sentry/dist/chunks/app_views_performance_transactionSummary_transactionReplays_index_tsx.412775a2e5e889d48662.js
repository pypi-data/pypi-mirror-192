"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionReplays_index_tsx"],{"./app/views/performance/transactionSummary/transactionReplays/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var s=n("./app/components/acl/feature.tsx"),a=n("./app/components/alert.tsx"),r=n("./app/components/layouts/thirds.tsx"),i=n("./app/locale.tsx"),o=n("./app/utils/useOrganization.tsx"),p=n("../node_modules/react/index.js"),l=n("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),c=n("./app/components/loadingIndicator.tsx"),u=n("./app/utils/discover/eventView.tsx"),d=n("./app/utils/discover/fields.tsx"),y=n("./app/utils/replays/hooks/useReplayList.tsx"),m=n("./app/utils/useLocation.tsx"),v=n("./app/utils/useMedia.tsx"),g=n("./app/utils/useProjects.tsx"),f=n("./app/views/performance/transactionSummary/pageLayout.tsx"),h=n("./app/views/performance/transactionSummary/tabs.tsx"),x=n("./app/views/replays/replayTable/index.tsx"),w=n("./app/views/replays/replayTable/types.tsx"),Z=n("../node_modules/@sentry/core/esm/exports.js"),b=n("./app/utils/discover/genericDiscoverQuery.tsx"),E=n("./app/utils/queryString.tsx"),R=n("./app/utils/replays/fetchReplayList.tsx"),j=n("./app/utils/useApi.tsx");var k=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function I(){const e=(0,m.T)(),t=(0,o.Z)(),{projects:n}=(0,g.Z)();return(0,k.tZ)(f.ZP,{location:{...e,query:{...e.query,statsPeriod:"14d"}},organization:t,projects:n,tab:h.Z.Replays,getDocumentTitle:S,generateEventView:q,childComponent:z})}function S(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,i.t)("Replays")].join(" — "):[(0,i.t)("Summary"),(0,i.t)("Replays")].join(" — ")}function q(e){let{location:t,transactionName:n}=e;const s=["replayId","count()","transaction.duration","trace","timestamp",...d.$4,d.zD];return u.ZP.fromSavedQuery({id:"",name:"Replay events within a transaction",version:2,fields:s,query:`event.type:transaction transaction:"${n}" !replayId:""`,projects:[Number(t.query.project)]})}function z(e){let{eventView:t,location:n,organization:s,setError:a}=e;const{data:i,fetchError:o,isFetching:l,pageLinks:d}=function(e){let{location:t,organization:n,replayIdsEventView:s}=e;const a=(0,j.Z)(),[r,i]=(0,p.useState)({events:[],pageLinks:null,replayIds:void 0}),[o,l]=(0,p.useState)(),{cursor:c}=t.query,d=(0,p.useCallback)((async()=>{try{const[{data:e},t,r]=await(0,b.AA)(a,`/organizations/${n.slug}/events/`,s.getEventsAPIPayload({query:{cursor:c}}));i({pageLinks:r?.getResponseHeader("Link")??"",replayIds:e.map((e=>String(e.replayId))),events:e||[]})}catch(e){Z.Tb(e),l(e)}}),[a,c,n.slug,s]),y=(0,p.useMemo)((()=>r.replayIds?u.ZP.fromSavedQuery({id:"",name:"",version:2,fields:R.p8,projects:[],query:`id:[${String(r.replayIds)}]`,orderby:(0,E.ro)(t.query.sort,R.yw)}):null),[t.query.sort,r.replayIds]);return(0,p.useEffect)((()=>{d()}),[d]),{data:y?{events:r.events,replayRecordsEventView:y}:null,fetchError:o,isFetching:!o&&!r.replayIds,pageLinks:r.pageLinks}}({replayIdsEventView:t,location:n,organization:s});if((0,p.useEffect)((()=>{a(o?.message??o)}),[a,o]),!i)return l?(0,k.tZ)(r.or,{fullWidth:!0,children:(0,k.tZ)(c.Z,{})}):(0,k.tZ)(p.Fragment,{children:null});const{events:y,replayRecordsEventView:m}=i;return(0,k.tZ)(L,{eventView:m,events:y,organization:s,pageLinks:d})}function L(e){let{eventView:t,events:n,organization:s}=e;const a=(0,p.useMemo)((()=>({query:{}})),[]),i=(0,l.u)(),o=(0,v.Z)(`(min-width: ${i.breakpoints.small})`),{replays:c,isFetching:u,fetchError:d}=(0,y.Z)({eventView:t,location:a,organization:s}),m=function(e){let{events:t,replays:n}=e;const s=n?.map((e=>{const n=t.reduce(((t,n)=>n.replayId!==e.id?t:t["transaction.duration"]?n["transaction.duration"]>t["transaction.duration"]?n:t:n),{});return{...e,txEvent:n??{}}}));return s}({replays:c,events:n});return(0,k.tZ)(r.or,{fullWidth:!0,children:(0,k.tZ)(x.Z,{fetchError:d,isFetching:u,replays:m,sort:void 0,visibleColumns:[w.M.session,...o?[w.M.slowestTransaction,w.M.startedAt]:[],w.M.duration,w.M.countErrors,w.M.activity]})})}I.displayName="TransactionReplays",z.displayName="ReplaysContentWrapper",L.displayName="ReplaysContent";const T=I;function V(){return(0,k.tZ)(r.T3,{withPadding:!0,children:(0,k.tZ)(a.bZ,{type:"warning",children:(0,i.t)("You don't have access to this feature")})})}function _(){const e=(0,o.Z)();return(0,k.tZ)(s.Z,{features:["session-replay-ui"],organization:e,renderDisabled:V,children:(0,k.tZ)(T,{})})}V.displayName="renderNoAccess",_.displayName="TransactionReplaysContainer";const M=_}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionReplays_index_tsx.a37d11430860a86967213ffa827dac6e.js.map