(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_organizationStats_teamInsights_health_tsx-node_modules_lodash_mean_js"],{"./app/components/charts/sessionsRequest.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var s=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/react/index.js")),o=r("../node_modules/lodash/isEqual.js"),i=r.n(o),a=r("../node_modules/lodash/omitBy.js"),l=r.n(a),d=r("./app/actionCreators/indicator.tsx"),c=r("./app/locale.tsx"),u=r("./app/utils/sessions.tsx");const p=["api","children","organization"],g=e=>l()(e,((e,t)=>p.includes(t)));class h extends n.Component{constructor(){super(...arguments),(0,s.Z)(this,"state",{reloading:!1,errored:!1,response:null}),(0,s.Z)(this,"fetchData",(async()=>{const{api:e,isDisabled:t,shouldFilterSessionsInTimeWindow:r}=this.props;if(!t){this.setState((e=>({reloading:null!==e.response,errored:!1})));try{const t=await e.requestPromise(this.path,{query:this.baseQueryParams});this.setState({reloading:!1,response:r?(0,u.U5)(t,this.baseQueryParams.start,this.baseQueryParams.end):t})}catch(e){(0,d.Iw)(e.responseJSON?.detail??(0,c.t)("Error loading health data")),this.setState({reloading:!1,errored:!0})}}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){i()(g(e),g(this.props))||this.fetchData()}get path(){const{organization:e}=this.props;return`/organizations/${e.slug}/sessions/`}get baseQueryParams(){const{project:e,environment:t,field:r,statsPeriod:s,start:n,end:o,query:i,groupBy:a,interval:l,organization:d}=this.props;return{project:e,environment:t,field:r,statsPeriod:s,query:i,groupBy:a,start:n,end:o,interval:l||(0,u.Xz)({start:n,end:o,period:s},{highFidelity:d.features.includes("minute-resolution-sessions")})}}render(){const{reloading:e,errored:t,response:r}=this.state,{children:s}=this.props;return s({loading:null===r,reloading:e,errored:t,response:r})}}h.displayName="SessionsRequest";const m=h},"./app/utils/discover/discoverQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>l,_:()=>a});var s=r("./app/utils/discover/genericDiscoverQuery.tsx"),n=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function i(e){return(0,n.tZ)(s.ZP,{route:"events",shouldRefetchData:o,afterFetch:(e,t)=>{const{fields:r,...s}=e.meta??{};return{...e,meta:{...r,...s}}},...e})}function a(e){return(0,s.JC)({route:"events",shouldRefetchData:o,afterFetch:(e,t)=>{const{fields:r,...s}=e.meta??{};return{...e,meta:{...r,...s}}},...e})}i.displayName="DiscoverQuery";const l=i},"./app/utils/profiling/routes.tsx":(e,t,r)=>{"use strict";function s(e){let{orgSlug:t,projectSlug:r,profileId:s}=e;return`/organizations/${t}/profiling/profile/${r}/${s}/flamechart/`}function n(e){let{orgSlug:t,query:r}=e;const s=function(e){let{orgSlug:t}=e;return`/organizations/${t}/profiling/`}({orgSlug:t});return{pathname:s,query:{...r}}}function o(e){let{orgSlug:t,projectSlug:r,transaction:s,query:n}=e;const o=function(e){let{orgSlug:t,projectSlug:r}=e;return`/organizations/${t}/profiling/summary/${r}/`}({orgSlug:t,projectSlug:r});return{pathname:o,query:{...n,transaction:s}}}function i(e){let{orgSlug:t,projectSlug:r,profileId:n,query:o}=e;return{pathname:s({orgSlug:t,projectSlug:r,profileId:n}),query:{...o}}}function a(e){let{orgSlug:t,projectSlug:r,profileId:s,frameName:n,framePackage:o,query:a}=e;return i({orgSlug:t,projectSlug:r,profileId:s,query:{...a,frameName:n,framePackage:o}})}function l(e){let{orgSlug:t,projectSlug:r,profileId:s,query:n}=e;const o=function(e){let{orgSlug:t,projectSlug:r,profileId:s}=e;return`/organizations/${t}/profiling/profile/${r}/${s}/details/`}({orgSlug:t,projectSlug:r,profileId:s});return{pathname:o,query:{...n}}}r.d(t,{O$:()=>s,Qy:()=>l,R0:()=>o,TH:()=>i,XR:()=>n,u$:()=>a})},"./app/views/organizationStats/teamInsights/health.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ke});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=r("../node_modules/react/index.js"),o=r("./app/components/layouts/thirds.tsx"),i=r("./app/components/loadingIndicator.tsx"),a=r("./app/components/noProjectMessage.tsx"),l=r("./app/components/sentryDocumentTitle.tsx"),d=r("./app/locale.tsx"),c=r("./app/utils/localStorage.tsx"),u=r("./app/utils/routeAnalytics/useRouteAnalyticsEventNames.tsx"),p=r("./app/utils/useOrganization.tsx"),g=r("./app/utils/useTeams.tsx"),h=r("./app/views/organizationStats/header.tsx"),m=r("./app/views/organizationStats/teamInsights/controls.tsx"),f=r("./app/views/organizationStats/teamInsights/descriptionCard.tsx"),y=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),Z=r("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),x=r("../node_modules/lodash/round.js"),v=r.n(x),S=r("./app/components/asyncComponent.tsx"),b=r("./app/components/button.tsx"),j=r("./app/components/charts/barChart.tsx"),w=r("./app/components/links/link.tsx"),z=r("./app/components/organizations/pageFilters/parse.tsx"),T=r("./app/components/panels/panelTable.tsx"),D=r("./app/icons/index.tsx"),_=r("./app/styles/space.tsx"),$=r("./app/utils/formatters.tsx"),N=r("./app/views/organizationStats/teamInsights/styles.tsx"),R=r("./app/views/organizationStats/teamInsights/utils.tsx"),M=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class q extends S.Z{constructor(){super(...arguments),(0,y.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),alertsTriggered:null,alertsTriggeredRules:null}}getEndpoints(){const{organization:e,start:t,end:r,period:s,utc:n,teamSlug:o}=this.props,i={start:t,end:r,period:s,utc:n};return[["alertsTriggered",`/teams/${e.slug}/${o}/alerts-triggered/`,{query:{...(0,z.fK)(i)}}],["alertsTriggeredRules",`/teams/${e.slug}/${o}/alerts-triggered-index/`,{query:{...(0,z.fK)(i)}}]]}componentDidUpdate(e){const{start:t,end:r,period:s,utc:n,teamSlug:o}=this.props;e.start===t&&e.end===r&&e.period===s&&e.utc===n&&e.teamSlug===o||this.remountComponent()}renderTrend(e){const{weeklyAvg:t,totalThisWeek:r}=e,s=r-t;return 0===t?"—":(0,M.BX)(A,{color:s<=0?"successText":"errorText",children:[(0,$.rl)(Math.abs(s/t),0),(0,M.tZ)(P,{direction:s<=0?"down":"up",size:"xs"})]})}renderLoading(){return(0,M.tZ)(k,{children:(0,M.tZ)(i.Z,{})})}renderBody(){const{organization:e,period:t,projects:r}=this.props,{alertsTriggered:s,alertsTriggeredRules:o}=this.state,i=(0,R.Gs)((0,R.E7)(s??{}));return(0,M.BX)(n.Fragment,{children:[(0,M.tZ)(k,{children:(0,M.tZ)(j.v,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",legend:{right:0,top:0},yAxis:{minInterval:1},xAxis:(0,R.tP)(i.length),series:[{seriesName:(0,d.t)("Alerts Triggered"),data:i,silent:!0,barCategoryGap:"5%"}]})}),(0,M.tZ)(B,{isEmpty:!s||!o||0===o.length,emptyMessage:(0,d.t)("No alerts triggered for this team’s projects"),emptyAction:(0,M.BX)(L,{children:[(0,M.tZ)(b.zx,{priority:"primary",size:"sm",to:`/organizations/${e.slug}/alerts/rules/`,children:(0,d.t)("Create Alert")}),(0,M.tZ)(b.zx,{size:"sm",external:!0,to:"https://docs.sentry.io/product/alerts/create-alerts/",children:(0,d.t)("Learn more")})]}),headers:[(0,d.t)("Alert Rule"),(0,d.t)("Project"),(0,M.tZ)(C,{children:(0,d._N)("Last [period] Average",{period:t})},"last"),(0,M.tZ)(C,{children:(0,d.t)("This Week")},"curr"),(0,M.tZ)(C,{children:(0,d.t)("Difference")},"diff")],children:o?.map((t=>{const s=r.find((e=>e.slug===t.projects[0]));return(0,M.BX)(n.Fragment,{children:[(0,M.tZ)(E,{children:(0,M.tZ)(w.Z,{to:`/organizations/${e.slug}/alerts/rules/details/${t.id}/`,children:t.name})}),(0,M.tZ)(N.R,{children:s&&(0,M.tZ)(N.W,{avatarSize:18,project:s})}),(0,M.tZ)(C,{children:v()(t.weeklyAvg,2)}),(0,M.tZ)(C,{children:t.totalThisWeek}),(0,M.tZ)(C,{children:this.renderTrend(t)})]},t.id)}))})]})}}const I=q,k=(0,s.Z)("div",{target:"e1hbez306"})("padding:",(0,_.D)(2)," ",(0,_.D)(2)," 0 ",(0,_.D)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),B=(0,s.Z)(T.Z,{target:"e1hbez305"})("grid-template-columns:1fr 0.5fr 0.2fr 0.2fr 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,_.D)(1)," ",(0,_.D)(2),";}",(e=>e.isEmpty&&(0,Z.iv)("&>div:last-child{padding:48px ",(0,_.D)(2),";}","")),";"),E=(0,s.Z)("div",{target:"e1hbez304"})((e=>e.theme.overflowEllipsis),";"),C=(0,s.Z)("div",{target:"e1hbez303"})({name:"mnwtso",styles:"text-align:right;font-variant-numeric:tabular-nums"}),P=(0,s.Z)(D.CC,{target:"e1hbez302"})("margin:0 ",(0,_.D)(.5),";"),A=(0,s.Z)("div",{target:"e1hbez301"})("color:",(e=>e.theme[e.color]),";"),L=(0,s.Z)("div",{target:"e1hbez300"})("&>a{margin-right:",(0,_.D)(.5),";margin-left:",(0,_.D)(.5),";}");var F=r("./app/components/collapsePanel.tsx"),X=r("./app/components/loadingError.tsx"),O=r("./app/utils/discover/discoverQuery.tsx"),W=r("./app/utils/discover/eventView.tsx"),Q=r("./app/utils/discover/fieldRenderers.tsx"),U=r("./app/views/performance/transactionSummary/utils.tsx");function G(e){let{organization:t,location:r,projects:s,periodTableData:o,weekTableData:i,isLoading:a,period:l,error:c}=e;const u=o?.meta&&(0,Q.Js)("user_misery()",o.meta,!1),p=(o?.data??[]).map((e=>{const t=i?.data.find((t=>t.project===e.project&&t.transaction===e.transaction)),r=t?100*(e["user_misery()"]-t["user_misery()"]):null;return{...e,trend:r}})).filter((e=>null!==e.trend)).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),g=(0,R.NW)(p);return c?(0,M.tZ)(X.Z,{}):(0,M.tZ)(F.Z,{items:g.length,children:e=>{let{isExpanded:c,showMoreButton:p}=e;return(0,M.BX)(n.Fragment,{children:[(0,M.tZ)(V,{isEmpty:0===s.length||0===o?.data?.length,emptyMessage:(0,d.t)("No key transactions starred by this team"),emptyAction:(0,M.tZ)(b.zx,{size:"sm",external:!0,href:"https://docs.sentry.io/product/performance/transaction-summary/#starring-key-transactions",children:(0,d.t)("Learn More")}),headers:[(0,M.BX)(Y,{children:[(0,M.tZ)(ee,{isSolid:!0,color:"yellow400"})," ",(0,d.t)("Key transaction")]},"transaction"),(0,d.t)("Project"),(0,d._N)("Last [period]",{period:l}),(0,d.t)("Last 7 Days"),(0,M.tZ)(re,{children:(0,d.t)("Change")},"change")],isLoading:a,children:g.map(((e,o)=>{const a=s.find((t=>{let{slug:r}=t;return e.project===r})),{trend:l,project:p,transaction:g}=e,h=i?.data.find((e=>e.project===p&&e.transaction===g));if(!h||null===l)return null;const m=u?.(e,{organization:t,location:r}),f=h&&u?.(h,{organization:t,location:r}),y=Math.round(Math.abs(l));return o>=F.$&&!c?null:(0,M.BX)(n.Fragment,{children:[(0,M.BX)(J,{children:[(0,M.tZ)("div",{children:(0,M.tZ)(ee,{isSolid:!0,color:"yellow400"})}),(0,M.tZ)(te,{children:(0,M.tZ)(w.Z,{to:(0,U.e1)({orgSlug:t.slug,transaction:e.transaction,projectID:a?.id,query:{query:"transaction.duration:<15m"}}),children:e.transaction})})]}),(0,M.tZ)(Y,{children:(0,M.tZ)(N.R,{children:a&&(0,M.tZ)(N.W,{avatarSize:18,project:a})})}),(0,M.tZ)(Y,{children:m}),(0,M.tZ)(Y,{children:f??"—"}),(0,M.tZ)(se,{children:0===y?(0,M.BX)(ne,{children:["0% ",(0,d.t)("change")]}):(0,M.BX)(oe,{color:l>=0?"successText":"errorText",children:[`${y}% `,l>=0?(0,d.t)("better"):(0,d.t)("worse")]})})]},o)}))}),!a&&p]})}})}function K(e){let{organization:t,teamId:r,projects:s,location:n,period:o,start:i,end:a}=e;if(0===s.length)return(0,M.tZ)(G,{isLoading:!1,organization:t,location:n,projects:[],period:o,periodTableData:{data:[]},weekTableData:{data:[]}});const l={id:void 0,query:"transaction.duration:<15m team_key_transaction:true",projects:[],version:2,orderby:"-tpm",teams:[Number(r)],fields:["transaction","project","tpm()","count_unique(user)","count_miserable(user)","user_misery()"]},d=W.ZP.fromSavedQuery({...l,name:"periodMisery",range:o??void 0,start:i,end:a}),c=W.ZP.fromSavedQuery({...l,name:"weekMisery",range:"7d"});return(0,M.tZ)(O.Z,{eventView:d,orgSlug:t.slug,location:n,children:e=>{let{isLoading:r,tableData:i,error:a}=e;return(0,M.tZ)(O.Z,{eventView:c,orgSlug:t.slug,location:n,children:e=>{let{isLoading:l,tableData:d,error:c}=e;return(0,M.tZ)(G,{isLoading:r||l,organization:t,location:n,projects:s,period:o,periodTableData:i,weekTableData:d,error:a??c})}})}})}G.displayName="TeamMisery",K.displayName="TeamMiseryWrapper";const H=K,V=(0,s.Z)(T.Z,{target:"e1w8o4d28"})("grid-template-columns:1.25fr 0.5fr 112px 112px 0.25fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,_.D)(1)," ",(0,_.D)(2),";}",(e=>e.isEmpty&&(0,Z.iv)("&>div:last-child{padding:48px ",(0,_.D)(2),";}","")),";"),Y=(0,s.Z)("div",{target:"e1w8o4d27"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),J=(0,s.Z)("div",{target:"e1w8o4d26"})((e=>e.theme.overflowEllipsis),";display:flex;align-items:center;"),ee=(0,s.Z)(D.GK,{target:"e1w8o4d25"})("display:block;margin-right:",(0,_.D)(1),";margin-bottom:",(0,_.D)(.5),";"),te=(0,s.Z)("div",{target:"e1w8o4d24"})((e=>e.theme.overflowEllipsis),";"),re=(0,s.Z)("span",{target:"e1w8o4d23"})({name:"2qga7i",styles:"text-align:right"}),se=(0,s.Z)("div",{target:"e1w8o4d22"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),ne=(0,s.Z)("div",{target:"e1w8o4d21"})("color:",(e=>e.theme.subText),";"),oe=(0,s.Z)("div",{target:"e1w8o4d20"})("color:",(e=>e.theme[e.color]),";");var ie=r("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),ae=r("../node_modules/lodash/isEqual.js"),le=r.n(ae),de=r("../node_modules/moment/moment.js"),ce=r.n(de),ue=r("./app/components/charts/components/markLine.tsx"),pe=r("./app/components/placeholder.tsx"),ge=r("./app/utils/toArray.tsx");class he extends S.Z{constructor(){super(...arguments),(0,y.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),weekReleases:null,periodReleases:null}}getEndpoints(){const{organization:e,start:t,end:r,period:s,utc:n,teamSlug:o}=this.props,i={start:t,end:r,period:s,utc:n};return[["periodReleases",`/teams/${e.slug}/${o}/release-count/`,{query:{...(0,z.fK)(i)}}],["weekReleases",`/teams/${e.slug}/${o}/release-count/`,{query:{statsPeriod:"7d"}}]]}componentDidUpdate(e){const{teamSlug:t,start:r,end:s,period:n,utc:o}=this.props;e.start===r&&e.end===s&&e.period===n&&e.utc===o&&le()(e.teamSlug,t)||this.remountComponent()}getReleaseCount(e,t){const{periodReleases:r,weekReleases:s}=this.state,n="week"===t?s?.last_week_totals:r?.project_avgs;return n?.[e]?Math.ceil(n?.[e]):0}getTrend(e){const t=this.getReleaseCount(e,"period"),r=this.getReleaseCount(e,"week");return null===t||null===r?null:r-t}renderLoading(){return this.renderBody()}renderReleaseCount(e,t){const{loading:r}=this.state;if(r)return(0,M.tZ)("div",{children:(0,M.tZ)(pe.Z,{width:"80px",height:"25px"})});const s=this.getReleaseCount(Number(e),t);return null===s?"—":s}renderTrend(e){const{loading:t}=this.state;if(t)return(0,M.tZ)("div",{children:(0,M.tZ)(pe.Z,{width:"80px",height:"25px"})});const r=this.getTrend(Number(e));return null===r?"—":(0,M.BX)(Se,{color:r>=0?"successText":"errorText",children:[`${v()(Math.abs(r),3)}`,(0,M.tZ)(ve,{direction:r>=0?"up":"down",size:"xs"})]})}renderBody(){const{projects:e,period:t,theme:r,organization:s}=this.props,{periodReleases:o}=this.state,i=e.map((e=>({project:e,trend:this.getTrend(Number(e.id))??0}))).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),a=(0,R.NW)(i),l=Object.entries(o?.release_counts??{}).map((e=>{let[t,r]=e;return{value:Math.ceil(r),name:new Date(t).getTime()}})),c=(0,R.Gs)(l),u=Object.values(o?.project_avgs??{}),p=u.reduce(((e,t)=>e+t),0),g=Math.ceil(p/u.length);return(0,M.BX)("div",{children:[(0,M.tZ)(fe,{children:(0,M.tZ)(j.v,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",legend:{right:3,top:0},yAxis:{minInterval:1},xAxis:(0,R.tP)(c.length),series:[{seriesName:(0,d.t)("This Period"),silent:!0,data:c,markLine:(0,ue.Z)({silent:!0,lineStyle:{color:r.gray200,type:"dashed",width:1},data:[{yAxis:g}],label:{show:!1}}),barCategoryGap:"5%"}],tooltip:{formatter:e=>{const[r]=(0,ge.Z)(e),s="MMM D",n=ce()(r.data[0]).format(s),o=ce()(r.data[0]).add(7,"days").format(s);return['<div class="tooltip-series">',`<div><span class="tooltip-label">${r.marker} <strong>${r.seriesName}</strong></span> ${r.data[1]}</div>`,`<div><span class="tooltip-label"><strong>Last ${t} Average</strong></span> ${g}</div>`,"</div>",`<div class="tooltip-footer">${n} - ${o}</div>`,'<div class="tooltip-arrow"></div>'].join("")}}})}),(0,M.tZ)(ye,{isEmpty:0===e.length,emptyMessage:(0,d.t)("No releases were setup for this team’s projects"),emptyAction:(0,M.tZ)(b.zx,{size:"sm",external:!0,href:"https://docs.sentry.io/product/releases/setup/",children:(0,d.t)("Learn More")}),headers:[(0,d.t)("Releases Per Project"),(0,M.tZ)(Ze,{children:(0,d._N)("Last [period] Average",{period:t})},"last"),(0,M.tZ)(Ze,{children:(0,d.t)("Last 7 Days")},"curr"),(0,M.tZ)(Ze,{children:(0,d.t)("Difference")},"diff")],children:a.map((e=>{let{project:t}=e;return(0,M.BX)(n.Fragment,{children:[(0,M.tZ)(N.R,{children:(0,M.tZ)(N.W,{avatarSize:18,project:t,to:{pathname:`/organizations/${s.slug}/releases/`,query:{project:t.id}}})}),(0,M.tZ)(xe,{children:this.renderReleaseCount(t.id,"period")}),(0,M.tZ)(xe,{children:(0,M.tZ)(w.Z,{to:{pathname:`/organizations/${s.slug}/releases/`,query:{project:t.id,statsPeriod:"7d"}},children:this.renderReleaseCount(t.id,"week")})}),(0,M.tZ)(xe,{children:this.renderTrend(t.id)})]},t.id)}))})]})}}const me=(0,ie.b)(he),fe=(0,s.Z)("div",{target:"e1t40s8f5"})("padding:",(0,_.D)(2)," ",(0,_.D)(2)," 0 ",(0,_.D)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),ye=(0,s.Z)(T.Z,{target:"e1t40s8f4"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;white-space:nowrap;margin-bottom:0;border:0;font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:unset;&>div{padding:",(0,_.D)(1)," ",(0,_.D)(2),";}",(e=>e.isEmpty&&(0,Z.iv)("&>div:last-child{padding:48px ",(0,_.D)(2),";}","")),";"),Ze=(0,s.Z)("span",{target:"e1t40s8f3"})({name:"2qga7i",styles:"text-align:right"}),xe=(0,s.Z)("div",{target:"e1t40s8f2"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),ve=(0,s.Z)(D.CC,{target:"e1t40s8f1"})("margin:0 ",(0,_.D)(.5),";"),Se=(0,s.Z)("div",{target:"e1t40s8f0"})("color:",(e=>e.theme[e.color]),";");var be=r("./app/components/charts/miniBarChart.tsx"),je=r("./app/components/charts/sessionsRequest.tsx"),we=r("./app/types/index.tsx"),ze=r("./app/utils/sessions.tsx"),Te=r("./app/views/releases/utils/index.tsx");class De extends S.Z{constructor(){super(...arguments),(0,y.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),weekSessions:null,periodSessions:null}}getEndpoints(){const{organization:e,start:t,end:r,period:s,utc:n,projects:o}=this.props,i=o.filter((e=>e.hasSessions));if(0===i.length)return[];const a={start:t,end:r,period:s,utc:n},l={environment:[],project:i.map((e=>e.id)),field:"sum(session)",groupBy:["session.status","project"],interval:"1d"};return[["periodSessions",`/organizations/${e.slug}/sessions/`,{query:{...l,...(0,z.fK)(a)}}],["weekSessions",`/organizations/${e.slug}/sessions/`,{query:{...l,statsPeriod:"7d"}}]]}componentDidUpdate(e){const{projects:t,start:r,end:s,period:n,utc:o}=this.props;e.start===r&&e.end===s&&e.period===n&&e.utc===o&&le()(e.projects,t)||this.remountComponent()}getScore(e,t){const{periodSessions:r,weekSessions:s}=this.state,n=("week"===t?s:r)?.groups.filter((t=>t.by.project===e));return(0,ze.Pn)(n,we.kI.SESSIONS)}getTrend(e){const t=this.getScore(e,"period"),r=this.getScore(e,"week");return null===t||null===r?null:r-t}getMiniBarChartSeries(e,t){const r=(0,ze.wt)(t.groups.filter((t=>t.by.project===Number(e.id))),we.kI.SESSIONS,t.intervals),s=(0,ze.iy)(we.kI.SESSIONS,t.groups.find((t=>t.by.project===Number(e.id)&&t.by["session.status"]===we.$y.HEALTHY)),t.intervals),n=Array(r.length/7).fill(0);s.forEach(((e,t)=>n[Math.floor(t/7)]+=e.value));const o=Array(r.length/7).fill(0);r.forEach(((e,t)=>o[Math.floor(t/7)]+=e));const i=n.map(((e,t)=>({name:s[7*t].name,value:o[t]?(0,$.$1)(e/o[t]*100,2):0})));return[{seriesName:(0,d.t)("Crash Free Sessions"),data:i}]}renderLoading(){return this.renderBody()}renderScore(e,t){const{loading:r}=this.state;if(r)return(0,M.tZ)("div",{children:(0,M.tZ)(pe.Z,{width:"80px",height:"25px"})});const s=this.getScore(Number(e),t);return null===s?"—":(0,Te.zB)(s)}renderTrend(e){const{loading:t}=this.state;if(t)return(0,M.tZ)("div",{children:(0,M.tZ)(pe.Z,{width:"80px",height:"25px"})});const r=this.getTrend(Number(e));return null===r?"—":(0,M.BX)(qe,{color:r>=0?"successText":"errorText",children:[`${v()(Math.abs(r),3)}%`,(0,M.tZ)(Me,{direction:r>=0?"up":"down",size:"xs"})]})}renderBody(){const{organization:e,projects:t,period:r}=this.props,s=t.map((e=>({project:e,trend:this.getTrend(Number(e.id))??0}))).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),o=(0,R.NW)(s);return(0,M.tZ)(je.Z,{api:this.api,project:t.map((e=>{let{id:t}=e;return Number(t)})),organization:e,interval:"1d",groupBy:["session.status","project"],field:[we.kI.SESSIONS],statsPeriod:r,children:e=>{let{response:s,loading:i}=e;return(0,M.tZ)($e,{isEmpty:0===t.length,emptyMessage:(0,d.t)("No projects with release health enabled"),emptyAction:(0,M.tZ)(b.zx,{size:"sm",external:!0,href:"https://docs.sentry.io/platforms/dotnet/guides/nlog/configuration/releases/#release-health",children:(0,d.t)("Learn More")}),headers:[(0,d.t)("Project"),(0,M.tZ)(Ne,{children:(0,d._N)("Last [period]",{period:r})},"last"),(0,M.tZ)(Ne,{children:(0,d._N)("[period] Avg",{period:r})},"avg"),(0,M.tZ)(Ne,{children:(0,d.t)("Last 7 Days")},"curr"),(0,M.tZ)(Ne,{children:(0,d.t)("Difference")},"diff")],children:o.map((e=>{let{project:t}=e;return(0,M.BX)(n.Fragment,{children:[(0,M.tZ)(N.R,{children:(0,M.tZ)(N.W,{avatarSize:18,project:t})}),(0,M.tZ)("div",{children:s&&!i&&(0,M.tZ)(be.Z,{isGroupedByDate:!0,showTimeInTooltip:!0,series:this.getMiniBarChartSeries(t,s),height:25,tooltipFormatter:e=>`${e.toLocaleString()}%`})}),(0,M.tZ)(Re,{children:this.renderScore(t.id,"period")}),(0,M.tZ)(Re,{children:this.renderScore(t.id,"week")}),(0,M.tZ)(Re,{children:this.renderTrend(t.id)})]},t.id)}))})}})}}const _e=De,$e=(0,s.Z)(T.Z,{target:"e5ryftz4"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;overflow:visible;&>div{padding:",(0,_.D)(1)," ",(0,_.D)(2),";}",(e=>e.isEmpty&&(0,Z.iv)("&>div:last-child{padding:48px ",(0,_.D)(2),";}","")),";"),Ne=(0,s.Z)("span",{target:"e5ryftz3"})({name:"2qga7i",styles:"text-align:right"}),Re=(0,s.Z)("div",{target:"e5ryftz2"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),Me=(0,s.Z)(D.CC,{target:"e5ryftz1"})("margin:0 ",(0,_.D)(.5),";"),qe=(0,s.Z)("div",{target:"e5ryftz0"})("color:",(e=>e.theme[e.color]),";");function Ie(e){let{location:t,router:r}=e;const s=(0,p.Z)(),{teams:y,initiallyLoaded:Z}=(0,g.Z)({provideUserTeams:!0});(0,u.Z)("team_insights.viewed","Team Insights: Viewed");const x=t?.query??{},v=`teamInsightsSelectedTeamId:${s.slug}`;let S=x.team??c.Z.getItem(v);S&&!y.find((e=>e.id===S))&&(S=null);const b=S??y[0]?.id,j=y.find((e=>e.id===b)),w=j?.projects??[],{period:z,start:T,end:D,utc:_}=(0,R.lI)(x);return 0===y.length?(0,M.tZ)(a.Z,{organization:s,superuserNeedsToBeProjectMember:!0}):(0,M.BX)(n.Fragment,{children:[(0,M.tZ)(l.Z,{title:(0,d.t)("Project Health"),orgSlug:s.slug}),(0,M.tZ)(h.Z,{organization:s,activeTab:"health"}),(0,M.BX)(Be,{children:[(0,M.tZ)(m.Z,{location:t,router:r,currentTeam:j}),!Z&&(0,M.tZ)(i.Z,{}),Z&&(0,M.BX)(o.or,{fullWidth:!0,children:[(0,M.tZ)(f.Z,{title:(0,d.t)("Crash Free Sessions"),description:(0,d.t)("The percentage of healthy, errored, and abnormal sessions that didn’t cause a crash."),children:(0,M.tZ)(_e,{projects:w,organization:s,period:z,start:T,end:D,utc:_})}),(0,M.tZ)(f.Z,{title:(0,d.t)("User Misery"),description:(0,d.t)("The number of unique users that experienced load times 4x the project’s configured threshold."),children:(0,M.tZ)(H,{organization:s,projects:w,teamId:j.id,period:z,start:T?.toString(),end:D?.toString(),location:t})}),(0,M.tZ)(f.Z,{title:(0,d.t)("Metric Alerts Triggered"),description:(0,d.t)("Alerts triggered from the Alert Rules your team created."),children:(0,M.tZ)(I,{organization:s,projects:w,teamSlug:j.slug,period:z,start:T?.toString(),end:D?.toString(),location:t})}),(0,M.tZ)(f.Z,{title:(0,d.t)("Number of Releases"),description:(0,d.t)("The releases that were created in your team’s projects."),children:(0,M.tZ)(me,{projects:w,organization:s,teamSlug:j.slug,period:z,start:T,end:D,utc:_})})]})]})]})}Ie.displayName="TeamStatsHealth";const ke=Ie,Be=(0,s.Z)(o.uT,{target:"e1ylx2vy0"})("@media (min-width: ",(e=>e.theme.breakpoints.medium),"){display:block;}")},"./app/views/performance/transactionSummary/utils.tsx":(e,t,r)=>{"use strict";r.d(t,{DC:()=>u,K0:()=>p,MF:()=>x,PU:()=>h,Z6:()=>f,e1:()=>m,nx:()=>Z,uI:()=>v,vd:()=>y,xf:()=>g});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=r("./app/styles/space.tsx"),o=r("./app/utils/discover/urls.tsx"),i=r("./app/utils/getRouteStringFromRoutes.tsx"),a=r("./app/utils/performance/urls.ts"),l=r("./app/utils/profiling/routes.tsx"),d=r("./app/utils/tokenizeSearch.tsx"),c=r("./app/views/performance/traceDetails/utils.tsx");let u,p;function g(e){const t=h(e);return t.removeFilter("transaction"),t}function h(e){const t=new d.MY(e);return t.removeFilter("event.type"),t}function m(e){let{orgSlug:t,transaction:r,projectID:s,query:n,unselectedSeries:o="p100()",display:i,trendFunction:a,trendColumn:l,showTransactions:d,additionalQuery:c,subPath:u}=e;const p=function(e){let{orgSlug:t,subPath:r}=e;return`/organizations/${t}/performance/summary/${r?`${r}/`:""}`}({orgSlug:t,subPath:u});let h;return h="string"==typeof n.query?g(n.query).formatString():n.query,{pathname:p,query:{transaction:r,project:s,environment:n.environment,statsPeriod:n.statsPeriod,start:n.start,end:n.end,query:h,unselectedSeries:o,showTransactions:d,display:i,trendFunction:a,trendColumn:l,referrer:"performance-transaction-summary",...c}}}function f(e){return(t,r,s)=>{const n=`${r.trace}`;return n?(0,c.YA)(t,n,e,{}):{}}}function y(e){return(t,r,s,n)=>{const i=(0,o.JE)(r);return(0,a.D)(t.slug,i,e,s,n)}}function Z(){return(e,t,r)=>{const s=t["profile.id"];return s?(0,l.O$)({orgSlug:e.slug,projectSlug:String(t["project.name"]),profileId:String(s)}):{}}}function x(e){const t=(0,i.Z)(e);return(e,r,s)=>{const n=r.replayId;if(!n)return{};const o=`${r["project.name"]}:${n}`;if(!r.timestamp)return{pathname:`/organizations/${e.slug}/replays/${o}/`,query:{referrer:t}};const i=new Date(r.timestamp).getTime()-r["transaction.duration"];return{pathname:`/organizations/${e.slug}/replays/${o}/`,query:{event_t:i,referrer:t}}}}!function(e){e.DURATION_PERCENTILE="durationpercentile",e.DURATION="duration",e.LATENCY="latency",e.TREND="trend",e.VITALS="vitals",e.USER_MISERY="usermisery"}(u||(u={})),function(e){e.FASTEST="fastest",e.SLOW="slow",e.OUTLIER="outlier",e.RECENT="recent"}(p||(p={}));const v=(0,s.Z)("div",{target:"etoucxl0"})("margin-top:",(0,n.D)(3),";")},"../node_modules/lodash/_baseMean.js":(e,t,r)=>{var s=r("../node_modules/lodash/_baseSum.js");e.exports=function(e,t){var r=null==e?0:e.length;return r?s(e,t)/r:NaN}},"../node_modules/lodash/_baseSum.js":e=>{e.exports=function(e,t){for(var r,s=-1,n=e.length;++s<n;){var o=t(e[s]);void 0!==o&&(r=void 0===r?o:r+o)}return r}},"../node_modules/lodash/mean.js":(e,t,r)=>{var s=r("../node_modules/lodash/_baseMean.js"),n=r("../node_modules/lodash/identity.js");e.exports=function(e){return s(e,n)}},"../node_modules/lodash/negate.js":e=>{e.exports=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},"../node_modules/lodash/omitBy.js":(e,t,r)=>{var s=r("../node_modules/lodash/_baseIteratee.js"),n=r("../node_modules/lodash/negate.js"),o=r("../node_modules/lodash/pickBy.js");e.exports=function(e,t){return o(e,n(s(t)))}}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationStats_teamInsights_health_tsx-node_modules_lodash_mean_js.c26d735d6e8c9d0ca0a64cedb8764fbf.js.map