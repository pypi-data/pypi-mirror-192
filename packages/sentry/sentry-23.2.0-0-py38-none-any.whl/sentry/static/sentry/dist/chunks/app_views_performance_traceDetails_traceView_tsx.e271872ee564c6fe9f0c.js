"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_traceDetails_traceView_tsx"],{"./app/utils/discover/discoverQuery.tsx":(e,t,n)=>{n.d(t,{Z:()=>l,_:()=>o});var r=n("./app/utils/discover/genericDiscoverQuery.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function s(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function i(e){return(0,a.tZ)(r.ZP,{route:"events",shouldRefetchData:s,afterFetch:(e,t)=>{const{fields:n,...r}=e.meta??{};return{...e,meta:{...n,...r}}},...e})}function o(e){return(0,r.JC)({route:"events",shouldRefetchData:s,afterFetch:(e,t)=>{const{fields:n,...r}=e.meta??{};return{...e,meta:{...n,...r}}},...e})}i.displayName="DiscoverQuery";const l=i},"./app/views/performance/traceDetails/styles.tsx":(e,t,n)=>{n.d(t,{$G:()=>T,CB:()=>m.wh,Iq:()=>f,LA:()=>b,RB:()=>y,W3:()=>Z,X2:()=>m.X2,Z9:()=>x,cC:()=>v,pH:()=>g,qD:()=>m.iF,uI:()=>w});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=n("./app/components/events/eventTags/eventTagsPill.tsx"),s=n("./app/components/events/interfaces/spans/header.tsx"),i=n("./app/components/panels/index.tsx"),o=n("./app/components/pills.tsx"),l=n("./app/components/searchBar.tsx"),c=n("./app/styles/space.tsx"),d=n("./app/utils.tsx"),p=n("./app/utils/queryString.tsx"),h=n("./app/views/performance/transactionSummary/utils.tsx"),u=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),m=n("./app/components/events/interfaces/spans/spanDetail.tsx");const g=(0,r.Z)("div",{target:"evb4dv48"})({name:"7whenc",styles:"display:flex;width:100%"}),f=(0,r.Z)(l.Z,{target:"evb4dv47"})({name:"1ff36h2",styles:"flex-grow:1"}),v=(0,r.Z)(s.il,{target:"evb4dv46"})("border-top:none;border-bottom:1px solid ",(e=>e.theme.border),";position:sticky;top:0;z-index:1;"),x=(0,r.Z)("div",{target:"evb4dv45"})("display:grid;grid-template-columns:1fr;gap:",(0,c.D)(3),";margin-bottom:",(0,c.D)(2),";@media (min-width: ",(e=>e.theme.breakpoints.medium),"){grid-template-columns:max-content max-content;grid-row-gap:0;}"),Z=(0,r.Z)("div",{target:"evb4dv44"})({name:"13udsys",styles:"height:100%"}),w=(0,r.Z)("div",{target:"evb4dv43"})({name:"1wr20zt",styles:"overflow-x:hidden;border-bottom-left-radius:3px;border-bottom-right-radius:3px"}),b=(0,r.Z)(i.s_,{target:"evb4dv42"})({name:"1vsyufa",styles:"height:100%;overflow:auto"}),y=(0,r.Z)("span",{target:"evb4dv41"})("margin-right:",(0,c.D)(.75),";display:flex;flex-direction:column;justify-content:center;"),D=(0,r.Z)(o.Z,{target:"evb4dv40"})("padding-top:",(0,c.D)(1.5),";");function T(e){let{location:t,organization:n,transaction:r}=e;const{tags:s}=r;if(!s||s.length<=0)return null;const i=n.slug;return(0,u.BX)("tr",{children:[(0,u.tZ)("td",{className:"key",children:"Tags"}),(0,u.tZ)("td",{className:"value",children:(0,u.tZ)(D,{children:s.map(((e,s)=>{const{pathname:o,query:l}=(0,h.e1)({orgSlug:i,transaction:r.transaction,projectID:String(r.project_id),query:{...t.query,query:(0,p.os)(t.query.query,e.key,e.value)}});return(0,u.tZ)(a.Z,{tag:e,projectSlug:r.project_slug,organization:n,query:l,streamPath:o},(0,d.ri)(e.key)?e.key:`tag-pill-${s}`)}))})})]})}T.displayName="Tags"},"./app/views/performance/traceDetails/traceNotFound.tsx":(e,t,n)=>{n.d(t,{Z:()=>f});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=n("../node_modules/react/index.js"),s=n("./app/components/alert.tsx"),i=n("./app/components/links/link.tsx"),o=n("./app/components/loadingError.tsx"),l=n("./app/components/loadingIndicator.tsx"),c=n("./app/components/performance/waterfall/rowDetails.tsx"),d=n("./app/locale.tsx"),p=n("./app/styles/space.tsx"),h=n("./app/utils/discover/discoverQuery.tsx"),u=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){let{meta:t,traceEventView:n,traceSlug:r,organization:p,location:m}=e;if(0===(t?.transactions??0)&&(t?.errors??0)>0){const e=n.withColumns([{kind:"field",field:"project"},{kind:"field",field:"title"},{kind:"field",field:"issue.id"},{kind:"field",field:"level"}]);return e.query=`trace:${r} !event.type:transaction `,(0,u.tZ)(h.Z,{eventView:e,orgSlug:p.slug,location:m,referrer:"api.trace-view.errors-view",children:e=>{let{isLoading:t,tableData:n,error:r}=e;return t?(0,u.tZ)(l.Z,{}):r?(0,u.tZ)(s.bZ,{type:"error",showIcon:!0,children:(0,u.tZ)(g,{children:(0,d._N)("The trace cannot be shown when all events are errors. An error occurred when attempting to fetch these error events: [error]",{error:r.message})})}):(0,u.BX)(s.bZ,{type:"error",showIcon:!0,children:[(0,u.tZ)(g,{children:(0,d.t)("The trace cannot be shown when all events are errors.")}),(0,u.tZ)(c.TV,{"data-test-id":"trace-view-errors",children:n?.data.map((e=>(0,u.BX)(a.Fragment,{children:[(0,u.tZ)(c._U,{level:e.level}),(0,u.tZ)(c.wE,{children:e.level}),(0,u.tZ)(c.St,{children:(0,u.tZ)(i.Z,{to:`/organizations/${p.slug}/issues/${e["issue.id"]}/events/${e.id}?referrer=performance-trace-not-found`,children:e.title})})]},e.id)))})]})}})}return(0,u.tZ)(o.Z,{message:(0,d.t)("The trace you are looking for was not found.")})}m.displayName="TraceNotFound";const g=(0,r.Z)("div",{target:"effixob0"})("margin-bottom:",(0,p.D)(1),";"),f=m},"./app/views/performance/traceDetails/traceView.tsx":(e,t,n)=>{n.d(t,{Z:()=>pe}),n("../node_modules/core-js/modules/es.array.push.js");var r=n("../node_modules/react/index.js"),a=n("../node_modules/@sentry/core/esm/hub.js"),s=n("./app/components/events/interfaces/spans/dividerHandlerManager.tsx"),i=n("./app/components/events/interfaces/spans/scrollbarManager.tsx"),o=n("./app/components/performance/waterfall/messageRow.tsx"),l=n("./app/components/performance/waterfall/miniHeader.tsx"),c=n("./app/components/performance/waterfall/utils.tsx"),d=n("./app/locale.tsx"),p=n("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),h=n("./app/views/performance/traceDetails/styles.tsx"),u=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),m=n("./app/components/assistant/guideAnchor.tsx"),g=n("./app/components/count.tsx"),f=n("./app/components/events/interfaces/spans/utils.tsx"),v=n("./app/components/idBadge/projectBadge.tsx"),x=n("./app/components/performance/waterfall/constants.tsx"),Z=n("./app/components/performance/waterfall/row.tsx"),w=n("./app/components/performance/waterfall/rowBar.tsx"),b=n("./app/components/performance/waterfall/rowDivider.tsx"),y=n("./app/components/performance/waterfall/rowTitle.tsx"),D=n("./app/components/performance/waterfall/treeConnector.tsx"),T=n("./app/components/tooltip.tsx"),_=n("./app/utils/performance/quickTrace/utils.tsx"),C=n("./app/utils/projects.tsx"),B=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),S=n("../node_modules/react-router/es/index.js"),j=n("../node_modules/lodash/omit.js"),I=n.n(j),O=n("./app/components/alert.tsx"),R=n("./app/components/button.tsx"),X=n("./app/components/clipboard.tsx"),k=n("./app/components/dateTime.tsx"),E=n("./app/components/links/link.tsx"),V=n("./app/components/performance/waterfall/rowDetails.tsx"),z=n("./app/components/quickTrace/utils.tsx"),M=n("./app/constants/pageFilters.tsx"),$=n("./app/icons/index.tsx"),A=n("./app/styles/space.tsx"),H=n("./app/utils/discover/urls.tsx"),N=n("./app/utils/getDynamicText.tsx"),G=n("./app/utils/performance/urls.ts"),L=n("./app/utils/performance/vitals/constants.tsx"),P=n("./app/utils/performanceForSentry.tsx"),F=n("./app/utils/profiling/routes.tsx"),q=n("./app/views/performance/transactionSummary/utils.tsx"),U=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class W extends r.Component{constructor(){super(...arguments),(0,u.Z)(this,"scrollBarIntoView",(e=>t=>{t.preventDefault();const n=`#txn-${e}`;this.props.scrollIntoView(),S.browserHistory.push({...this.props.location,hash:n})}))}componentDidMount(){const{organization:e,transaction:t}=this.props;(0,p.Z)("performance_views.trace_view.open_transaction_details",{organization:e,operation:t["transaction.op"],transaction:t.transaction})}renderTransactionErrors(){const{organization:e,transaction:t}=this.props,{errors:n}=t;return 0===n.length?null:(0,U.tZ)(O.bZ,{system:!0,type:"error",expand:n.map((t=>(0,U.BX)(V.TV,{children:[(0,U.tZ)(V._U,{level:t.level}),(0,U.tZ)(V.wE,{children:t.level}),(0,U.tZ)(V.St,{children:(0,U.tZ)(E.Z,{to:(0,z.F7)(t,e),children:t.title})})]},t.event_id))),children:(0,U.tZ)(V.CM,{children:(0,d.tn)("%s error event occurred in this transaction.","%s error events occurred in this transaction.",n.length)})})}renderGoToTransactionButton(){const{location:e,organization:t,transaction:n}=this.props,r=(0,H.JE)({id:n.event_id,project:n.project_slug}),a=(0,G.D)(t.slug,r,n.transaction,I()(e.query,Object.values(M.V)));return(0,U.tZ)(Y,{size:"xs",to:a,children:(0,d.t)("View Event")})}renderGoToSummaryButton(){const{location:e,organization:t,transaction:n}=this.props,r=(0,q.e1)({orgSlug:t.slug,transaction:n.transaction,query:I()(e.query,Object.values(M.V)),projectID:String(n.project_id)});return(0,U.tZ)(Y,{size:"xs",to:r,children:(0,d.t)("View Summary")})}renderGoToProfileButton(){const{organization:e,transaction:t}=this.props;if(!t.profile_id)return null;const n=(0,F.O$)({orgSlug:e.slug,projectSlug:t.project_slug,profileId:t.profile_id});return(0,U.tZ)(Y,{size:"xs",to:n,onClick:function(){(0,p.Z)("profiling_views.go_to_flamegraph",{organization:e,source:"performance.trace_view"})},children:(0,d.t)("Go to Profile")})}renderMeasurements(){const{transaction:e}=this.props,{measurements:t={}}=e,n=Object.keys(t).filter((e=>Boolean(L.r9[`measurements.${e}`]))).sort();return n.length<=0?null:(0,U.tZ)(r.Fragment,{children:n.map((e=>(0,U.tZ)(h.X2,{title:L.r9[`measurements.${e}`]?.name,children:`${Number(t[e].value.toFixed(3)).toLocaleString()}ms`},e)))})}renderTransactionDetail(){const{location:e,organization:t,transaction:n}=this.props,a=Math.min(n.start_timestamp,n.timestamp),s=Math.max(n.start_timestamp,n.timestamp),{start:i,end:o}=(0,f.Zv)(a,s),l=`${Number((1e3*(s-a)).toFixed(3)).toLocaleString()}ms`;return(0,U.tZ)(h.qD,{children:(0,U.tZ)("table",{className:"table key-value",children:(0,U.BX)("tbody",{children:[(0,U.tZ)(h.X2,{title:(0,U.BX)(Q,{onClick:this.scrollBarIntoView(n.event_id),children:[(0,d.t)("Event ID"),(0,U.tZ)(X.Z,{value:`${window.location.href.replace(window.location.hash,"")}#txn-${n.event_id}`,children:(0,U.tZ)(J,{})})]}),extra:this.renderGoToTransactionButton(),children:n.event_id}),(0,U.tZ)(h.X2,{title:"Transaction",extra:this.renderGoToSummaryButton(),children:n.transaction}),(0,U.tZ)(h.X2,{title:"Transaction Status",children:n["transaction.status"]}),(0,U.tZ)(h.X2,{title:"Span ID",children:n.span_id}),n.profile_id&&(0,U.tZ)(h.X2,{title:"Profile ID",extra:this.renderGoToProfileButton(),children:n.profile_id}),(0,U.tZ)(h.X2,{title:"Project",children:n.project_slug}),(0,U.tZ)(h.X2,{title:"Start Date",children:(0,N.Z)({fixed:"Mar 19, 2021 11:06:27 AM UTC",value:(0,U.BX)(r.Fragment,{children:[(0,U.tZ)(k.Z,{date:1e3*a}),` (${i})`]})})}),(0,U.tZ)(h.X2,{title:"End Date",children:(0,N.Z)({fixed:"Mar 19, 2021 11:06:28 AM UTC",value:(0,U.BX)(r.Fragment,{children:[(0,U.tZ)(k.Z,{date:1e3*s}),` (${o})`]})})}),(0,U.tZ)(h.X2,{title:"Duration",children:l}),(0,U.tZ)(h.X2,{title:"Operation",children:n["transaction.op"]||""}),this.renderMeasurements(),(0,U.tZ)(h.$G,{location:e,organization:t,transaction:n})]})})})}render(){return(0,U.tZ)(P.BZ,{id:"TransactionDetail",children:(0,U.BX)(h.CB,{onClick:e=>{e.stopPropagation()},children:[this.renderTransactionErrors(),this.renderTransactionDetail()]})})}}W.displayName="TransactionDetail";const Q=(0,B.Z)("a",{target:"ehk3o3f2"})("display:flex;color:",(e=>e.theme.textColor),";:hover{color:",(e=>e.theme.textColor),";}"),J=(0,B.Z)($.JH,{target:"ehk3o3f1"})("display:block;color:",(e=>e.theme.gray300),";margin-left:",(0,A.D)(1),";"),Y=(0,B.Z)(R.zx,{target:"ehk3o3f0"})("position:absolute;top:",(0,A.D)(.75),";right:",(0,A.D)(.5),";"),K=W;class ee extends r.Component{constructor(){super(...arguments),(0,u.Z)(this,"state",{showDetail:!1}),(0,u.Z)(this,"transactionRowDOMRef",(0,r.createRef)()),(0,u.Z)(this,"transactionTitleRef",(0,r.createRef)()),(0,u.Z)(this,"spanContentRef",null),(0,u.Z)(this,"toggleDisplayDetail",(()=>{const{transaction:e}=this.props;(0,_.Ci)(e)&&this.setState((e=>({showDetail:!e.showDetail})))})),(0,u.Z)(this,"handleWheel",(e=>{if(Math.abs(e.deltaY)>Math.abs(e.deltaX))return;if(e.preventDefault(),e.stopPropagation(),Math.abs(e.deltaY)===Math.abs(e.deltaX))return;const{onWheel:t}=this.props;t(e.deltaX)})),(0,u.Z)(this,"scrollIntoView",(()=>{const e=this.transactionRowDOMRef.current;if(!e)return;const t=e.getBoundingClientRect().top+window.scrollY;this.setState({showDetail:!0},(()=>window.scrollTo(0,t)))}))}componentDidMount(){const{location:e,transaction:t}=this.props;"event_id"in t&&(0,f.KQ)(t.event_id)===e.hash&&this.scrollIntoView(),this.transactionTitleRef.current&&this.transactionTitleRef.current.addEventListener("wheel",this.handleWheel,{passive:!1})}componentWillUnmount(){this.transactionTitleRef.current&&this.transactionTitleRef.current.removeEventListener("wheel",this.handleWheel)}getCurrentOffset(){const{transaction:e}=this.props,{generation:t}=e;return te(t)}renderConnector(e){const{continuingDepths:t,isExpanded:n,isOrphan:r,isLast:a,transaction:s}=this.props,{generation:i}=s,o=(0,_.Ci)(s)?s.event_id:s.traceSlug;if(0===i)return e?(0,U.tZ)(D.UV,{style:{right:"15px",height:"10px",bottom:"-5px",top:"auto"},orphanBranch:!1}):null;const l=t.map((e=>{let{depth:t,isOrphanDepth:n}=e;if(i-t<=1)return null;const r=-1*te(i-t-1)-2;return(0,U.tZ)(D.UV,{style:{left:r},orphanBranch:n},`${o}-${t}`)}));return e&&n&&l.push((0,U.tZ)(D.UV,{style:{right:"15px",height:"10px",bottom:a?`-${x.dN/2+1}px`:"0",top:"auto"},orphanBranch:!1},`${o}-last`)),(0,U.tZ)(D.DN,{isLast:a,hasToggler:e,orphanBranch:r,children:l})}renderToggle(e){const{isExpanded:t,transaction:n,toggleExpandedState:r}=this.props,{children:a,generation:s}=n,i=this.getCurrentOffset();if(a.length<=0)return(0,U.tZ)(D.rw,{style:{left:`${i}px`},children:this.renderConnector(!1)});const o=0===s;return(0,U.BX)(D.rw,{style:{left:`${i}px`},hasToggler:!0,children:[this.renderConnector(!0),(0,U.BX)(D.U1,{disabled:o,isExpanded:t,errored:e,onClick:e=>{e.stopPropagation(),o||r()},children:[(0,U.tZ)(g.Z,{value:a.length}),!o&&(0,U.tZ)("div",{children:(0,U.tZ)(D.jd,{direction:t?"up":"down"})})]})]})}renderTitle(e){const{organization:t,transaction:n,addContentSpanBarRef:a,removeContentSpanBarRef:s}=this.props,i=this.getCurrentOffset(),o=!!(0,_.Ci)(n)&&n.errors.length>0,l=(0,_.Ci)(n)?(0,U.BX)(r.Fragment,{children:[(0,U.tZ)(C.Z,{orgId:t.slug,slugs:[n.project_slug],children:e=>{let{projects:t}=e;const r=t.find((e=>e.slug===n.project_slug));return(0,U.tZ)(h.RB,{children:(0,U.tZ)(T.u,{title:n.project_slug,children:(0,U.tZ)(v.Z,{project:r||{slug:n.project_slug},avatarSize:16,hideName:!0})})})}}),(0,U.BX)(y.rv,{errored:o,children:[(0,U.BX)("strong",{children:[n["transaction.op"]," — "]}),n.transaction]})]}):(0,U.BX)(y.rv,{errored:!1,children:[(0,U.tZ)("strong",{children:"Trace — "}),n.traceSlug]});return(0,U.BX)(y.mw,{ref:e=>{e?(a(e),this.spanContentRef=e):s(this.spanContentRef)},children:[this.renderToggle(o),(0,U.tZ)(y.Wh,{style:{left:`${i}px`,width:"100%"},children:l})]})}renderDivider(e){if(this.state.showDetail)return(0,U.tZ)(b.xN,{showDetail:!0,style:{position:"absolute"}});const{addDividerLineRef:t}=e;return(0,U.tZ)(b.xN,{ref:t(),style:{position:"absolute"},onMouseEnter:()=>{e.setHover(!0)},onMouseLeave:()=>{e.setHover(!1)},onMouseOver:()=>{e.setHover(!0)},onMouseDown:e.onDragStart,onClick:e=>{e.stopPropagation()}})}renderGhostDivider(e){const{dividerPosition:t,addGhostDividerLineRef:n}=e;return(0,U.tZ)(b.Hr,{style:{width:`calc(${(0,c.yI)(t)} + 0.5px)`,display:"none"},children:(0,U.tZ)(b.xN,{ref:n(),style:{right:0},className:"hovering",onClick:e=>{e.stopPropagation()}})})}renderErrorBadge(){const{transaction:e}=this.props;return(0,_.Ci)(e)&&e.errors.length?(0,U.tZ)(b.cS,{}):null}renderRectangle(){const{transaction:e,traceInfo:t,barColor:n}=this.props,{showDetail:r}=this.state,a=Math.abs(t.endTimestamp-t.startTimestamp)||1,s=Math.abs(e.start_timestamp-t.startTimestamp)/a,i=Math.abs(e.timestamp-e.start_timestamp),o=i/a;return(0,U.tZ)(w.e,{style:{backgroundColor:n,left:`min(${(0,c.yI)(s||0)}, calc(100% - 1px))`,width:(0,c.yI)(o||0)},children:(0,U.tZ)(w.R,{durationDisplay:(0,c.ud)({left:s,width:o}),showDetail:r,children:(0,c.bQ)(i)})})}renderHeader(e){let{dividerHandlerChildrenProps:t,scrollbarManagerChildrenProps:n}=e;const{hasGuideAnchor:r,index:a}=this.props,{showDetail:s}=this.state,{dividerPosition:i}=t;return(0,U.BX)(Z.Qc,{showDetail:s,children:[(0,U.tZ)(Z.E5,{"data-test-id":"transaction-row-title","data-type":"span-row-cell",style:{width:`calc(${(0,c.yI)(i)} - 0.5px)`,paddingTop:0},showDetail:s,onClick:this.toggleDisplayDetail,ref:this.transactionTitleRef,children:(0,U.tZ)(m.Z,{target:"trace_view_guide_row",disabled:!r,children:this.renderTitle(n)})}),(0,U.BX)(b.kP,{children:[this.renderDivider(t),this.renderErrorBadge()]}),(0,U.tZ)(Z.E5,{"data-test-id":"transaction-row-duration","data-type":"span-row-cell",showStriping:a%2!=0,style:{width:`calc(${(0,c.yI)(1-i)} - 0.5px)`,paddingTop:0},showDetail:s,onClick:this.toggleDisplayDetail,children:(0,U.tZ)(m.Z,{target:"trace_view_guide_row_details",disabled:!r,children:this.renderRectangle()})}),!s&&this.renderGhostDivider(t)]})}renderDetail(){const{location:e,organization:t,isVisible:n,transaction:r}=this.props,{showDetail:a}=this.state;return(0,_.Ci)(r)&&n&&a?(0,U.tZ)(K,{location:e,organization:t,transaction:r,scrollIntoView:this.scrollIntoView}):null}render(){const{isVisible:e,transaction:t}=this.props,{showDetail:n}=this.state;return(0,U.BX)(Z.X2,{ref:this.transactionRowDOMRef,visible:e,showBorder:n,cursor:(0,_.Ci)(t)?"pointer":"default",children:[(0,U.tZ)(i.$6,{children:e=>(0,U.tZ)(s.$,{children:t=>this.renderHeader({dividerHandlerChildrenProps:t,scrollbarManagerChildrenProps:e})})}),this.renderDetail()]})}}function te(e){return e*(D.Ll/2)+0}ee.displayName="TransactionBar";const ne=ee;class re extends r.Component{constructor(){super(...arguments),(0,u.Z)(this,"state",{isExpanded:!0}),(0,u.Z)(this,"toggleExpandedState",(()=>{this.setState((e=>{let{isExpanded:t}=e;return{isExpanded:!t}}))}))}componentDidUpdate(e,t){t.isExpanded!==this.state.isExpanded&&this.props.updateScrollState()}render(){const{location:e,organization:t,transaction:n,traceInfo:a,continuingDepths:s,isOrphan:i,isLast:o,index:l,isVisible:c,hasGuideAnchor:d,renderedChildren:p,barColor:h,addContentSpanBarRef:u,removeContentSpanBarRef:m,onWheel:g}=this.props,{isExpanded:f}=this.state;return(0,U.BX)(r.Fragment,{children:[(0,U.tZ)(ne,{location:e,organization:t,index:l,transaction:n,traceInfo:a,continuingDepths:s,isOrphan:i,isLast:o,isExpanded:f,toggleExpandedState:this.toggleExpandedState,isVisible:c,hasGuideAnchor:d,barColor:h,addContentSpanBarRef:u,removeContentSpanBarRef:m,onWheel:g}),f&&p]})}}re.displayName="TransactionGroup";const ae=(0,i.Iw)(re);var se=n("./app/views/performance/traceDetails/utils.tsx"),ie=n("./app/components/discover/discoverFeature.tsx");function oe(e){let{traceInfo:t,traceEventView:n,organization:r,meta:a}=e;const s=t.transactions.size,i=a?.transactions??s;if(null===i||s>=i)return null;const l=n.getResultsViewUrlTarget(r.slug);return(0,U.tZ)(o.V,{children:(0,d._N)("Limited to a view of [count] transactions. To view the full list, [discover].",{count:s,discover:(0,U.tZ)(ie.Z,{children:e=>{let{hasFeature:t}=e;return(0,U.tZ)(E.Z,{disabled:!t,to:l,children:(0,d.t)("Open in Discover")})}})})})}oe.displayName="LimitExceededMessage";const le=oe;var ce=n("./app/views/performance/traceDetails/traceNotFound.tsx");function de(e){let{isVisible:t,numberOfHiddenTransactionsAbove:n}=e;return!t||n<1?null:(0,U.tZ)(o.V,{children:(0,U.tZ)("span",{children:1===n?(0,d._N)("[numOfTransaction] hidden transaction",{numOfTransaction:(0,U.tZ)("strong",{children:n})}):(0,d._N)("[numOfTransaction] hidden transactions",{numOfTransaction:(0,U.tZ)("strong",{children:n})})},"trace-info-message")})}function pe(e){let{location:t,meta:n,organization:o,traces:d,traceSlug:u,traceEventView:m,filteredTransactionIds:g,...f}=e;const v=a.Gd().getScope()?.getTransaction(),x=v?.startChild({op:"trace.render",description:"trace-view-content"});function Z(e,n){let{continuingDepths:a,isOrphan:s,isLast:i,index:l,numberOfHiddenTransactionsAbove:d,traceInfo:p,hasGuideAnchor:h}=n;const{children:u,event_id:m}=e,f=e.generation+1,v=function(e,t){return!t||t.has(e.event_id)}(e,g),x=u.reduce(((e,t,n)=>{const r=n===u.length-1,i=t.children.length>0,o=Z(t,{continuingDepths:!r&&i?[...a,{depth:f,isOrphanDepth:s}]:a,isOrphan:s,isLast:r,index:e.lastIndex+1,numberOfHiddenTransactionsAbove:e.numberOfHiddenTransactionsAbove,traceInfo:p,hasGuideAnchor:!1});return e.lastIndex=o.lastIndex,e.numberOfHiddenTransactionsAbove=o.numberOfHiddenTransactionsAbove,e.renderedChildren.push(o.transactionGroup),e}),{renderedChildren:[],lastIndex:l,numberOfHiddenTransactionsAbove:v?0:d+1});return{transactionGroup:(0,U.BX)(r.Fragment,{children:[(0,U.tZ)(de,{isVisible:v,numberOfHiddenTransactionsAbove:d}),(0,U.tZ)(ae,{location:t,organization:o,traceInfo:p,transaction:{...e,generation:f},continuingDepths:a,isOrphan:s,isLast:i,index:l,isVisible:v,hasGuideAnchor:h,renderedChildren:x.renderedChildren,barColor:(0,c.hd)(e["transaction.op"])})]},m),lastIndex:x.lastIndex,numberOfHiddenTransactionsAbove:x.numberOfHiddenTransactionsAbove}}(0,r.useEffect)((()=>{(0,p.Z)("performance_views.trace_view.view",{organization:o})}),[o]);const w=(0,r.createRef)(),b=(0,r.createRef)();if(null===d||d.length<=0)return(0,U.tZ)(ce.Z,{meta:n,traceEventView:m,traceSlug:u,location:t,organization:o});const y=f.traceInfo||(0,se.Rg)(d),D={index:1,numberOfHiddenTransactionsAbove:0,traceInfo:y,transactionGroups:[]},{transactionGroups:T,numberOfHiddenTransactionsAbove:_}=d.reduce(((e,t,n)=>{const r=n===d.length-1,a=t.children.length>0,s=!r&&null!==d[n+1].parent_span_id,i=Z(t,{...e,isOrphan:!(0,se.uM)(t),isLast:r,continuingDepths:!r&&a?[{depth:0,isOrphanDepth:s}]:[],hasGuideAnchor:0===n});return e.index=i.lastIndex+1,e.numberOfHiddenTransactionsAbove=i.numberOfHiddenTransactionsAbove,e.transactionGroups.push(i.transactionGroup),e}),D),C=(0,U.tZ)(h.W3,{children:(0,U.tZ)(s.z,{interactiveLayerRef:w,children:(0,U.tZ)(s.$,{children:e=>{let{dividerPosition:r}=e;return(0,U.tZ)(i.zt,{dividerPosition:r,interactiveLayerRef:b,children:(0,U.BX)(h.LA,{children:[(0,U.BX)(h.cC,{children:[(0,U.tZ)(i.$6,{children:e=>{let{virtualScrollbarRef:t,scrollBarAreaRef:n,onDragStart:a,onScroll:s}=e;return(0,U.BX)(l.cs,{ref:b,style:{width:`calc(${(0,c.yI)(r)} - 0.5px)`},onScroll:s,children:[(0,U.tZ)("div",{style:{width:0,height:"1px"},ref:n}),(0,U.tZ)(l.Qk,{"data-type":"virtual-scrollbar",ref:t,onMouseDown:a,children:(0,U.tZ)(l.v6,{})})]})}}),(0,U.tZ)(l._i,{})]}),(0,U.BX)(h.uI,{ref:w,children:[(0,U.tZ)(ae,{location:t,organization:o,traceInfo:y,transaction:{traceSlug:u,generation:0,"transaction.duration":y.endTimestamp-y.startTimestamp,children:d,start_timestamp:y.startTimestamp,timestamp:y.endTimestamp},continuingDepths:[],isOrphan:!1,isLast:!1,index:0,isVisible:!0,hasGuideAnchor:!1,renderedChildren:T,barColor:(0,c.hd)("")}),(0,U.tZ)(de,{isVisible:!0,numberOfHiddenTransactionsAbove:_}),(0,U.tZ)(le,{traceInfo:y,organization:o,traceEventView:m,meta:n})]})]})})}})})});return x?.finish(),C}de.displayName="TraceHiddenMessage"}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_traceDetails_traceView_tsx.4d570beab554bff5a29089a7342f6c6f.js.map