"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_profiling_flamegraph_flamegraphTooltip_tsx-app_utils_profiling_canvasScheduler-e4bf3f"],{"./app/components/profiling/boundTooltip.tsx":(e,t,i)=>{i.d(t,{W:()=>c});var r=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=i("../node_modules/react/index.js"),o=i("../node_modules/gl-matrix/esm/vec2.js"),s=i("./app/styles/space.tsx"),a=i("./app/utils/profiling/flamegraph/useFlamegraphTheme.ts"),h=i("./app/utils/theme.tsx"),l=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(e){let{bounds:t,canvas:i,cursor:r,canvasView:s,children:c}=e;const d=(0,a.W)(),m=o.kK(o.Ue(),r,s.fromTransformedConfigView(i.physicalSpace)),u=o.kK(o.Ue(),m,i.physicalToLogicalSpace),p=(0,n.useRef)(),g=(0,n.useCallback)((e=>{null!==e&&(p.current&&(window.cancelAnimationFrame(p.current),p.current=void 0),p.current=window.requestAnimationFrame((()=>{e.style.transform=function(e,t,i){let r=e[0]+6;const n=e[1]+6;return e[0]>t.width/2&&(r=e[0]-i.width),`translate(${r||0}px, ${n||0}px)`}(u,t,e.getBoundingClientRect())})))}),[t,u]);return(0,l.tZ)(f,{ref:g,style:{willChange:"transform",fontSize:d.SIZES.TOOLTIP_FONT_SIZE,fontFamily:d.FONTS.FONT,zIndex:h.ZP.zIndex.tooltip,maxWidth:t.width},children:c})}c.displayName="BoundTooltip";const f=(0,r.Z)("div",{target:"e4oovag0"})("background:",(e=>e.theme.background),";position:absolute;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;pointer-events:none;user-select:none;border-radius:",(e=>e.theme.borderRadius),";padding:",(0,s.D)(.25)," ",(0,s.D)(1),";border:1px solid ",(e=>e.theme.border),";font-size:",(e=>e.theme.fontSizeSmall),";line-height:24px;")},"./app/components/profiling/flamegraph/flamegraphTooltip.tsx":(e,t,i)=>{i.d(t,{BX:()=>m,Ob:()=>w,hX:()=>p,j_:()=>g});var r=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=i("../node_modules/react/index.js"),o=i("./app/components/profiling/boundTooltip.tsx"),s=i("./app/icons/index.tsx"),a=i("./app/locale.tsx"),h=i("./app/styles/space.tsx"),l=i("./app/utils.tsx"),c=i("./app/utils/profiling/gl/utils.ts"),f=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){return e.frame.file?"number"==typeof e.frame.line&&"number"==typeof e.frame.column?`${e.frame.file}:${e.frame.line}:${e.frame.column}`:"number"==typeof e.frame.line?`${e.frame.file}:${e.frame.line}`:`${e.frame.file}:<unknown line>`:"<unknown file>"}function m(e){const t=(0,n.useMemo)((()=>new c.UL(e.frame.start,e.frame.end,e.frame.end-e.frame.start,1).transformRect(e.flamegraphView.configSpaceTransform)),[e.flamegraphView,e.frame]);return(0,f.BX)(o.W,{bounds:e.canvasBounds,cursor:e.configSpaceCursor,canvas:e.flamegraphCanvas,canvasView:e.flamegraphView,children:[(0,f.BX)(g,{children:[(0,f.tZ)(w,{backgroundColor:(0,c.xO)(e.frame,e.flamegraphRenderer)}),e.flamegraphRenderer.flamegraph.formatter(e.frame.node.totalWeight)," ",(i=e.frame.node,r=e.flamegraphRenderer.flamegraph,`(${Math.round(i.totalWeight/r.profile.duration*100)}%)`)," ",e.frame.frame.name]}),(0,f.tZ)(p,{children:(0,l.ri)(e.frame.frame.file)&&(0,f.BX)(n.Fragment,{children:[(0,a.t)("source"),":",d(e.frame)]})}),(0,f.BX)(p,{children:[e.flamegraphRenderer.flamegraph.timelineFormatter(t.left)," "," — ",e.flamegraphRenderer.flamegraph.timelineFormatter(t.right),e.frame.frame.inline?(0,f.BX)(u,{children:[(0,f.tZ)(s.Db,{width:10}),(0,a.t)("inline frame")]}):""]})]});var i,r}m.displayName="FlamegraphTooltip";const u=(0,r.Z)("span",{target:"eaf5ke83"})("border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";font-size:",(e=>e.theme.fontSizeExtraSmall),";padding:",(0,h.D)(.25)," ",(0,h.D)(.25),";line-height:12px;margin:0 ",(0,h.D)(.5),";align-self:flex-end;svg{width:10px;height:10px;transform:translateY(1px);}"),p=(0,r.Z)("div",{target:"eaf5ke82"})("color:",(e=>e.theme.subText),";"),g=(0,r.Z)("div",{target:"eaf5ke81"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),w=(0,r.Z)("div",{target:"eaf5ke80"})("width:12px;height:12px;min-width:12px;min-height:12px;border-radius:2px;display:inline-block;background-image:",(e=>e.backgroundImage),";background-size:16px 16px;background-color:",(e=>e.backgroundColor),";margin-right:",(0,h.D)(1),";")},"./app/utils/profiling/canvasScheduler.tsx":(e,t,i)=>{i.d(t,{IZ:()=>a,o$:()=>s});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=i("../node_modules/react/index.js");class o{constructor(){(0,r.Z)(this,"beforeFrameCallbacks",new Set),(0,r.Z)(this,"afterFrameCallbacks",new Set),(0,r.Z)(this,"onDisposeCallbacks",new Set),(0,r.Z)(this,"requestAnimationFrame",null),(0,r.Z)(this,"events",{"show in table view":new Set,"reset zoom":new Set,"highlight frame":new Set,"highlight span":new Set,"highlight ui frame":new Set,"set config view":new Set,"transform config view":new Set,"zoom at frame":new Set,"zoom at span":new Set})}onDispose(e){this.onDisposeCallbacks.has(e)||this.onDisposeCallbacks.add(e)}on(e,t){const i=this.events[e];i.has(t)||i.add(t)}off(e,t){const i=this.events[e];i.has(t)&&i.delete(t)}dispatch(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];for(const t of this.events[e])t(...i)}registerCallback(e,t){t.has(e)||t.add(e)}unregisterCallback(e,t){t.has(e)&&t.delete(e)}registerBeforeFrameCallback(e){this.registerCallback(e,this.beforeFrameCallbacks)}unregisterBeforeFrameCallback(e){this.unregisterCallback(e,this.beforeFrameCallbacks)}registerAfterFrameCallback(e){this.registerCallback(e,this.afterFrameCallbacks)}unregisterAfterFrameCallback(e){this.unregisterCallback(e,this.afterFrameCallbacks)}dispose(){for(const e of this.onDisposeCallbacks)this.onDisposeCallbacks.delete(e),e();for(const e in this.events)this.events[e].clear()}drawSync(){for(const e of this.beforeFrameCallbacks)e();for(const e of this.afterFrameCallbacks)e()}draw(){this.requestAnimationFrame&&window.cancelAnimationFrame(this.requestAnimationFrame),this.requestAnimationFrame=window.requestAnimationFrame((()=>{for(const e of this.beforeFrameCallbacks)e();for(const e of this.afterFrameCallbacks)e();this.requestAnimationFrame=null}))}}class s{constructor(){(0,r.Z)(this,"schedulers",new Set)}registerScheduler(e){this.schedulers.has(e)||this.schedulers.add(e)}dispatch(e,t){for(const i of this.schedulers)i.dispatch(e,...t)}unregisterScheduler(e){this.schedulers.has(e)&&(e.dispose(),this.schedulers.delete(e))}drawSync(){for(const e of this.schedulers)e.drawSync()}draw(){for(const e of this.schedulers)e.draw()}}function a(e){const t=(0,n.useMemo)((()=>new o),[]);return(0,n.useEffect)((()=>(e.registerScheduler(t),()=>e.unregisterScheduler(t))),[e,t]),t}},"./app/utils/profiling/canvasView.tsx":(e,t,i)=>{i.d(t,{i:()=>a});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(i("../node_modules/core-js/modules/es.error.cause.js"),i("../node_modules/gl-matrix/esm/mat3.js")),o=i("../node_modules/gl-matrix/esm/vec2.js"),s=i("./app/utils/profiling/gl/utils.ts");class a{constructor(e){let{canvas:t,options:i,model:o,mode:a}=e;(0,r.Z)(this,"configView",s.UL.Empty()),(0,r.Z)(this,"configSpace",s.UL.Empty()),(0,r.Z)(this,"configSpaceTransform",n.Ue()),(0,r.Z)(this,"inverted",void 0),(0,r.Z)(this,"minWidth",void 0),(0,r.Z)(this,"depthOffset",void 0),(0,r.Z)(this,"barHeight",void 0),(0,r.Z)(this,"model",void 0),(0,r.Z)(this,"canvas",void 0),(0,r.Z)(this,"mode","anchorTop"),this.mode=a||this.mode,this.inverted=!!i.inverted,this.minWidth=i.minWidth??0,this.model=o,this.canvas=t,this.depthOffset=i.depthOffset??0,this.barHeight=i.barHeight?i.barHeight*window.devicePixelRatio:0,this.configSpaceTransform=i.configSpaceTransform?n.al(i.configSpaceTransform.width||1,0,0,0,i.configSpaceTransform.height||1,0,i.configSpaceTransform.x||0,i.configSpaceTransform.y||0,1):n.Ue(),this.initConfigSpace(t)}setMinWidth(e){if(e<0)throw new Error("View min width cannot be negative");this.minWidth=e}_initConfigSpace(e){"stretchToFit"!==this.mode?this.configSpace=new s.UL(0,0,this.model.configSpace.width,Math.max(this.model.configSpace.height+this.depthOffset,e.physicalSpace.height/this.barHeight)):this.configSpace=new s.UL(0,0,this.model.configSpace.width,this.model.configSpace.height+this.depthOffset)}_initConfigView(e,t){switch(this.mode){case"stretchToFit":return void(this.configView=s.UL.From(t));case"anchorBottom":{const i=e.physicalSpace.height/this.barHeight,r=Math.max(0,Math.ceil(t.y-(i-t.height)));return void(this.configView=s.UL.From(t).withHeight(i).withY(r))}case"anchorTop":return void(this.configView=s.UL.From(t).withHeight(e.physicalSpace.height/this.barHeight));default:throw new Error(`Unknown CanvasView mode: ${this.mode}`)}}initConfigSpace(e){this._initConfigSpace(e),this._initConfigView(e,this.configSpace)}resizeConfigSpace(e){this._initConfigSpace(e),this._initConfigView(e,this.configView)}resetConfigView(e){this._initConfigView(e,this.configSpace)}setConfigView(e,t){this.configView=(0,s.rS)(e,{width:{min:this.minWidth,max:this.configSpace.width,...t?.width??{}},height:{min:0,max:this.configSpace.height,...t?.height??{}}})}transformConfigView(e){this.setConfigView(this.configView.transformRect(e))}toConfigSpace(e){const t=(0,s.Uv)(e,this.configSpace);return this.inverted&&n.Jp(t,this.configSpace.invertYTransform(),t),t}toConfigView(e){const t=(0,s.Uv)(e,this.configView);return this.inverted&&n.Jp(t,this.configView.invertYTransform(),t),t}fromConfigSpace(e){const t=(0,s.Uv)(this.configSpace,e);return this.inverted&&n.Jp(t,e.invertYTransform(),t),t}fromConfigView(e){const t=(0,s.Uv)(this.configView,e);return this.inverted&&n.Jp(t,e.invertYTransform(),t),t}fromTransformedConfigView(e){const t=n.Jp(n.Ue(),(0,s.Uv)(this.configView,e),this.configSpaceTransform);return this.inverted&&n.Jp(t,e.invertYTransform(),t),t}fromTransformedConfigSpace(e){const t=n.Jp(n.Ue(),(0,s.Uv)(this.configSpace,e),this.configSpaceTransform);return this.inverted&&n.Jp(t,e.invertYTransform(),t),t}getConfigSpaceCursor(e,t){const i=o.kK(o.Ue(),e,t.logicalToPhysicalSpace);return o.kK(o.Ue(),i,this.toConfigSpace(t.physicalSpace))}getTransformedConfigSpaceCursor(e,t){const i=o.kK(o.Ue(),e,t.logicalToPhysicalSpace),r=n.Jp(n.Ue(),n.U_(n.Ue(),this.configSpaceTransform),this.toConfigSpace(t.physicalSpace));return o.kK(o.Ue(),i,r)}getConfigViewCursor(e,t){const i=o.kK(o.Ue(),e,t.logicalToPhysicalSpace);return o.kK(o.Ue(),i,this.toConfigView(t.physicalSpace))}getTransformedConfigViewCursor(e,t){const i=o.kK(o.Ue(),e,t.logicalToPhysicalSpace),r=n.Jp(n.Ue(),n.U_(n.Ue(),this.configSpaceTransform),this.toConfigView(t.physicalSpace));return o.kK(o.Ue(),i,r)}toOriginConfigView(e){return e.transformRect(n.U_(n.Ue(),this.configSpaceTransform))}}},"./app/utils/profiling/colors/utils.tsx":(e,t,i)=>{function r(e,t){const i={};let r=0;for(let n=0;n<e.length;n++){const o=t(e[n]);!0!==o?!1!==o&&(i[o]||(i[o]=1,r++)):r++}return r}i.d(t,{Bx:()=>w,JN:()=>u,Jq:()=>m,NT:()=>d,Pe:()=>g,T1:()=>S,Zx:()=>p,eW:()=>_,sE:()=>s,uZ:()=>h,v6:()=>l}),i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/core-js/modules/es.error.cause.js");const n=e=>2*Math.abs((e=>e-Math.floor(e))(e)-.5)-1;function o(e,t,i){const r=i/60,n=t*(1-Math.abs(r%2-1)),[o,s,a]=r<1?[t,n,0]:r<2?[n,t,0]:r<3?[0,t,n]:r<4?[0,n,t]:r<5?[n,0,t]:[t,0,n],l=e-(.35*o+.35*s+.35*a);return[h(o+l,0,1),h(s+l,0,1),h(a+l,0,1)]}const s=e=>(t,i,r)=>{const n=i(t,r),o=t.length,s=new Array(4*o*6);for(let i=0;i<o;i++){const r=t[i];if(!r)continue;const o=n.get(r.key),a=o&&3===o.length?o.concat(1):o||e;for(let e=0;e<6;e++){const t=6*i*4+4*e;s[t]=a[0],s[t+1]=a[1],s[t+2]=a[2],s[t+3]=a[3]}}return{colorBuffer:s,colorMap:n}};function a(e){return"number"==typeof e&&!isNaN(e)}function h(e,t,i){if(!a(t)&&!a(i))throw new Error("Clamp requires at least a min or max parameter");if(a(t)&&a(i))return e<t?t:e>i?i:e;if(a(i))return e>i?i:e;if(a(t))return e<t?t:e;throw new Error("Unreachable case detected")}function l(e,t,i,r){return`rgba(${h(255*e,0,255)}, ${h(255*t,0,255)}, ${h(255*i,0,255)}, ${r})`}function c(e){return e.frame.name+(e.frame.image||"")}function f(e,t){return c(e)>c(t)?1:-1}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:360,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return r=>{const s=n(30*r),a=.9*r,h=t<360?i+t*a:t*a,l=e.C_0+e.C_d*s;return o(e.L_0-e.L_d*s,l,h)}}function m(e,t){const i=new Map,n=new Map,o=[...e].sort(f),s=r(o,(e=>e.frame.name+e.frame.image));for(let e=0;e<o.length;e++){const r=o[e],a=r.frame.name+r.frame.image;if(!n.has(a)){const i=t(Math.floor(255*e/s)/256);n.set(a,i)}i.set(r.key,n.get(a))}return i}function u(e,t){const i=new Map,n=new Map,o=[...e].sort(f),s=r(o,(e=>e.node.isRecursive()));for(let e=0;e<o.length;e++){if(!o[e].node.isRecursive())continue;const r=o[e],a=r.frame.name+r.frame.image;if(!n.has(a)){const i=t(Math.floor(255*e/s)/256);n.set(a,i)}i.set(r.key,n.get(a))}return i}function p(e,t){const i=new Map,n=new Map,o=[...e].sort(((e,t)=>(e.frame.image??"").localeCompare(t.frame.image??""))),s=r(o,(e=>!!e.frame.image&&e.frame.image));for(let e=0;e<o.length;e++){const r=o[e];if(!r.frame.image)continue;const a=n.get(r.frame.image)||t(Math.floor(255*e/s)/256);n.set(r.frame.image,a),i.set(r.key,a)}return i}function g(e,t){const i=new Map,n=new Map,o=[...e].sort(((e,t)=>(e.frame.name+e.frame.image).localeCompare(t.frame.name+t.frame.image))),s=r(o,(e=>e.frame.name+e.frame.image));for(let e=0;e<o.length;e++){if(o[e].frame.is_application)continue;const r=o[e].frame.name+o[e].frame.image;if(!n.has(r)){const i=t(Math.floor(255*e/s)/256);n.set(r,i)}i.set(o[e].key,n.get(r))}return i}function w(e,t){const i=new Map,n=new Map,o=[...e].sort(((e,t)=>(e.frame.name+e.frame.image).localeCompare(t.frame.name+t.frame.image))),s=r(o,(e=>e.frame.name+e.frame.image));for(let e=0;e<o.length;e++){if(!o[e].frame.is_application)continue;const r=o[e].frame.name+o[e].frame.image;if(!n.has(r)){const i=t(Math.floor(255*e/s)/256);n.set(r,i)}i.set(o[e].key,n.get(r))}return i}function _(e,t){let i=0;const r=new Map,n=new Map;for(let t=0;t<e.length;t++){const n=e[t],o=n.frame.name+n.frame.image;r.has(o)||r.set(o,0);const s=r.get(o);r.set(o,s+1),i=Math.max(i,s+1)}for(let o=0;o<e.length;o++){const s=e[o],a=s.frame.name+s.frame.image,h=r.get(a),[l,c,f]=t(.7),d=[l,c,f,Math.max(h/i,.1)];n.set(s.key,d)}return n}function S(e,t){const i=new Map,r=function(e,t){const i=t,r=new Set,n=[];for(let t=0;t<e.length;t++){const o=e[t],s=null==o?o:i(o);null==s||r.has(s)||(r.add(s),n.push(o))}return n}(e,(e=>e.node.span.op??""));for(let e=0;e<r.length;e++){const n=r[e].node.span.op??"";"missing instrumentation"!==n&&i.set(n,t(e/r.length))}for(let t=0;t<e.length;t++)i.set(e[t].node.span.span_id,i.get(e[t].node.span.op??""));return i}},"./app/utils/profiling/flamegraph.ts":(e,t,i)=>{i.d(t,{O:()=>u});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/core-js/modules/es.error.cause.js"),i("./app/utils.tsx")),o=i("./app/utils/profiling/gl/utils.ts"),s=i("./app/utils/profiling/profile/profile.tsx"),a=i("./app/utils/profiling/profile/sampledProfile.tsx"),h=i("./app/utils/profiling/units/units.ts"),l=i("./app/utils/profiling/callTreeNode.tsx"),c=i("./app/utils/profiling/frame.tsx");function f(e){return t=>{const i=[t];for(;i.length>0;){const t=i.pop();t.children.sort(e);for(let e=0;e<t.children.length;e++)i.push(t.children[e])}}}const d=f((function(e,t){return e.frame.name.localeCompare(t.frame.name)})),m=f((function(e,t){return t.totalWeight-e.totalWeight}));class u{static Empty(){return new u(s.N.Empty,0,{inverted:!1,sort:"call order"})}static Example(){return new u(a.J.Example,0,{inverted:!1,sort:"call order"})}static From(e,t){let{inverted:i=!1,sort:r="call order"}=t;return new u(e.profile,e.profileIndex,{inverted:i,sort:r})}constructor(e,t){let{inverted:i=!1,sort:n="call order",configSpace:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};switch((0,r.Z)(this,"profile",void 0),(0,r.Z)(this,"frames",[]),(0,r.Z)(this,"profileIndex",void 0),(0,r.Z)(this,"inverted",!1),(0,r.Z)(this,"sort","call order"),(0,r.Z)(this,"depth",0),(0,r.Z)(this,"configSpace",o.UL.Empty()),(0,r.Z)(this,"root",{key:-1,parent:null,frame:new c.R({...c.R.Root}),node:new l.n(new c.R({...c.R.Root}),null),depth:-1,start:0,end:0,children:[]}),(0,r.Z)(this,"formatter",void 0),(0,r.Z)(this,"timelineFormatter",void 0),this.inverted=i,this.sort=n,this.profile=e,this.profileIndex=t,this.sort){case"left heavy":this.frames=this.buildSortedChart(e,m);break;case"alphabetical":if("flamechart"===this.profile.type)throw new TypeError("Flamechart does not support alphabetical sorting");this.frames=this.buildSortedChart(e,d);break;case"call order":if("flamegraph"===this.profile.type)throw new TypeError("Flamegraph does not support call order sorting");this.frames=this.buildCallOrderChart(e);break;default:throw new TypeError(`Unknown flamechart sort type: ${this.sort}`)}this.formatter=(0,h.s4)(e.unit),this.timelineFormatter=(0,h.ab)(e.unit),this.profile.duration>0?this.configSpace=new o.UL(0,0,s?s.width:this.profile.duration,this.depth):this.configSpace=new o.UL(0,0,"nanoseconds"===this.profile.unit?1e9:"microseconds"===this.profile.unit?1e6:"milliseconds"===this.profile.unit?1e3:1,this.depth);const a=this.root.children.reduce(((e,t)=>e+t.node.totalWeight),0);this.root.node.addToTotalWeight(a),this.root.end=this.root.start+a,this.root.frame.addToTotalWeight(a)}buildCallOrderChart(e){const t=[],i=[];let r=0;return e.forEach(((e,t)=>{const o=(0,n.SI)(i)??this.root,s={key:r,frame:e.frame,node:e,parent:o,children:[],depth:0,start:t,end:t};o?o.children.push(s):this.root.children.push(s),i.push(s),r++}),((e,r)=>{const n=i.pop();if(!n)throw new Error("Unbalanced stack");n.end=r,n.depth=i.length,n.end-n.start!=0&&(t.push(n),this.depth=Math.max(n.depth,this.depth))})),t}buildSortedChart(e,t){const i=[],r=[];t(e.callTree);const o={key:-1,frame:l.n.Root.frame,node:l.n.Root,parent:null,children:[],depth:0,start:0,end:0};this.root=o;let s=0;const a=(e,t)=>{const i=(0,n.SI)(r)??this.root,o={key:s,frame:e.frame,node:e,parent:i,children:[],depth:0,start:t,end:t};i?i.children.push(o):this.root.children.push(o),r.push(o),s++},h=(e,t)=>{const n=r.pop();if(!n)throw new Error("Unbalanced stack");n.end=t,n.depth=r.length,n.end-n.start!=0&&(i.push(n),this.depth=Math.max(n.depth,this.depth))};return function e(t,i){t.frame.isRoot()||a(t,i);let r=0;t.children.forEach((t=>{e(t,i+r),r+=t.totalWeight})),t.frame.isRoot()||h(0,i+t.totalWeight)}(e.callTree,0),i}findAllMatchingFrames(e,t){const i=[];if("string"==typeof e)for(let r=0;r<this.frames.length;r++)this.frames[r].frame.name===e&&(this.frames[r].frame.image||"")===t&&i.push(this.frames[r]);else for(let t=0;t<this.frames.length;t++)this.frames[t].frame.name===e.node.frame.name&&this.frames[t].frame.image===e.node.frame.image&&i.push(this.frames[t]);return i}setConfigSpace(e){return this.configSpace=e,this}}},"./app/utils/profiling/flamegraph/flamegraphTheme.tsx":(e,t,i)=>{i.d(t,{W0:()=>a,t8:()=>h});var r=i("./app/utils/profiling/colors/utils.tsx"),n=i("./app/utils/theme.tsx");const o={BAR_FONT_SIZE:11,BAR_HEIGHT:20,BAR_PADDING:4,FLAMEGRAPH_DEPTH_OFFSET:12,HOVERED_FRAME_BORDER_WIDTH:2,HIGHLIGHTED_FRAME_BORDER_WIDTH:3,GRID_LINE_WIDTH:2,INTERNAL_SAMPLE_TICK_LINE_WIDTH:1,LABEL_FONT_PADDING:6,LABEL_FONT_SIZE:10,MINIMAP_HEIGHT:100,MINIMAP_POSITION_OVERLAY_BORDER_WIDTH:2,SPANS_BAR_HEIGHT:20,SPANS_DEPTH_OFFSET:6,SPANS_FONT_SIZE:11,SPANS_HEIGHT:160,TIMELINE_HEIGHT:20,TOOLTIP_FONT_SIZE:12,UI_FRAMES_HEIGHT:60},s={FONT:"ui-monospace, Menlo, Monaco, 'Cascadia Mono', 'Segoe UI Mono', 'Roboto Mono',\n'Oxygen Mono', 'Ubuntu Monospace', 'Source Code Pro', 'Fira Mono', 'Droid Sans Mono',\n'Courier New', monospace",FRAME_FONT:n.Wb.text.familyMono},a={SIZES:o,COLORS:{BAR_LABEL_FONT_COLOR:"#000",COLOR_BUCKET:(0,r.NT)({C_0:.25,C_d:.2,L_0:.8,L_d:.15}),SPAN_COLOR_BUCKET:(0,r.NT)({C_0:.3,C_d:.25,L_0:.8,L_d:.15},140,220),COLOR_MAPS:{"by symbol name":r.Jq,"by system frame":r.Pe,"by application frame":r.Bx,"by library":r.Zx,"by recursion":r.JN,"by frequency":r.eW},CURSOR_CROSSHAIR:"#bbbbbb",DIFFERENTIAL_DECREASE:[.309,.2058,.98],DIFFERENTIAL_INCREASE:[.98,.2058,.4381],FOCUSED_FRAME_BORDER_COLOR:n.Wb.focus,FRAME_GRAYSCALE_COLOR:[.5,.5,.6,.1],SPAN_FALLBACK_COLOR:[0,0,0,.1],GRID_FRAME_BACKGROUND_COLOR:"rgb(255, 255, 255)",GRID_LINE_COLOR:"#e5e7eb",HIGHLIGHTED_LABEL_COLOR:[240,240,0,1],HOVERED_FRAME_BORDER_COLOR:"rgba(0, 0, 0, 0.8)",LABEL_FONT_COLOR:"#1f233a",MINIMAP_POSITION_OVERLAY_BORDER_COLOR:"rgba(0,0,0, 0.2)",MINIMAP_POSITION_OVERLAY_COLOR:"rgba(0,0,0,0.1)",SAMPLE_TICK_COLOR:[255,0,0,.5],UI_FRAME_COLOR_SLOW:[.96,.69,0,.55],UI_FRAME_COLOR_FROZEN:[.96,.329,.349,.8],SEARCH_RESULT_FRAME_COLOR:"vec4(0.99, 0.70, 0.35, 1.0)",SEARCH_RESULT_SPAN_COLOR:"#fdb359",SELECTED_FRAME_BORDER_COLOR:n.Wb.blue400,SPAN_FRAME_LINE_PATTERN:"#dedae3",SPAN_FRAME_LINE_PATTERN_BACKGROUND:"#f4f2f7",SPAN_FRAME_BORDER:"rgba(200, 200, 200, 1)",STACK_TO_COLOR:(0,r.sE)([0,0,0,.035])},FONTS:s},h={SIZES:o,COLORS:{BAR_LABEL_FONT_COLOR:"rgb(255 255 255 / 80%)",COLOR_BUCKET:(0,r.NT)({C_0:.2,C_d:.1,L_0:.2,L_d:.1}),SPAN_COLOR_BUCKET:(0,r.NT)({C_0:.3,C_d:.15,L_0:.2,L_d:.1},140,220),COLOR_MAPS:{"by symbol name":r.Jq,"by system frame":r.Pe,"by application frame":r.Bx,"by library":r.Zx,"by recursion":r.JN,"by frequency":r.eW},CURSOR_CROSSHAIR:"#828285",DIFFERENTIAL_DECREASE:[.309,.2058,.98],DIFFERENTIAL_INCREASE:[.98,.2058,.4381],FOCUSED_FRAME_BORDER_COLOR:n.$_.focus,FRAME_GRAYSCALE_COLOR:[.5,.5,.5,.4],SPAN_FALLBACK_COLOR:[1,1,1,.3],GRID_FRAME_BACKGROUND_COLOR:"rgb(0, 0, 0)",GRID_LINE_COLOR:"#222227",HIGHLIGHTED_LABEL_COLOR:[136,50,0,1],HOVERED_FRAME_BORDER_COLOR:"rgba(255, 255, 255, 0.8)",LABEL_FONT_COLOR:"rgba(255, 255, 255, 0.8)",MINIMAP_POSITION_OVERLAY_BORDER_COLOR:"rgba(255,255,255, 0.35)",MINIMAP_POSITION_OVERLAY_COLOR:"rgba(255,255,255,0.1)",SAMPLE_TICK_COLOR:[255,0,0,.5],UI_FRAME_COLOR_SLOW:[.96,.69,0,.6],UI_FRAME_COLOR_FROZEN:[.96,.329,.349,.5],SEARCH_RESULT_FRAME_COLOR:"vec4(0.99, 0.70, 0.35, 0.7)",SPAN_FRAME_LINE_PATTERN:"#594b66",SPAN_FRAME_LINE_PATTERN_BACKGROUND:"#1a1724",SELECTED_FRAME_BORDER_COLOR:n.Wb.blue400,SEARCH_RESULT_SPAN_COLOR:"#b9834a",SPAN_FRAME_BORDER:"#57575b",STACK_TO_COLOR:(0,r.sE)([1,1,1,.1])},FONTS:s}},"./app/utils/profiling/flamegraph/flamegraphThemeProvider.tsx":(e,t,i)=>{i.d(t,{F:()=>h,s:()=>l});var r=i("../node_modules/react/index.js"),n=i("./app/stores/configStore.tsx"),o=i("./app/stores/useLegacyStore.tsx"),s=i("./app/utils/profiling/flamegraph/flamegraphTheme.tsx"),a=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const h=(0,r.createContext)(null);function l(e){const{theme:t}=(0,o.X)(n.Z),i="light"===t?s.W0:s.t8;return(0,a.tZ)(h.Provider,{value:i,children:e.children})}l.displayName="FlamegraphThemeProvider"},"./app/utils/profiling/flamegraph/useFlamegraphTheme.ts":(e,t,i)=>{i.d(t,{W:()=>o}),i("../node_modules/core-js/modules/es.error.cause.js");var r=i("../node_modules/react/index.js"),n=i("./app/utils/profiling/flamegraph/flamegraphThemeProvider.tsx");function o(){const e=(0,r.useContext)(n.F);if(!e)throw new Error("useFlamegraphTheme was called outside of FlamegraphThemeProvider");return e}},"./app/utils/profiling/flamegraphCanvas.tsx":(e,t,i)=>{i.d(t,{c:()=>s});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=i("../node_modules/gl-matrix/esm/mat3.js"),o=i("./app/utils/profiling/gl/utils.ts");class s{constructor(e,t){(0,r.Z)(this,"canvas",void 0),(0,r.Z)(this,"origin",void 0),(0,r.Z)(this,"physicalSpace",o.UL.Empty()),(0,r.Z)(this,"logicalSpace",o.UL.Empty()),(0,r.Z)(this,"physicalToLogicalSpace",n.Ue()),(0,r.Z)(this,"logicalToPhysicalSpace",n.Ue()),this.canvas=e,this.origin=t,this.initPhysicalSpace()}initPhysicalSpace(){this.physicalSpace=new o.UL(this.origin[0],this.origin[1],this.canvas.width-this.origin[0],this.canvas.height-this.origin[1]),this.logicalSpace=this.physicalSpace.scale(1/window.devicePixelRatio,1/window.devicePixelRatio),this.logicalToPhysicalSpace=(0,o.Uv)(this.logicalSpace,this.physicalSpace),this.physicalToLogicalSpace=(0,o.Uv)(this.physicalSpace,this.logicalSpace)}}},"./app/utils/profiling/flamegraphFrame.tsx":(e,t,i)=>{function r(e){return e.frame.name+(e.frame.file?e.frame.file:"")+String(e.start)}i.d(t,{M:()=>r})},"./app/utils/profiling/gl/utils.ts":(e,t,i)=>{i.d(t,{AN:()=>u,B2:()=>T,DB:()=>H,DL:()=>c,FW:()=>m,G:()=>b,HO:()=>l,IL:()=>f,Lo:()=>w,NR:()=>N,OI:()=>g,Oc:()=>E,SO:()=>F,Tw:()=>P,UL:()=>S,U_:()=>L,Uv:()=>_,X1:()=>C,XU:()=>D,Xi:()=>d,YG:()=>I,Zw:()=>B,dH:()=>y,e:()=>O,ef:()=>h,fd:()=>R,fw:()=>x,i7:()=>Z,kv:()=>U,rS:()=>A,uJ:()=>k,v5:()=>M,xO:()=>v});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(i("../node_modules/core-js/modules/es.error.cause.js"),i("../node_modules/react/index.js")),o=i("../node_modules/gl-matrix/esm/mat3.js"),s=i("../node_modules/gl-matrix/esm/vec2.js"),a=i("./app/utils/profiling/colors/utils.tsx");function h(e,t,i){const r=e.createShader(t);if(!r)throw new Error("Could not create shader");if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))return r;throw e.deleteShader(r),new Error(`Failed to compile ${t} shader`)}function l(e,t,i){const r=e.createProgram();if(!r)throw new Error("Could not create program");if(e.attachShader(r,t),e.attachShader(r,i),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS))return r;throw e.deleteProgram(r),new Error("Failed to create program")}function c(e,t,i){const r=e.getUniformLocation(t,i);if(!r)throw new Error(`Could not locate uniform ${i} in shader`);return r}function f(e,t,i){const r=e.getAttribLocation(t,i);if(-1===r)throw new Error(`Could not locate attribute ${i} in shader`);return r}function d(e,t,i){const r=e.createBuffer();if(!r)throw new Error("Could not create buffer");return e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,t,i),r}function m(e,t,i){e.vertexAttribPointer(t,i.size,i.type,i.normalized,i.stride,i.offset),e.enableVertexAttribArray(t)}function u(e,t){const i=o.Ue();return o.Iu(i,i,s.al(-1,1)),o.bA(i,i,s.cs(s.Ue(),s.al(2,-2),s.al(e,t))),i}const p=new Map,g=(e,t)=>{for(const t of e)p.set(t,[t.width,t.height]);const i=new ResizeObserver(((e,i)=>{!function(e){for(const t of e){let e,i,r=window.devicePixelRatio;t.devicePixelContentBoxSize?(e=t.devicePixelContentBoxSize[0].inlineSize,i=t.devicePixelContentBoxSize[0].blockSize,r=1):t.contentBoxSize?t.contentBoxSize[0]?(e=t.contentBoxSize[0].inlineSize,i=t.contentBoxSize[0].blockSize):(e=t.contentBoxSize.inlineSize,i=t.contentBoxSize.blockSize):(e=t.contentRect.width,i=t.contentRect.height);const n=Math.round(e*r),o=Math.round(i*r);p.set(t.target,[n,o]),w(t.target)}}(e),t?.(e,i)}));try{e.forEach((e=>{i.observe(e,{box:"device-pixel-content-box"})}))}catch(t){e.forEach((e=>{i.observe(e,{box:"content-box"})}))}return i};function w(e){const t=p.get(e);if(!t){const t=e.clientWidth*window.devicePixelRatio,i=e.clientHeight*window.devicePixelRatio;return e.width=t,e.height=i,!1}const[i,r]=t,n=e.width!==i||e.height!==r;return n&&(e.width=i,e.height=r),n}function _(e,t){return o.al(t.width/e.width,0,0,0,t.height/e.height,0,t.x-e.x*(t.width/e.width),t.y-e.y*(t.height/e.height),1)}class S{constructor(e,t,i,n){(0,r.Z)(this,"origin",void 0),(0,r.Z)(this,"size",void 0),this.origin=s.al(e,t),this.size=s.al(i,n)}clone(){return S.From(this)}isValid(){return this.toMatrix().every((e=>!isNaN(e)))}isEmpty(){return 0===this.width&&0===this.height}static Empty(){return new S(0,0,0,0)}static From(e){return new S(e.x,e.y,e.width,e.height)}get x(){return this.origin[0]}get y(){return this.origin[1]}get width(){return this.size[0]}get height(){return this.size[1]}get left(){return this.x}get right(){return this.left+this.width}get top(){return this.y}get bottom(){return this.top+this.height}get centerX(){return this.x+this.width/2}get centerY(){return this.y+this.height/2}get center(){return[this.centerX,this.centerY]}static decode(e){let t=e;if("string"==typeof e&&(t=e.split(",")),!Array.isArray(t))return null;if(4!==t.length)return null;const i=new S(...t.map((e=>parseFloat(e))));return i.isValid()?i:null}static encode(e){return e.toString()}toString(){return[this.x,this.y,this.width,this.height].map((e=>Math.round(e))).join(",")}toMatrix(){const{width:e,height:t,x:i,y:r}=this;return o.al(e,0,0,0,t,0,i,r,1)}hasIntersectionWith(e){const t=Math.max(this.top,e.top);if(Math.max(t,Math.min(this.bottom,e.bottom))-t==0)return!1;const i=Math.max(this.left,e.left);return Math.max(i,Math.min(this.right,e.right))-i!=0}containsX(e){return e[0]>=this.left&&e[0]<=this.right}containsY(e){return e[1]>=this.top&&e[1]<=this.bottom}contains(e){return this.containsX(e)&&this.containsY(e)}containsRect(e){return this.left<=e.left&&e.right<=this.right&&this.top<=e.top&&e.bottom<=this.bottom}leftOverlapsWith(e){return e.left<=this.left&&e.right>=this.left}rightOverlapsWith(e){return this.right>=e.left&&this.right<=e.right}overlapsX(e){return this.left<=e.right&&this.right>=e.left}overlapsY(e){return this.top<=e.bottom&&this.bottom>=e.top}overlaps(e){return this.overlapsX(e)&&this.overlapsY(e)}transformRect(e){const t=this.x*e[0]+this.y*e[3]+e[6],i=this.x*e[1]+this.y*e[4]+e[7],r=this.width*e[0]+this.height*e[3],n=this.width*e[1]+this.height*e[4];return new S(t+(r<0?r:0),i+(n<0?n:0),Math.abs(r),Math.abs(n))}invertYTransform(){return o.al(1,0,0,0,-1,0,0,2*this.y+this.height,1)}withHeight(e){return new S(this.x,this.y,this.width,e)}withWidth(e){return new S(this.x,this.y,e,this.height)}withX(e){return new S(e,this.y,this.width,this.height)}withY(e){return new S(this.x,e,this.width,this.height)}toBounds(){return[this.x,this.y,this.x+this.width,this.y+this.height]}toArray(){return[this.x,this.y,this.width,this.height]}between(e){return new S(e.x,e.y,e.width/this.width,e.height/this.height)}translate(e,t){return new S(e,t,this.width,this.height)}translateX(e){return new S(e,this.y,this.width,this.height)}translateY(e){return new S(this.x,e,this.width,this.height)}scaleX(e){return new S(this.x,this.y,this.width*e,this.height)}scaleY(e){return new S(this.x,this.y,this.width,this.height*e)}scale(e,t){return new S(this.x*e,this.y*t,this.width*e,this.height*t)}scaleOriginBy(e,t){return new S(this.x*e,this.y*t,this.width,this.height)}scaledBy(e,t){return new S(this.x,this.y,this.width*e,this.height*t)}equals(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}notEqualTo(e){return!this.equals(e)}}function x(e,t){const i="webgl"===t?e.getContext(t,{antialias:!1}):e.getContext(t);if(!i)throw new Error(`Could not get context ${t}`);return i}function C(e,t){if(!e)return S.Empty();const i=(t||x(document.createElement("canvas"),"2d")).measureText(e);return new S(0,0,i.width,i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}function R(e,t,i){let{low:r,high:n}=e,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;for(;;){if(n-r<=o)return[r,n];const e=(n+r)/2;t(e)<i?r=e:n=e}}function b(e,t){let i=0,r=t.length;if(0===r)return 0;if(1===r)return t[0].start<e?1:0;for(;i!==r;){const n=i+Math.floor((r-i)/2);t[n].start<e?i=n+1:r=n}return i}function O(e,t){let i=0,r=t.length;if(0===r)return 0;if(1===r)return t[0].end<e?1:0;for(;i!==r;){const n=i+Math.floor((r-i)/2);t[n].end<e?i=n+1:r=n}return i}function E(e,t){const i=t.getColorForFrame(e);return Array.isArray(i)?4===i.length?`rgba(${i.slice(0,3).map((e=>255*e)).join(",")}, ${i[3]})`:`rgba(${i.map((e=>255*e)).join(",")}, 1.0)`:""}function v(e,t){const i=t.getColorForFrame(e);return 4===i.length?`rgba(${i.slice(0,3).map((e=>255*e)).join(",")}, ${i[3]})`:`rgba(${i.map((e=>255*e)).join(",")}, 1.0)`}const y="…";function T(e,t){if(t>=e.length)return{text:e,start:0,end:0,length:0};const i=Math.floor(t/2),r=t-i-1,n=i,o=Math.floor(e.length-r+y.length);return{text:`${e.substring(0,n)}${y}${e.substring(o)}`,start:n,end:o,length:o-n}}function A(e,t){let{width:i,height:r}=t;if(!e.isValid())throw new Error(e.toString());const n=(0,a.uZ)(e.width,i.min,i.max),o=(0,a.uZ)(e.height,r.min,r.max),s=i.max-n,h=o>=r.max?0:r.max-o,l=(0,a.uZ)(e.x,0,s),c=(0,a.uZ)(e.y,0,h);return new S(l,c,n,o)}function L(e,t){if(!t.length)return e;const i=e[0]>=t.start&&e[0]<=t.end,r=e[1]>=t.start&&e[1]<=t.end;if(i&&r)return[t.start,t.start+1];if(e[0]<t.start){if(e[1]<t.start)return[e[0],e[1]];if(r)return[e[0],t.start+1];if(e[1]>t.end)return[e[0],e[1]-t.length+1]}if(i&&e[1]>t.end)return[t.start,e[1]-t.length+1];if(e[0]>t.end)return[e[0]-t.length+1,e[1]-t.length+1];throw new Error(`Unhandled case: ${JSON.stringify(e)} ${t}`)}function F(e,t,i){if("exact"===e)return i.withHeight(t.height);if("min"===e){if(t.containsRect(i))return t;if(t.width<=i.width)return i.withHeight(t.height);let e=t.clone();return i.left<t.left?e=e.withX(i.x):i.right>t.right&&(e=t.withX(e.x+i.right-e.right)),i.bottom<t.top?e=e.withY(i.top):i.bottom>t.bottom&&(e=e.translateY(e.y+i.bottom-e.bottom)),e}return i.withHeight(t.height)}function M(e,t){if(1===t.length)return new S(t[0].x,t[0].y,t[0].width,e.height);const i=t.reduce(((e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),right:Math.max(e.right,t.right),bottom:0})),{x:Number.MAX_SAFE_INTEGER,y:Number.MAX_SAFE_INTEGER,right:0,bottom:0});return F("exact",e,new S(i.x,i.y,i.right-i.x,e.height))}function I(e,t){const i=s.al(e,t);return s.bA(s.Ue(),i,window.devicePixelRatio)}function U(e,t){const i=s.al(-t[0],-t[1]),r=o.Ue();return o.vc(r,t),o.bA(r,r,e),o.Iu(r,r,i),r}function N(e,t,i,r){const n=i.getConfigViewCursor(t,r),o=s.al(n[0],i.configView.y);return U(s.al(e,1),o)}function P(e,t){const i=s.al(e,t);return o.vc(o.Ue(),i)}function B(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.8,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;const h=s.al(e*n,t*a),l=o.U_(o.Ue(),i.fromConfigView(r.physicalSpace)),[c,f,d,m,u,p]=l,g=s.kK(s.Ue(),h,[c,f,d,m,u,p,0,0,0]);return P(g[0],g[1])}function Z(e,t,i,r,n,a){const h=I(e,t),l=a?s.$X(s.Ue(),h,i):s.$X(s.Ue(),i,h);if(0===l[0]&&0===l[1])return null;const c=o.U_(o.Ue(),r.fromConfigView(n.physicalSpace)),[f,d,m,u,p,g]=c,w=s.kK(s.Ue(),l,[f,d,m,u,p,g,0,0,0]);return o.vc(o.Ue(),w)}function k(e,t,i,r,n,a){const h=I(e,t),l=a?s.$X(s.Ue(),h,i):s.$X(s.Ue(),i,h);if(0===l[0]&&0===l[1])return null;const c=o.U_(o.Ue(),r.fromConfigSpace(n.physicalSpace)),[f,d,m,u,p,g]=c,w=s.kK(s.Ue(),l,[f,d,m,u,p,g,0,0,0]);return o.vc(o.Ue(),w)}function D(e,t,i){return e&&t?Math.min(Math.abs(e.left-t[0]),Math.abs(e.right-t[0]))<=i?"ew-resize":e.contains(t)?"grab":"col-resize":"col-resize"}function H(e,t,i,r){const[o,s]=(0,n.useState)(S.Empty());return(0,n.useLayoutEffect)((()=>{if(!i||!e.length)return;if(e.some((e=>null===e)))return;const n=g(e,(e=>{const n=e[0].contentRect??e[0].target.getBoundingClientRect();s(new S(n.x,n.y,n.width,n.height)),i.initPhysicalSpace(),r&&r.resizeConfigSpace(i),t.drawSync()}));return()=>{n.disconnect()}}),[e,i,r,t]),o}},"./app/utils/profiling/renderers/flamegraphRenderer.tsx":(e,t,i)=>{i.d(t,{o:()=>o,r:()=>n});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js");i("../node_modules/core-js/modules/es.array.push.js");const n={colorCoding:"by symbol name",draw_border:!1};class o{constructor(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;(0,r.Z)(this,"canvas",void 0),(0,r.Z)(this,"flamegraph",void 0),(0,r.Z)(this,"theme",void 0),(0,r.Z)(this,"options",void 0),(0,r.Z)(this,"frames",void 0),(0,r.Z)(this,"roots",void 0),(0,r.Z)(this,"colorBuffer",void 0),(0,r.Z)(this,"colorMap",void 0),this.canvas=e,this.flamegraph=t,this.theme=i,this.options=o,this.frames=this.flamegraph.frames,this.roots=this.flamegraph.root.children;const{colorBuffer:s,colorMap:a}=this.theme.COLORS.STACK_TO_COLOR(this.frames,this.theme.COLORS.COLOR_MAPS[this.options.colorCoding],this.theme.COLORS.COLOR_BUCKET);this.colorBuffer=s,this.colorMap=a}getColorForFrame(e){return this.colorMap.get(e.key)??this.theme.COLORS.FRAME_GRAYSCALE_COLOR}findHoveredNode(e){if(e[1]>this.flamegraph.configSpace.bottom+1)return null;if(e[0]<this.flamegraph.configSpace.left)return null;if(e[0]>this.flamegraph.configSpace.right)return null;let t=null;const i=[...this.roots];for(;i.length&&!t;){const r=i.pop();if(!(e[0]<r.start||e[0]>r.end)){if(e[1]>=r.depth&&e[1]<=r.depth+1){t=r;break}for(let e=0;e<r.children.length;e++)i.push(r.children[e])}}return t}}},"./app/utils/profiling/renderers/flamegraphTextRenderer.tsx":(e,t,i)=>{i.d(t,{G:()=>a});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(i("../node_modules/core-js/modules/es.array.push.js"),i("./app/utils/profiling/gl/utils.ts")),o=i("./app/utils/profiling/renderers/textRenderer.tsx"),s=i("./app/utils/profiling/flamegraphFrame.tsx");class a extends o.t{constructor(e,t,i){super(e,t),(0,r.Z)(this,"flamegraph",void 0),this.canvas=e,this.theme=t,this.flamegraph=i,this.textCache={},this.context=(0,n.fw)(e,"2d"),(0,n.Lo)(e)}draw(e,t,i){const r=this.theme.SIZES.BAR_FONT_SIZE*window.devicePixelRatio;this.context.font=`${r}px ${this.theme.FONTS.FRAME_FONT}`,this.context.textBaseline="alphabetic",this.maybeInvalidateCache();const o=this.measureAndCacheText(n.dH).width,a=2*this.theme.SIZES.BAR_PADDING*window.devicePixelRatio,h=a/2,l=(this.theme.SIZES.BAR_HEIGHT-this.theme.SIZES.BAR_FONT_SIZE/2)*window.devicePixelRatio,c=`rgb(${this.theme.COLORS.HIGHLIGHTED_LABEL_COLOR.join(", ")})`,f=e.top-1,d=e.bottom+1,m=i&&i.size>0,u=r/2-l,p=(0,n.e)(e.left,this.flamegraph.root.children),g=(0,n.G)(e.right,this.flamegraph.root.children),w=this.flamegraph.root.children.slice(p,g);for(;w.length>0;){const p=w.pop();if(p.depth>d)continue;const g=Math.max(p.start,e.left),_=Math.min(p.end,e.right),S=(_-g)*t[0]+t[3],x=S-a;if(x<=o)continue;const C=(0,n.G)(e.right,p.children);for(let t=(0,n.e)(e.left,p.children);t<C;t++)w.push(p.children[t]);if(p.depth<f)continue;const R=(_-g)*t[1]+t[4],b=g*t[0]+p.depth*t[3]+t[6],O=g*t[1]+p.depth*t[4]+t[7]+(R<0?R:0)+l,E=b+(S<0?S:0)+h,v=(0,n.B2)(p.frame.name,(0,n.fd)({low:0,high:x},(e=>this.measureAndCacheText(p.frame.name.substring(0,e)).width),x)[0]);if(m){const e=(0,s.M)(p),t=i.get(e);if(t){this.context.fillStyle=c;for(let e=0;e<t.match.length;e++){const i=(0,n.U_)(t.match[e],v),o=v.text.slice(0,i[0]),s=this.measureAndCacheText(v.text.substring(i[0],i[1])).width;this.context.fillRect(E+this.measureAndCacheText(o).width,O+u,s,r)}}}this.context.fillStyle=this.theme.COLORS.LABEL_FONT_COLOR,this.context.fillText(v.text,E,O)}}}},"./app/utils/profiling/renderers/textRenderer.tsx":(e,t,i)=>{i.d(t,{t:()=>s});var r=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=i("./app/utils/profiling/gl/utils.ts");const o="Who knows if this changed, font-display: swap wont tell me";class s{constructor(e,t){(0,r.Z)(this,"canvas",void 0),(0,r.Z)(this,"theme",void 0),(0,r.Z)(this,"context",void 0),(0,r.Z)(this,"textCache",void 0),this.canvas=e,this.theme=t,this.textCache={},this.context=(0,n.fw)(e,"2d"),(0,n.Lo)(e)}measureAndCacheText(e){return this.textCache[e]||(this.textCache[e]=this.context.measureText(e)),this.textCache[e]}maybeInvalidateCache(){if(void 0===this.textCache[o])return void this.measureAndCacheText(o);const e=this.context.measureText(o);e!==this.textCache[o]&&(this.textCache={[o]:e})}}}}]);
//# sourceMappingURL=../sourcemaps/app_components_profiling_flamegraph_flamegraphTooltip_tsx-app_utils_profiling_canvasScheduler-e4bf3f.38f57b5cf3da9feb1ba8d305ef438b4b.js.map