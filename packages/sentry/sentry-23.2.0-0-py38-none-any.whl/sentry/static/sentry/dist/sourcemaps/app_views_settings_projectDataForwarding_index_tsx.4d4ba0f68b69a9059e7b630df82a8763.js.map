{"version":3,"file":"chunks/app_views_settings_projectDataForwarding_index_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/inactivePlugins.tsx","webpack:///./app/components/pluginList.tsx","webpack:///./app/views/settings/project/permissionAlert.tsx","webpack:///./app/views/settings/projectDataForwarding/index.tsx"],"sourcesContent":["import styled from '@emotion/styled';\n\nimport {Panel, PanelBody, PanelHeader} from 'sentry/components/panels';\nimport TextOverflow from 'sentry/components/textOverflow';\nimport {t} from 'sentry/locale';\nimport PluginIcon from 'sentry/plugins/components/pluginIcon';\nimport {space} from 'sentry/styles/space';\nimport {Plugin} from 'sentry/types';\n\ntype Props = {\n  onEnablePlugin: (plugin: Plugin) => void;\n  plugins: Plugin[];\n};\n\nconst InactivePlugins = ({plugins, onEnablePlugin}: Props) => {\n  if (plugins.length === 0) {\n    return null;\n  }\n\n  return (\n    <Panel>\n      <PanelHeader>{t('Inactive Integrations')}</PanelHeader>\n\n      <PanelBody>\n        <Plugins>\n          {plugins.map(plugin => (\n            <IntegrationButton\n              key={plugin.id}\n              onClick={() => onEnablePlugin(plugin)}\n              className={`ref-plugin-enable-${plugin.id}`}\n            >\n              <Label>\n                <StyledPluginIcon pluginId={plugin.id} />\n                <TextOverflow>{plugin.shortName || plugin.name}</TextOverflow>\n              </Label>\n            </IntegrationButton>\n          ))}\n        </Plugins>\n      </PanelBody>\n    </Panel>\n  );\n};\n\nconst Plugins = styled('div')`\n  display: flex;\n  padding: ${space(1)};\n  flex: 1;\n  flex-wrap: wrap;\n`;\n\nconst IntegrationButton = styled('button')`\n  margin: ${space(1)};\n  width: 175px;\n  text-align: center;\n  font-size: ${p => p.theme.fontSizeSmall};\n  color: #889ab0;\n  letter-spacing: 0.1px;\n  font-weight: 600;\n  text-transform: uppercase;\n  border: 1px solid #eee;\n  background: inherit;\n  border-radius: ${p => p.theme.borderRadius};\n  padding: 10px;\n\n  &:hover {\n    border-color: #ccc;\n  }\n`;\n\nconst Label = styled('div')`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst StyledPluginIcon = styled(PluginIcon)`\n  margin-right: ${space(1)};\n`;\n\nexport default InactivePlugins;\n","import {disablePlugin, enablePlugin} from 'sentry/actionCreators/plugins';\nimport InactivePlugins from 'sentry/components/inactivePlugins';\nimport {Panel, PanelItem} from 'sentry/components/panels';\nimport PluginConfig from 'sentry/components/pluginConfig';\nimport {t} from 'sentry/locale';\nimport {Organization, Plugin, Project} from 'sentry/types';\n\ntype Props = {\n  organization: Organization;\n  pluginList: Plugin[];\n  project: Project;\n  onDisablePlugin?: (plugin: Plugin) => void;\n  onEnablePlugin?: (plugin: Plugin) => void;\n};\n\nconst PluginList = ({\n  organization,\n  project,\n  pluginList,\n  onDisablePlugin = () => {},\n  onEnablePlugin = () => {},\n}: Props) => {\n  const handleEnablePlugin = (plugin: Plugin) => {\n    enablePlugin({\n      projectId: project.slug,\n      orgId: organization.slug,\n      pluginId: plugin.slug,\n    });\n\n    onEnablePlugin(plugin);\n  };\n\n  const handleDisablePlugin = (plugin: Plugin) => {\n    disablePlugin({\n      projectId: project.slug,\n      orgId: organization.slug,\n      pluginId: plugin.slug,\n    });\n\n    onDisablePlugin(plugin);\n  };\n\n  if (!pluginList.length) {\n    return (\n      <Panel>\n        <PanelItem>\n          {t(\"Oops! Looks like there aren't any available integrations installed.\")}\n        </PanelItem>\n      </Panel>\n    );\n  }\n\n  return (\n    <div>\n      {pluginList\n        .filter(p => p.enabled)\n        .map(data => (\n          <PluginConfig\n            data={data}\n            organization={organization}\n            project={project}\n            key={data.id}\n            onDisablePlugin={handleDisablePlugin}\n          />\n        ))}\n\n      <InactivePlugins\n        plugins={pluginList.filter(p => !p.enabled && !p.isHidden)}\n        onEnablePlugin={handleEnablePlugin}\n      />\n    </div>\n  );\n};\n\nexport default PluginList;\n","import Access from 'sentry/components/acl/access';\nimport {Alert} from 'sentry/components/alert';\nimport {t} from 'sentry/locale';\n\ntype Props = React.ComponentPropsWithoutRef<typeof Alert> &\n  Pick<React.ComponentProps<typeof Access>, 'access'>;\n\nconst PermissionAlert = ({access = ['project:write'], ...props}: Props) => (\n  <Access access={access}>\n    {({hasAccess}) =>\n      !hasAccess && (\n        <Alert data-test-id=\"project-permission-alert\" type=\"warning\" {...props}>\n          {t(\n            'These settings can only be edited by users with the organization owner, manager, or admin role.'\n          )}\n        </Alert>\n      )\n    }\n  </Access>\n);\n\nexport default PermissionAlert;\n","import {Fragment} from 'react';\nimport {RouteComponentProps} from 'react-router';\n\nimport Feature from 'sentry/components/acl/feature';\nimport FeatureDisabled from 'sentry/components/acl/featureDisabled';\nimport {Alert} from 'sentry/components/alert';\nimport AsyncComponent from 'sentry/components/asyncComponent';\nimport MiniBarChart from 'sentry/components/charts/miniBarChart';\nimport EmptyMessage from 'sentry/components/emptyMessage';\nimport ExternalLink from 'sentry/components/links/externalLink';\nimport {Panel, PanelBody, PanelHeader} from 'sentry/components/panels';\nimport PluginList from 'sentry/components/pluginList';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\nimport {t, tct} from 'sentry/locale';\nimport {Organization, Plugin, Project, TimeseriesValue} from 'sentry/types';\nimport {Series} from 'sentry/types/echarts';\nimport withOrganization from 'sentry/utils/withOrganization';\nimport SettingsPageHeader from 'sentry/views/settings/components/settingsPageHeader';\nimport TextBlock from 'sentry/views/settings/components/text/textBlock';\nimport PermissionAlert from 'sentry/views/settings/project/permissionAlert';\n\ntype StatProps = {\n  params: {\n    orgId: string;\n    projectId: string;\n  };\n};\n\ntype StatState = AsyncComponent['state'] & {\n  stats: TimeseriesValue[];\n};\n\nclass DataForwardingStats extends AsyncComponent<StatProps, StatState> {\n  getEndpoints(): ReturnType<AsyncComponent['getEndpoints']> {\n    const {orgId, projectId} = this.props.params;\n    const until = Math.floor(new Date().getTime() / 1000);\n    const since = until - 3600 * 24 * 30;\n\n    const options = {\n      query: {\n        since,\n        until,\n        resolution: '1d',\n        stat: 'forwarded',\n      },\n    };\n\n    return [['stats', `/projects/${orgId}/${projectId}/stats/`, options]];\n  }\n\n  renderBody() {\n    const {projectId} = this.props.params;\n    const {stats} = this.state;\n    const series: Series = {\n      seriesName: t('Forwarded'),\n      data: stats.map(([timestamp, value]) => ({name: timestamp * 1000, value})),\n    };\n    const forwardedAny = series.data.some(({value}) => value > 0);\n\n    return (\n      <Panel>\n        <SentryDocumentTitle title={t('Data Forwarding')} projectSlug={projectId} />\n        <PanelHeader>{t('Forwarded events in the last 30 days (by day)')}</PanelHeader>\n        <PanelBody withPadding>\n          {forwardedAny ? (\n            <MiniBarChart\n              isGroupedByDate\n              showTimeInTooltip\n              labelYAxisExtents\n              series={[series]}\n              height={150}\n            />\n          ) : (\n            <EmptyMessage\n              title={t('Nothing forwarded in the last 30 days.')}\n              description={t('Total events forwarded to third party integrations.')}\n            />\n          )}\n        </PanelBody>\n      </Panel>\n    );\n  }\n}\n\ntype Props = RouteComponentProps<{projectId: string}, {}> & {\n  organization: Organization;\n  project: Project;\n};\n\ntype State = AsyncComponent['state'] & {\n  plugins: Plugin[];\n};\n\nclass ProjectDataForwarding extends AsyncComponent<Props, State> {\n  getEndpoints(): ReturnType<AsyncComponent['getEndpoints']> {\n    const {organization} = this.props;\n    const {projectId} = this.props.params;\n\n    return [['plugins', `/projects/${organization.slug}/${projectId}/plugins/`]];\n  }\n\n  get forwardingPlugins() {\n    return this.state.plugins.filter(\n      p => p.type === 'data-forwarding' && p.hasConfiguration\n    );\n  }\n\n  updatePlugin(plugin: Plugin, enabled: boolean) {\n    const plugins = this.state.plugins.map(p => ({\n      ...p,\n      enabled: p.id === plugin.id ? enabled : p.enabled,\n    }));\n\n    this.setState({plugins});\n  }\n\n  onEnablePlugin = (plugin: Plugin) => this.updatePlugin(plugin, true);\n  onDisablePlugin = (plugin: Plugin) => this.updatePlugin(plugin, false);\n\n  renderBody() {\n    const {organization, project} = this.props;\n    const plugins = this.forwardingPlugins;\n    const hasAccess = organization.access.includes('project:write');\n    const params = {...this.props.params, orgId: organization.slug};\n\n    const pluginsPanel =\n      plugins.length > 0 ? (\n        <PluginList\n          organization={organization}\n          project={project}\n          pluginList={plugins}\n          onEnablePlugin={this.onEnablePlugin}\n          onDisablePlugin={this.onDisablePlugin}\n        />\n      ) : (\n        <Panel>\n          <EmptyMessage\n            title={t('There are no integrations available for data forwarding')}\n          />\n        </Panel>\n      );\n\n    return (\n      <div data-test-id=\"data-forwarding-settings\">\n        <Feature\n          features={['projects:data-forwarding']}\n          hookName=\"feature-disabled:data-forwarding\"\n        >\n          {({hasFeature, features}) => (\n            <Fragment>\n              <SettingsPageHeader title={t('Data Forwarding')} />\n              <TextBlock>\n                {tct(\n                  `Data Forwarding allows processed events to be sent to your\n                favorite business intelligence tools. The exact payload and\n                types of data depend on the integration you're using. Learn\n                more about this functionality in our [link:documentation].`,\n                  {\n                    link: (\n                      <ExternalLink href=\"https://docs.sentry.io/product/data-management-settings/data-forwarding/\" />\n                    ),\n                  }\n                )}\n              </TextBlock>\n              <PermissionAlert />\n\n              <Alert showIcon>\n                {tct(\n                  `Sentry forwards [em:all applicable error events] to the provider, in\n                some cases this may be a significant volume of data.`,\n                  {\n                    em: <strong />,\n                  }\n                )}\n              </Alert>\n\n              {!hasFeature && (\n                <FeatureDisabled\n                  alert\n                  featureName={t('Data Forwarding')}\n                  features={features}\n                />\n              )}\n\n              <DataForwardingStats params={params} />\n              {hasAccess && hasFeature && pluginsPanel}\n            </Fragment>\n          )}\n        </Feature>\n      </div>\n    );\n  }\n}\n\nexport default withOrganization(ProjectDataForwarding);\n"],"names":["InactivePlugins","plugins","onEnablePlugin","length","t","Plugins","map","plugin","IntegrationButton","onClick","className","id","Label","StyledPluginIcon","pluginId","shortName","name","space","p","theme","fontSizeSmall","borderRadius","PluginIcon","PluginList","organization","project","pluginList","onDisablePlugin","handleDisablePlugin","disablePlugin","projectId","slug","orgId","filter","enabled","data","isHidden","enablePlugin","PermissionAlert","access","props","hasAccess","type","DataForwardingStats","AsyncComponent","getEndpoints","this","params","until","Math","floor","Date","getTime","query","since","resolution","stat","renderBody","stats","state","series","seriesName","timestamp","value","forwardedAny","some","title","projectSlug","withPadding","isGroupedByDate","showTimeInTooltip","labelYAxisExtents","height","description","ProjectDataForwarding","updatePlugin","forwardingPlugins","hasConfiguration","setState","includes","pluginsPanel","features","hookName","hasFeature","Fragment","tct","link","href","showIcon","em","alert","featureName","withOrganization"],"sourceRoot":""}