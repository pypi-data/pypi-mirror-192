"use strict";(self.webpackChunk_jupyrdf_jupyter_forcegraph=self.webpackChunk_jupyrdf_jupyter_forcegraph||[]).push([[681,627],{736:(e,t,n)=>{n.d(t,{Hm:()=>f,JW:()=>c,Y6:()=>s,_s:()=>_,af:()=>o,d:()=>g,fg:()=>a,kE:()=>d,vG:()=>l});var r=n(526),i=n(503);const s={E:Math.E,LN10:Math.LN10,LN2:Math.LN2,LOG10E:Math.LOG10E,LOG2E:Math.LOG2E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2},a=[Math.acos,Math.acosh,Math.asin,Math.asinh,Math.atan,Math.atanh,Math.cbrt,Math.ceil,Math.cos,Math.exp,Math.expm1,Math.floor,Math.fround,Math.log,Math.log10,Math.log1p,Math.log2,Math.sign,Math.sin,Math.sqrt,Math.tan,Math.trunc],o=[Math.imul,Math.atan2],l=[Math.min,Math.max];function d(e){return!isNaN(Number(e))}function h(){return null}var u;async function c(e){const t=await g();return new u.TemplateClass(e,t,null,!0)}async function g(){if(u.env)return u.env;if(u.loading)return await u.loading.promise,u.env;u.loading=new r.PromiseDelegate;const e=await n.e(327).then(n.t.bind(n,327,23)),t=new e.Environment;return function(e){for(const[t,n]of Object.entries(s))e.addGlobal(t,n);for(const t of a)e.addGlobal(t.name,t);for(const t of o)e.addGlobal(t.name,t);for(const t of l)e.addGlobal(t.name,m(t));e.addGlobal("now",(()=>performance.now())),e.addFilter("where",((e,t,n)=>{const r=[];for(const i of e)i[t]===n&&r.push(i);return r}))}(t),u.TemplateClass=e.Template,u.env=t,u.loading.resolve(t),t}function m(e){return function(t,...n){return Array.isArray(t)?e(...t):e(t,...n)}}async function p(e,t,n){let r;try{r=await c(e)}catch(e){return i.eM&&console.warn(i.Dd,e),h}return(e,s,a)=>{let o;try{let i=r.render({[t]:e,i:s,[n]:a});o=null==i?null:Number(i),(null==o||isNaN(o))&&(o=null)}catch(e){i.eM&&console.warn(i.Dd,e),o=null}return o}}async function _(e){return await p(e,"node","nodes")}async function f(e){return await p(e,"link","links")}!function(e){e.env=null,e.loading=null,e.TemplateClass=null}(u||(u={}))},681:(e,t,n)=>{n.r(t),n.d(t,{BehaviorModel:()=>o,CenterForceModel:()=>B,ClusterForceModel:()=>P,CollisionForceModel:()=>T,ColumnOrTemplateModel:()=>l,DataFrameSourceModel:()=>H,ForceBehaviorModel:()=>x,ForceGraph3DModel:()=>V,ForceGraph3DView:()=>I,ForceGraphModel:()=>J,ForceGraphView:()=>j,GraphDataModel:()=>u,GraphForcesModel:()=>z,GraphImageModel:()=>c,LinkColorModel:()=>g,LinkColumnOrTemplateModel:()=>h,LinkDirectionalArrowColorModel:()=>m,LinkDirectionalArrowLengthModel:()=>p,LinkDirectionalArrowRelPosModel:()=>_,LinkDirectionalParticleColorModel:()=>f,LinkDirectionalParticleSpeedModel:()=>k,LinkDirectionalParticleWidthModel:()=>w,LinkDirectionalParticlesModel:()=>C,LinkForceModel:()=>S,LinkLabelModel:()=>M,LinkSelectionModel:()=>v,LinkWidthModel:()=>y,ManyBodyForceModel:()=>W,NodeColorModel:()=>L,NodeColumnOrTemplateModel:()=>d,NodeLabelModel:()=>F,NodeSelectionModel:()=>D,NodeSizeModel:()=>N,RadialForceModel:()=>U,XForceModel:()=>E,YForceModel:()=>G,ZForceModel:()=>O});var r=n(840),i=n(647),s=n(736),a=n(503);class o extends i.WidgetModel{initialize(e,t){super.initialize(e,t),this._updateRequested=new r.Signal(this)}get updateRequested(){return this._updateRequested}}class l extends o{defaults(){return{...super.defaults(),...a.sB,column_name:null,template:null}}getColumnName(e){return this.get("column_name")||null}get template(){return this.get("template")||null}initialize(e,t){super.initialize(e,t),this.on("change:column_name",this.onColumnNameChange,this),this.on("change:template",this.onTemplateChange,this),this.onColumnNameChange(),this.onTemplateChange()}async onTemplateChange(){const{template:e}=this;if(null==e)this._nunjucksTemplate=null;else try{this._nunjucksTemplate=await(0,s.JW)(e)}catch(e){console.warn(a.Dd,e.message),this._nunjucksTemplate=null}this._updateRequested.emit(void 0)}onColumnNameChange(e){this._updateRequested.emit(void 0)}renderTemplate(e){const{_nunjucksTemplate:t}=this;if(null!=t)try{return t.render(e)}catch(e){console.warn(a.Dd,e)}}}class d extends l{getNodeAttr(e){let t=this.renderTemplate(e);if(null!=t)return t;const n=this.getColumnName(e.view);return null!=n&&(t=e.node[n]),t||null}}class h extends l{getLinkAttr(e){let t=this.renderTemplate(e);if(null!=t)return t;const n=this.getColumnName(e.view);return null!=n&&(t=e.link[n]),t||null}}class u extends o{constructor(){super(...arguments),this._sourcesToCapture=0}defaults(){return{...super.defaults(),...a.sB,_model_name:u.model_name,capturing:!1,source_count:1,sources:[]}}get sourceCount(){return this.get("source_count")}get capturing(){return this.get("capturing")}get sources(){return this.get("sources")}initialize(e,t){super.initialize(e,t),this.on("change:capturing",this.onCapturingChanged,this),this.onCapturingChanged()}onCapturingChanged(e){this._sourcesToCapture=this.capturing?this.sourceCount:0,this._sourcesToCapture&&this._updateRequested.emit(a.k$.Render)}onRender(e){const{_sourcesToCapture:t}=this;if(!t)return;const{sourceCount:n,sources:r}=this,i=n-t;this._sourcesToCapture-=1;let s=r[i];if(s.setFromGraphData(e.graphData),!this._sourcesToCapture){for(s of r)s.save();this.set({capturing:!1}),this.save()}}}u.model_name="GraphDataModel",u.serializers={...i.WidgetModel.serializers,sources:{deserialize:i.unpack_models}};class c extends o{constructor(){super(...arguments),this._framesToCapture=0,this.onBlob=async(e,t,n)=>{let r=this.frames[e];const i=new DataView(await n.arrayBuffer());if(r.set({value:i}),t){for(r of this.frames)r.save();this.set({capturing:!1}),this.save()}}}defaults(){return{...super.defaults(),...a.sB,_model_name:c.model_name,enabled:!1,frame_count:1,frames:[]}}get frameCount(){return this.get("frame_count")}get capturing(){return this.get("capturing")}get frames(){return this.get("frames")}initialize(e,t){super.initialize(e,t),this.on("change:capturing",this.onCapturingChanged,this),this.onCapturingChanged()}onCapturingChanged(e){this._framesToCapture=this.capturing?this.frameCount:0,this._framesToCapture&&this._updateRequested.emit(a.k$.Render)}onRender(e){const{_framesToCapture:t}=this;if(!t)return;const{frameCount:n}=this,r=n-t;this._framesToCapture-=1;const{context2d:i,renderer3d:s}=e;let o=null;i?o=i.canvas:s&&(o=s.domElement),null!=o?o.toBlob(this.onBlob.bind(this,r,0===this._framesToCapture)):console.warn(`${a.Dd} couldn't handle post render of`,e)}}c.model_name="GraphImageModel",c.serializers={...i.WidgetModel.serializers,frames:{deserialize:i.unpack_models}};class g extends h{defaults(){return{...super.defaults(),_model_name:g.model_name}}getLinkColor(e){return super.getLinkAttr(e)}}g.model_name="LinkColorModel";class m extends h{defaults(){return{...super.defaults(),_model_name:m.model_name}}getLinkDirectionalArrowColor(e){return super.getLinkAttr(e)}}m.model_name="LinkDirectionalArrowColorModel";class p extends h{defaults(){return{...super.defaults(),_model_name:p.model_name}}getLinkDirectionalArrowLength(e){return super.getLinkAttr(e)}}p.model_name="LinkDirectionalArrowLengthModel";class _ extends h{defaults(){return{...super.defaults(),_model_name:_.model_name}}getLinkDirectionalArrowRelPos(e){return super.getLinkAttr(e)}}_.model_name="LinkDirectionalArrowRelPosModel";class f extends h{defaults(){return{...super.defaults(),_model_name:f.model_name}}getLinkDirectionalParticleColor(e){return super.getLinkAttr(e)}}f.model_name="LinkDirectionalParticleColorModel";class k extends h{defaults(){return{...super.defaults(),_model_name:k.model_name}}getLinkDirectionalParticleSpeed(e){return super.getLinkAttr(e)}}k.model_name="LinkDirectionalParticleSpeedModel";class w extends h{defaults(){return{...super.defaults(),_model_name:w.model_name}}getLinkDirectionalParticleWidth(e){return super.getLinkAttr(e)}}w.model_name="LinkDirectionalParticleWidthModel";class C extends h{defaults(){return{...super.defaults(),_model_name:C.model_name}}getLinkDirectionalParticles(e){return super.getLinkAttr(e)}}C.model_name="LinkDirectionalParticlesModel";class M extends h{defaults(){return{...super.defaults(),_model_name:M.model_name}}getLinkLabel(e){return super.getLinkAttr(e)}}M.model_name="LinkLabelModel";class v extends o{constructor(){super(...arguments),this.onLinkClick=({index:e,event:t})=>{let{selected:n,multiple:r}=this;const i=n.has(e);return r&&(t.ctrlKey||t.shiftKey||t.altKey)?i?n.delete(e):n.add(e):(n.clear(),!i&&n.add(e)),this.selected=n,!0}}defaults(){return{...super.defaults(),...a.sB,_model_name:v.model_name,selected:[],selected_color:a._F.selected,selected_width:a.H8.selected,multiple:!0}}initialize(e,t){super.initialize(e,t),this.on("change:selected",this.onValueChange,this),this.onValueChange()}onValueChange(e){this._updateRequested.emit(void 0)}get selected(){return new Set([...this.get("selected")||[]])}set selected(e){this.set({selected:[...e]}),this.save_changes()}get selectedColor(){return this.get("selected_color")||a._F.selected}get selectedWidth(){return this.get("selected_width")||a.H8.selected}get multiple(){return this.get("multiple")}getLinkWidth({index:e}){return this.selected.has(e)?this.selectedWidth:null}getLinkColor({index:e}){return this.selected.has(e)?this.selectedColor:null}}v.model_name="LinkSelectionModel";class y extends h{defaults(){return{...super.defaults(),_model_name:y.model_name}}getLinkWidth(e){return super.getLinkAttr(e)}}y.model_name="LinkWidthModel";class L extends d{defaults(){return{...super.defaults(),_model_name:L.model_name}}getNodeColor(e){return super.getNodeAttr(e)}}L.model_name="NodeColorModel";class F extends d{defaults(){return{...super.defaults(),_model_name:F.model_name}}columnName(e){let t=super.getColumnName(e);if(null==t)try{t=e.source.get("node_id_column")}catch(e){console.error("failed to fetch id column",e)}return t||null}getNodeLabel(e){return super.getNodeAttr(e)}}F.model_name="NodeLabelModel";class N extends d{defaults(){return{...super.defaults(),_model_name:N.model_name}}columnName(e){return super.getColumnName(e)||null}getNodeSize(e){return super.getNodeAttr(e)}}N.model_name="NodeSizeModel";class D extends o{constructor(){super(...arguments),this.onNodeClick=({node:e,event:t})=>{let{selected:n,multiple:r}=this;const i=e.id,s=n.has(i);return r&&(t.ctrlKey||t.shiftKey||t.altKey)?s?n.delete(i):n.add(i):(n.clear(),!s&&n.add(i)),this.selected=n,!0}}defaults(){return{...super.defaults(),...a.sB,_model_name:D.model_name,selected:[],selected_color:a._F.selected,multiple:!0}}initialize(e,t){super.initialize(e,t),this.on("change:selected",this.onValueChange,this),this.onValueChange()}onValueChange(e){this._updateRequested.emit(void 0)}get selected(){return new Set([...this.get("selected")||[]])}set selected(e){this.set({selected:[...e]}),this.save_changes()}get selectedColor(){return this.get("selected_color")||a._F.selected}get multiple(){return this.get("multiple")}getNodeColor({node:e}){return this.selected.has(e.id)?this.selectedColor:null}}D.model_name="NodeSelectionModel";var b=n(765);class x extends h{defaults(){return{...super.defaults(),_model_name:x.model_name,active:!0}}initialize(e,t){super.initialize(e,t),this._force=this.forceFactory(),this.on(this.triggerChanges,this.onChanged,this)}async onChanged(e){this.active?(await this.update(),this._updateRequested.emit(void 0)):"active"in e.changed&&this._updateRequested.emit(void 0)}async update(){}forceFactory(){throw new Error("Not implemented")}get triggerChanges(){throw new Error("Not implemented")}get force(){return this._force}get active(){return this.get("active")}}x.model_name="ForceBehaviorModel";class z extends h{defaults(){return{...super.defaults(),_model_name:z.model_name,forces:{},warmup_ticks:0,cooldown_ticks:-1,alpha_min:0,alpha_decay:.228,velocity_decay:.4}}initialize(e,t){super.initialize(e,t),this.on("change:forces change:cooldown_ticks change:warmup_ticks change:alpha_min change:alpha_decay change:velocity_decay",this.onForcesChange,this),this.onForcesChange()}get forces(){return this.get("forces")||{}}async onForcesChange(){const{forces:e,previousForces:t}=this;for(const e of Object.values(t))e&&e.updateRequested.disconnect(this.onForceUpdated,this);for(const t of Object.values(e))t&&t.updateRequested.connect(this.onForceUpdated,this);this.onForceUpdated()}get previousForces(){return this.previous&&this.previous("forces")||{}}onForceUpdated(e){this._updateRequested.emit(a.k$.Reheat)}get warmupTicks(){return this.get("warmup_ticks")}get cooldownTicks(){const e=this.get("cooldown_ticks");return e<0?1/0:e}get alphaMin(){return this.get("alpha_min")}get alphaDecay(){return this.get("alpha_decay")}get velocityDecay(){return this.get("velocity_decay")}checkPositions(e){let{nodes:t,links:n}=e.graphData(),r=!1;for(let e of t)if(isNaN(e.x)||isNaN(e.y)){r=!0;break}if(r){for(let e of t)e.x=NaN,e.y=NaN,e.vx=NaN,e.vy=NaN;!function(e,t=2){let n=Math.min(3,Math.max(1,Math.round(t)));for(var r,i=Math.PI*(3-Math.sqrt(5)),s=20*Math.PI/(9+Math.sqrt(221)),a=0,o=e.length;a<o;++a){if((r=e[a]).index=a,null!=r.fx&&(r.x=r.fx),null!=r.fy&&(r.y=r.fy),null!=r.fz&&(r.z=r.fz),isNaN(r.x)||n>1&&isNaN(r.y)||n>2&&isNaN(r.z)){var l=10*(n>2?Math.cbrt(.5+a):n>1?Math.sqrt(.5+a):a),d=a*i,h=a*s;1===n?r.x=l:2===n?(r.x=l*Math.cos(d),r.y=l*Math.sin(d)):(r.x=l*Math.sin(d)*Math.cos(h),r.y=l*Math.cos(d),r.z=l*Math.sin(d)*Math.sin(h))}(isNaN(r.vx)||n>1&&isNaN(r.vy)||n>2&&isNaN(r.vz))&&(r.vx=0,n>1&&(r.vy=0),n>2&&(r.vz=0))}}(t),n.forEach((e=>{let n=e.source;n!==t[n.index]&&console.log("mismatch",n,t[n.index])}))}}}z.model_name="GraphForcesModel",z.serializers={...i.WidgetModel.serializers,forces:{deserialize:i.unpack_models}};class B extends x{defaults(){return{...super.defaults(),_model_name:B.model_name,x:null,y:null,z:null}}forceFactory(){return(0,b.forceCenter)()}get triggerChanges(){return"change:x change:y change:z change:active"}get force(){const{x:e,y:t,z:n}=this;let r=this._force;return r=null==e?r:r.x(e),r=null==t?r:r.y(t),r=null==n?r:r.z(n),r}get x(){return this.get("x")}get y(){return this.get("y")}get z(){return this.get("z")}}B.model_name="CenterForceModel";var A=n(967),R=n.n(A);class P extends x{constructor(){super(...arguments),this.centers=(e,t,n)=>{(null==e?void 0:e.radius)||(e.radius=1);let r=this.get_cluster(e,t,n);r in this.clusters||(this.clusters[r]={x:0,y:0,z:0,radius:0});let i=this.clusters[r];return isNaN(i.x)&&(i.x=0),isNaN(i.y)&&(i.y=0),isNaN(i.z)&&(i.z=0),(isNaN(i.radius)||null==i.radius)&&(i.radius=0),i}}defaults(){return{...super.defaults(),_model_name:P.model_name,x:null,strength:null}}initialize(e,t){super.initialize(e,t),this.clusters={},this.get_cluster=()=>0}forceFactory(){return R()()}get triggerChanges(){return"change:centers change:strength change:center_inertia change:active"}get force(){const{centers:e,strength:t,centerInertia:n}=this;let r=this._force;return r=null==n?r:r.centerInertia(n),r=null==e?r:r.centers(e),r=null==t?r:r.strength(t),r}async update(){await this.update_centers(),await this.update_strength()}async update_centers(){let e=this.get("centers");this.get_cluster=await(0,s._s)(e)}async update_strength(){let e=this.get("strength");(0,s.kE)(e)?this.strength=Number(e):this.strength=await(0,s._s)(e)}get centerInertia(){return this.get("center_inertia")}}P.model_name="ClusterForceModel";class T extends x{defaults(){return{...super.defaults(),_model_name:T.model_name,strength:null,radius:null}}forceFactory(){return(0,b.forceCollide)()}get force(){const{radius:e,strength:t}=this;let n=this._force;return n=null==e?n:n.radius(e),n=null==t?n:n.strength(t),n}get triggerChanges(){return"change:radius change:strength change:active"}async update(){await this.update_radius(),await this.update_strength()}async update_strength(){let e=this.get("strength");(0,s.kE)(e)?this.strength=Number(e):this.strength=await(0,s._s)(e)}async update_radius(){let e=this.get("radius");(0,s.kE)(e)?this.radius=Number(e):this.radius=await(0,s._s)(e)}}T.model_name="CollisionForceModel";class S extends x{defaults(){return{...super.defaults(),_model_name:S.model_name,strength:null,distance:null}}forceFactory(){return(0,b.forceLink)()}get force(){const{strength:e,distance:t}=this;let n=this._force;return n=null==e?n:n.strength(e),n=null==t?n:n.distance(t),n}get triggerChanges(){return"change:strength change:distance change:active"}async update(){await this.update_distance(),await this.update_strength()}async update_strength(){let e=this.get("strength");(0,s.kE)(e)?this.strength=Number(e):this.strength=await(0,s.Hm)(e)}async update_distance(){let e=this.get("distance");(0,s.kE)(e)?this.distance=Number(e):this.distance=await(0,s.Hm)(e)}}S.model_name="LinkForceModel";class W extends x{defaults(){return{...super.defaults(),_model_name:W.model_name}}forceFactory(){return(0,b.forceManyBody)()}get force(){const{strength:e,theta:t,distanceMax:n,distanceMin:r}=this;let i=this._force;return i=null==e?i:i.strength(e),i=null==t?i:i.theta(t),i=null==n?i:i.distanceMax(n),i=null==r?i:i.distanceMin(r),i}get triggerChanges(){return"change:strength change:theta change:distance_min change:distance_max change:active"}async update(){await this.update_strength()}async update_strength(){let e=this.get("strength");(0,s.kE)(e)?this.strength=Number(e):this.strength=await(0,s._s)(e)}get theta(){return this.get("theta")}get distanceMin(){return this.get("distance_min")}get distanceMax(){return this.get("distance_max")}}W.model_name="ManyBodyForceModel";class U extends x{defaults(){return{...super.defaults(),_model_name:U.model_name}}forceFactory(){return(0,b.forceRadial)()}get force(){const{strength:e,radius:t,x:n,y:r,z:i}=this;let s=this._force;return s=null==e?s:s.strength(e),s=null==t?s:s.radius(this.radius),s=null==n?s:s.x(n),s=null==r?s:s.y(r),s=null==i?s:s.z(i),s}get triggerChanges(){return"change:strength change:radius change:x change:y change:z change:active"}async update(){await this.update_radius()}get strength(){return this.get("strength")}async update_radius(){let e=this.get("radius");(0,s.kE)(e)?this.radius=Number(e):this.radius=await(0,s._s)(e)}get x(){return this.get("x")}get y(){return this.get("y")}get z(){return this.get("z")}}U.model_name="RadialForceModel";class E extends x{defaults(){return{...super.defaults(),_model_name:E.model_name,x:null,strength:null}}forceFactory(){return(0,b.forceX)()}get triggerChanges(){return"change:x change:strength change:active"}get force(){const{x:e,strength:t}=this;let n=this._force;return n=null==e?n:n.x(e),n=null==t?n:n.strength(t),n}async update(){await this.update_x(),await this.update_strength()}async update_x(){let e=this.get("x");(0,s.kE)(e)?this.x=Number(e):this.x=await(0,s._s)(e)}async update_strength(){let e=this.get("strength");(0,s.kE)(e)?this.strength=Number(e):this.strength=await(0,s._s)(e)}}E.model_name="XForceModel";class G extends x{defaults(){return{...super.defaults(),_model_name:b.forceY.model_name,y:null}}forceFactory(){return(0,b.forceY)()}get triggerChanges(){return"change:y change:strength change:active"}get force(){const{y:e,strength:t}=this;let n=this._force;return n=null==e?n:n.y(e),n=null==t?n:n.strength(t),n}async update(){await this.update_y(),await this.update_strength()}async update_y(){let e=this.get("y");(0,s.kE)(e)?this.y=Number(e):this.y=await(0,s._s)(e)}async update_strength(){let e=this.get("strength");(0,s.kE)(e)?this.strength=Number(e):this.strength=await(0,s._s)(e)}}G.model_name="YForceModel";class O extends x{defaults(){return{...super.defaults(),_model_name:O.model_name,z:null}}forceFactory(){return(0,b.forceZ)()}get triggerChanges(){return"change:z change:strength change:active"}get force(){const{z:e,strength:t}=this;let n=this._force;return n=null==e?n:n.z(e),n=null==t?n:n.strength(t),n}async update(){await this.update_z(),await this.update_strength()}async update_z(){let e=this.get("z");(0,s.kE)(e)?this.z=Number(e):this.z=await(0,s._s)(e)}async update_strength(){let e=this.get("strength");(0,s.kE)(e)?this.strength=Number(e):this.strength=await(0,s._s)(e)}}O.model_name="ZForceModel";var q=n(526);class J extends i.DOMWidgetModel{defaults(){return{...super.defaults(),...a.sB,_model_name:J.model_name,_view_name:j.view_name,source:null,behaviors:[],background_color:a._F.background,default_link_color:a._F.link,default_link_width:a.H8.link,default_node_color:a._F.node,default_node_size:a.H8.node}}initialize(e,t){super.initialize(e,t),this.on("change:behaviors",this.onBehaviorsChange,this),this.onBehaviorsChange()}onBehaviorsChange(){this._behaviorsChanged||(this._behaviorsChanged=new r.Signal(this),this._linkBehaviorsByMethod=new Map,this._nodeBehaviorsByMethod=new Map,this._graphBehaviorsByMethod=new Map);const{behaviors:e}=this;for(let t of a.wN){let n=[];for(const r of e)r[t]&&n.push(r);this._linkBehaviorsByMethod.set(t,n)}for(let t of a.l_){let n=[];for(const r of e)r[t]&&n.push(r);this._nodeBehaviorsByMethod.set(t,n)}for(let t of a.QP){let n=[];for(const r of e)r[t]&&n.push(r);this._graphBehaviorsByMethod.set(t,n)}this._forceBehaviors=[];for(const t of e)t instanceof z&&this._forceBehaviors.push(t);this._behaviorsChanged.emit(void 0)}linkBehaviorsForMethod(e){return this._linkBehaviorsByMethod.get(e)||a.ow}nodeBehaviorsForMethod(e){return this._nodeBehaviorsByMethod.get(e)||a.ow}graphBehaviorsForMethod(e){return this._graphBehaviorsByMethod.get(e)||a.ow}get forceBehaviors(){return this._forceBehaviors}get graphData(){const e=this.get("source");return e?e.graphData:a.tM}get behaviors(){return this.get("behaviors")||[]}get behaviorsChanged(){return this._behaviorsChanged}get previousBehaviors(){return this.previous&&this.previous("behaviors")||[]}get defaultNodeColor(){return this.get("default_node_color")||a._F.node}get defaultNodeSize(){return this.get("default_node_size")||a.H8.node}get defaultLinkColor(){return this.get("default_link_color")||a._F.link}get defaultLinkWidth(){return this.get("default_link_width")||a.H8.link}get backgroundColor(){return this.get("background_color")||a._F.background}}J.model_name="ForceGraphModel",J.serializers={...i.DOMWidgetModel.serializers,source:{deserialize:i.unpack_models},behaviors:{deserialize:i.unpack_models}};class j extends i.DOMWidgetView{constructor(){super(...arguments),this.onFrameLoaded=async e=>{const t=e.currentTarget,{contentWindow:n}=t,r=n.init();this.graph=r,n.addEventListener("resize",this.onWindowResize),this._rendered.resolve(void 0),await this.redraw()},this.onWindowResize=()=>{const{contentWindow:e}=this._iframe,t=this.graph;t.width(e.innerWidth),t.height(e.innerHeight)},this.postForceUpdate=e=>{const{links:t}=this.graph.graphData();if(!t.length)return;const n=typeof t[0].source;if("string"===n||"number"===n)return setTimeout(this.postForceUpdate,250,e),void(a.eM&&console.log("Polling postForceUpdate..."));for(let n of e)n.links&&n.links(t)},this.getLinkColor=e=>this.getComposedLinkAttr(e,"getLinkColor",this.model.defaultLinkColor),this.getLinkWidth=e=>this.getComposedLinkAttr(e,"getLinkWidth",this.model.defaultLinkWidth),this.getLinkLabel=e=>this.getComposedLinkAttr(e,"getLinkLabel",""),this.getLinkDirectionalArrowColor=e=>this.getComposedLinkAttr(e,"getLinkDirectionalArrowColor",""),this.getLinkDirectionalArrowLength=e=>this.castToNumber(this.getComposedLinkAttr(e,"getLinkDirectionalArrowLength","")),this.getLinkDirectionalArrowRelPos=e=>this.castToNumber(this.getComposedLinkAttr(e,"getLinkDirectionalArrowRelPos","")),this.getLinkDirectionalParticleColor=e=>this.getComposedLinkAttr(e,"getLinkDirectionalParticleColor",""),this.getLinkDirectionalParticleSpeed=e=>this.castToNumber(this.getComposedLinkAttr(e,"getLinkDirectionalParticleSpeed","")),this.getLinkDirectionalParticleWidth=e=>this.castToNumber(this.getComposedLinkAttr(e,"getLinkDirectionalParticleWidth","")),this.getLinkDirectionalParticles=e=>this.castToNumber(this.getComposedLinkAttr(e,"getLinkDirectionalParticles","")),this.getNodeColor=e=>this.getComposedNodeAttr(e,"getNodeColor",this.model.defaultNodeColor),this.getNodeLabel=e=>this.getComposedNodeAttr(e,"getNodeLabel",""),this.getNodeSize=e=>this.getComposedNodeAttr(e,"getNodeSize",this.model.defaultNodeSize),this.onNodeClick=(e,t)=>{let n=!0;const r={view:this,graphData:this.graph.graphData(),event:t,node:e};for(const e of this.model.nodeBehaviorsForMethod("onNodeClick"))if(n=e.onNodeClick(r),!n)return},this.onLinkClick=(e,t)=>{const n=this.graph.graphData();let r=!0;const i={view:this,graphData:n,event:t,link:e,index:n.links.indexOf(e)};for(const e of this.model.linkBehaviorsForMethod("onLinkClick"))if(r=e.onLinkClick(i),!r)return},this.onRender=(e,t)=>{let n={view:this,graphData:this.graph.graphData(),context2d:e,globalScale:t};n=this.updateRenderOptions(n);for(const e of this.model.graphBehaviorsForMethod("onRender"))e.onRender(n)}}get source(){return this.model.get("source")}get previousSource(){return this.model.previous&&this.model.previous("source")||null}get rendered(){return this._rendered.promise}initialize(e){super.initialize(e),this.luminoWidget.addClass(a.ux.widget),this.luminoWidget.addClass(`${a.ux.widget}-${this.graphJsClass}`),this._rendered=new q.PromiseDelegate,this.model.on("change:source",this.onSourceChange,this),this.model.on("change:default_node_color change:default_link_color change:background_color change:default_node_size change:default_link_width",this.postUpdate,this),this.model.behaviorsChanged.connect(this.onBehaviorsChange,this),this.luminoWidget.disposed.connect(this.onDisposed,this),this.onSourceChange(),this.onBehaviorsChange()}onDisposed(){this.graph&&(this.graph._destructor(),delete this.graph,this.graph=null),this._iframe&&(this._iframe.removeEventListener("resize",this.onWindowResize),this._iframe.onload=null,delete this._iframe,this._iframe=null),this.luminoWidget.disposed.disconnect(this.onDisposed)}async render(){const e=this.el,t=document.createElement("iframe"),n=await this.getIframeSource();t.setAttribute("srcdoc",n),t.onload=this.onFrameLoaded,e.appendChild(t),this._iframe=t}async getJsUrl(){return(await n.e(460).then(n.bind(n,460))).default}get graphJsClass(){return"ForceGraph"}async getIframeSource(){return`\n      <head>\n        <script src="${await this.getJsUrl()}"><\/script>\n        <style>\n          body, #main {\n            overflow: hidden;\n            position: absolute;\n            left: 0;\n            top: 0;\n            right: 0;\n            bottom: 0;\n            margin: 0;\n            padding: 0;\n          }\n        </style>\n      </head>\n      <body>\n        <script>\n          window.process = {\n            env: {\n              NODE_ENV: '${a.eM?"development":"production"}'\n            }\n          };\n          window.init = (args) => {\n            const div = document.createElement('div');\n            document.body.appendChild(div);\n            return ${this.graphJsClass}(args || {})(div);\n          }\n          window.wrapFunction = (fn) => {\n            return (...args) => fn(...args);\n          }\n        <\/script>\n      </body>\n    `}async redraw(){await this._rendered.promise;let{graphData:e}=this.model;a.eM&&console.warn(`${a.Dd} updating...`,e),await this.postUpdate(),this.graph.graphData(e)}wrapFunction(e){return this._iframe.contentWindow.wrapFunction(e)}onSourceChange(e){const{source:t,previousSource:n}=this;n&&n.dataUpdated.disconnect(this.redraw,this),t&&(t.dataUpdated.connect(this.redraw,this),this.redraw())}async postUpdate(e,t){await this.rendered;const n=this.graph;if(!n)return void console.warn(`${a.Dd} no graph to postUpdate`);const{backgroundColor:r,defaultLinkColor:i,defaultNodeColor:s,defaultLinkWidth:o,defaultNodeSize:l}=this.model;n.backgroundColor(r),n.linkColor(this.model.linkBehaviorsForMethod("getLinkColor").length?this.wrapFunction(this.getLinkColor):this.wrapFunction((()=>i))),n.linkWidth(this.model.linkBehaviorsForMethod("getLinkWidth").length?this.wrapFunction(this.getLinkWidth):this.wrapFunction((()=>o))),n.linkLabel(this.model.linkBehaviorsForMethod("getLinkLabel").length?this.wrapFunction(this.getLinkLabel):null),n.linkDirectionalArrowColor(this.model.linkBehaviorsForMethod("getLinkDirectionalArrowColor").length?this.wrapFunction(this.getLinkDirectionalArrowColor):null),n.linkDirectionalArrowLength(this.model.linkBehaviorsForMethod("getLinkDirectionalArrowLength").length?this.wrapFunction(this.getLinkDirectionalArrowLength):null),n.linkDirectionalArrowRelPos(this.model.linkBehaviorsForMethod("getLinkDirectionalArrowRelPos").length?this.wrapFunction(this.getLinkDirectionalArrowRelPos):null),n.linkDirectionalParticleColor(this.model.linkBehaviorsForMethod("getLinkDirectionalParticleColor").length?this.wrapFunction(this.getLinkDirectionalParticleColor):null),n.linkDirectionalParticleSpeed(this.model.linkBehaviorsForMethod("getLinkDirectionalParticleSpeed").length?this.wrapFunction(this.getLinkDirectionalParticleSpeed):null),n.linkDirectionalParticleWidth(this.model.linkBehaviorsForMethod("getLinkDirectionalParticleWidth").length?this.wrapFunction(this.getLinkDirectionalParticleWidth):null),n.linkDirectionalParticles(this.model.linkBehaviorsForMethod("getLinkDirectionalParticles").length?this.wrapFunction(this.getLinkDirectionalParticles):null),n.nodeColor(this.model.nodeBehaviorsForMethod("getNodeColor").length?this.wrapFunction(this.getNodeColor):this.wrapFunction((()=>s))),n.nodeVal(this.model.nodeBehaviorsForMethod("getNodeSize").length?this.wrapFunction(this.getNodeSize):this.wrapFunction((()=>l))),n.nodeLabel(this.model.nodeBehaviorsForMethod("getNodeLabel").length?this.wrapFunction(this.getNodeLabel):null),n.onNodeClick(this.model.nodeBehaviorsForMethod("onNodeClick").length?this.wrapFunction(this.onNodeClick):null),n.onLinkClick(this.model.linkBehaviorsForMethod("onLinkClick").length?this.wrapFunction(this.onLinkClick):null),this.getForceUpdate(),this.getOnRenderPostUpdate(),t&&a.k$.Reheat===(t&a.k$.Reheat)&&n.d3ReheatSimulation()}getForceUpdate(){const e=this.graph;let t=[];for(let n of this.model.forceBehaviors){const{warmupTicks:r,cooldownTicks:i,alphaDecay:s,alphaMin:a,velocityDecay:o}=n;n.checkPositions(e),e.cooldownTicks(i),e.warmupTicks(r),e.d3AlphaDecay(s),e.d3AlphaMin(a),e.d3VelocityDecay(o);for(let r in n.forces){let i=n.forces[r],s=(null==i?void 0:i.force)||null;s&&!(null==i?void 0:i.active)&&(s=null),e.d3Force(r,s),(null==s?void 0:s.links)&&t.push(s)}}t.length&&setTimeout(this.postForceUpdate,250,t)}getOnRenderPostUpdate(){this.graph.onRenderFramePost(this.model.graphBehaviorsForMethod("onRender").length?this.wrapFunction(this.onRender):null)}async onBehaviorsChange(){const{behaviors:e,previousBehaviors:t}=this.model;for(const e of t)e.updateRequested.disconnect(this.postUpdate,this);for(const t of e)t.updateRequested.connect(this.postUpdate,this);await this.postUpdate()}castToNumber(e){return null==e?e:"string"==typeof e?parseFloat(e):e}getComposedLinkAttr(e,t,n){let r;const i=this.graph.graphData(),s={view:this,index:i.links.indexOf(e),graphData:i,link:e};for(const e of this.model.linkBehaviorsForMethod(t))if(r=e[t].call(e,s),null!=r)break;return null!=r?r:n}getComposedNodeAttr(e,t,n){let r;const i={view:this,graphData:this.graph.graphData(),node:e};for(const e of this.model.nodeBehaviorsForMethod(t))if(r=e[t].call(e,i),null!=r)break;return null!=r?r:n}updateRenderOptions(e){return e}}j.view_name="ForceGraphView";class V extends J{defaults(){return{...super.defaults(),_model_name:V.model_name,_view_name:I.view_name}}}V.model_name="ForceGraph3DModel",V.serializers={...J.serializers};class I extends j{get graphJsClass(){return"ForceGraph3D"}async getJsUrl(){return(await n.e(65).then(n.bind(n,65))).default}get threeRenderer(){return this.graph.renderer()}getOnRenderPostUpdate(){this.threeRenderer.setAnimationLoop(this.model.graphBehaviorsForMethod("onRender").length?this.wrapFunction(this.onRender):null)}updateRenderOptions(e){return delete e.context2d,delete e.globalScale,e.renderer3d=this.threeRenderer,e}}I.view_name="ForceGraph3DView";var $=n(627);class H extends i.WidgetModel{constructor(){super(...arguments),this._dataUpdated=new r.Signal(this),this._graphData=null,this._graphDataRequested=!1}defaults(){return{...super.defaults(),...a.sB,_model_name:H.model_name,nodes:null,links:null,node_id_column:a.vJ.id,link_source_column:a.vJ.source,link_target_column:a.vJ.target}}initialize(e,t){super.initialize(e,t),this.on("change:nodes change:links",this.graphUpdate,this)}get dataUpdated(){return this._dataUpdated}get nodeIdColumn(){return this.get("node_id_column")||a.vJ.id}get linkSourceColumn(){return this.get("link_source_column")||a.vJ.source}get linkTargetColumn(){return this.get("link_target_column")||a.vJ.target}get nodes(){return this.get("nodes")||a.ow}get links(){return this.get("links")||a.ow}get graphData(){return this._graphDataRequested||(this.graphUpdate(),this._graphDataRequested=!0),this._graphData||a.tM}set graphData(e){this._graphData=e,this._dataUpdated.emit(void 0)}setFromGraphData(e){const{nodes:t,links:n}=e;let r,i,s,a,o=t.length,l=n.length,d={},h={};const{nodeIdColumn:u,linkSourceColumn:c,linkTargetColumn:g}=this;if(o)for(i of Object.keys(t[0]))for(s=d[i]=new Array(o),r=0;r<o;)s[r]=t[r][i],r++;if(l)for(i of Object.keys(n[0]))for(s=h[i]=new Array(o),r=0;r<l;){switch(a=n[r][i],i){case g:case c:a=a[u]}s[r]=a,r++}this.set({nodes:d,links:h})}graphUpdate(){const e={nodes:[],links:[]},{nodes:t,links:n,nodeIdColumn:r,linkSourceColumn:i,linkTargetColumn:s}=this,o=Object.keys(t),l=Object.keys(n),d=(t[r]||a.ow).length,h=(n[i]||a.ow).length,u=null!=t[r];for(let n=0;n<d;n++){let i={id:u?t[r][n]:n};for(const e of o)i[e]=t[e][n];e.nodes.push(i)}for(let t=0;t<h;t++){let r={source:n[i][t],target:n[s][t]};for(const e of l)r[e]=n[e][t];e.links.push(r)}this.graphData=e}}H.model_name="DataFrameSourceModel",H.serializers={...i.WidgetModel.serializers,nodes:$.dataframe_serialization,links:$.dataframe_serialization}},627:(e,t,n)=>{n.r(t),n.d(t,{dataFrameToJson:()=>o,dataframe_serialization:()=>l,initializeZstd:()=>d,jsonToDataFrame:()=>a});var r=n(915),i=n(42),s=n(503);function a(e,t){if(!e.buffer)return e;const n=i.Buffer.from(e.buffer.buffer),s=(0,r.decompress)(n),a=i.Buffer.prototype.toString.call(s,"utf8");return JSON.parse(a)}function o(e,t){const n=JSON.stringify(e),s=i.Buffer.from(n,"utf-8");return{buffer:(0,r.compress)(s).buffer}}const l={deserialize:a,serialize:o};async function d(){await(0,r.init)(),s.eM&&console.warn(`${s.Dd} zstd loaded`)}}}]);
//# sourceMappingURL=681.11d7a4e2f18a09e769d9.js.map?v=11d7a4e2f18a09e769d9